var snarkjs=function(t){"use strict";const a=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function e(t,a){return a&&10!=a?16==a?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const i=e;function o(t){const e=t.toString(16);return 4*(e.length-1)+a[parseInt(e[0],16)]}function n(t){return BigInt(t)<BigInt(0)}function c(t){return!t}function r(t,a){return BigInt(t)<<BigInt(a)}function l(t,a){return BigInt(t)>>BigInt(a)}const s=r,d=l;function u(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function g(t){let a=BigInt(t);const e=[];for(;a;)a&BigInt(1)?e.push(1):e.push(0),a>>=BigInt(1);return e}function _(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)}function f(t,a){return BigInt(t)+BigInt(a)}function p(t,a){return BigInt(t)-BigInt(a)}function h(t){return-BigInt(t)}function m(t,a){return BigInt(t)*BigInt(a)}function L(t,a){return BigInt(t)**BigInt(a)}function w(t,a){return BigInt(t)/BigInt(a)}function A(t,a){return BigInt(t)%BigInt(a)}function b(t,a){return BigInt(t)==BigInt(a)}function y(t,a){return BigInt(t)>BigInt(a)}function I(t,a){return BigInt(t)>=BigInt(a)}function C(t,a){return BigInt(t)&BigInt(a)}function x(t,a,e,i){const o="0000000"+e.toString(16),n=new Uint32Array(t.buffer,a,i/4),c=1+(4*(o.length-7)-1>>5);for(let t=0;t<c;t++)n[t]=parseInt(o.substring(o.length-8*t-8,o.length-8*t),16);for(let t=c;t<n.length;t++)n[t]=0;for(let a=4*n.length;a<i;a++)t[a]=_(C(l(e,8*a),255))}function F(t,a,e,i){const o="0000000"+e.toString(16),n=new DataView(t.buffer,t.byteOffset+a,i),c=1+(4*(o.length-7)-1>>5);for(let t=0;t<c;t++)n.setUint32(i-4*t-4,parseInt(o.substring(o.length-8*t-8,o.length-8*t),16),!1);for(let t=0;t<i/4-c;t++)n[t]=0}function E(t,a,i){i=i||t.byteLength,a=a||0;const o=new Uint32Array(t.buffer,a,i/4),n=new Array(i/4);return o.forEach(((t,a)=>n[n.length-a-1]=t.toString(16).padStart(8,"0"))),e(n.join(""),16)}function B(t,a,i){i=i||t.byteLength,a=a||0;const o=new DataView(t.buffer,t.byteOffset+a,i),n=new Array(i/4);for(let t=0;t<i/4;t++)n[t]=o.getUint32(4*t,!1).toString(16).padStart(8,"0");return e(n.join(""),16)}function v(t,a){return t.toString(a)}function S(t){const a=new Uint8Array(Math.floor((o(t)-1)/8)+1);return x(a,0,t,a.byteLength),a}const G=i(0),P=i(1);var U=Object.freeze({__proto__:null,fromString:e,e:i,fromArray:function(t,a){let e=BigInt(0);a=BigInt(a);for(let i=0;i<t.length;i++)e=e*a+BigInt(t[i]);return e},bitLength:o,isNegative:n,isZero:c,shiftLeft:r,shiftRight:l,shl:s,shr:d,isOdd:u,naf:function(t){let a=BigInt(t);const e=[];for(;a;){if(a&BigInt(1)){const t=2-Number(a%BigInt(4));e.push(t),a-=BigInt(t)}else e.push(0);a>>=BigInt(1)}return e},bits:g,toNumber:_,toArray:function(t,a){const e=[];let i=BigInt(t);for(a=BigInt(a);i;)e.unshift(Number(i%a)),i/=a;return e},add:f,sub:p,neg:h,mul:m,square:function(t){return BigInt(t)*BigInt(t)},pow:L,exp:function(t,a){return BigInt(t)**BigInt(a)},abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},div:w,mod:A,eq:b,neq:function(t,a){return BigInt(t)!=BigInt(a)},lt:function(t,a){return BigInt(t)<BigInt(a)},gt:y,leq:function(t,a){return BigInt(t)<=BigInt(a)},geq:I,band:C,bor:function(t,a){return BigInt(t)|BigInt(a)},bxor:function(t,a){return BigInt(t)^BigInt(a)},land:function(t,a){return BigInt(t)&&BigInt(a)},lor:function(t,a){return BigInt(t)||BigInt(a)},lnot:function(t){return!BigInt(t)},toRprLE:x,toRprBE:F,fromRprLE:E,fromRprBE:B,toString:v,toLEBuff:S,zero:G,one:P});function O(t,a,e){if(c(e))return t.one;const i=g(e);if(0==i.length)return t.one;let o=a;for(let e=i.length-2;e>=0;e--)o=t.square(o),i[e]&&(o=t.mul(o,a));return o}function z(t){if(t.m%2==1)if(b(A(t.p,4),1))if(b(A(t.p,8),1))if(b(A(t.p,16),1))!function(t){t.sqrt_q=L(t.p,t.m),t.sqrt_s=0,t.sqrt_t=p(t.sqrt_q,1);for(;!u(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=w(t.sqrt_t,2);let a=t.one;for(;t.eq(a,t.one);){const e=t.random();t.sqrt_z=t.pow(e,t.sqrt_t),a=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=w(p(t.sqrt_t,1),2),t.sqrt=function(t){const a=this;if(a.isZero(t))return a.zero;let e=a.pow(t,a.sqrt_tm1d2);const i=a.pow(a.mul(a.square(e),t),2**(a.sqrt_s-1));if(a.eq(i,a.negone))return null;let o=a.sqrt_s,n=a.mul(t,e),c=a.mul(n,e),r=a.sqrt_z;for(;!a.eq(c,a.one);){let t=a.square(c),i=1;for(;!a.eq(t,a.one);)t=a.square(t),i++;e=r;for(let t=0;t<o-i-1;t++)e=a.square(e);r=a.square(e),c=a.mul(c,r),n=a.mul(n,e),o=i}return a.geq(n,a.zero)?n:a.neg(n)}}(t);else{if(!b(A(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!b(A(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else b(A(t.p,4),3)&&function(t){t.sqrt_q=L(t.p,t.m),t.sqrt_e1=w(p(t.sqrt_q,3),4),t.sqrt=function(a){if(this.isZero(a))return this.zero;const e=this.pow(a,this.sqrt_e1),i=this.mul(this.square(e),a);if(this.eq(i,this.negone))return null;const o=this.mul(e,a);return t.geq(o,t.zero)?o:t.neg(o)}}(t);else{const a=A(L(t.p,t.m/2),4);1==a?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==a?function(t){t.sqrt_q=L(t.p,t.m/2),t.sqrt_e34=w(p(t.sqrt_q,3),4),t.sqrt_e12=w(p(t.sqrt_q,1),2),t.frobenius=function(a,e){return a%2==1?t.conjugate(e):e},t.sqrt=function(t){const a=this,e=a.pow(t,a.sqrt_e34),i=a.mul(a.square(e),t),o=a.mul(a.frobenius(1,i),i);if(a.eq(o,a.negone))return null;const n=a.mul(e,t);let c;if(a.eq(i,a.negone))c=a.mul(n,[a.F.zero,a.F.one]);else{const t=a.pow(a.add(a.one,i),a.sqrt_e12);c=a.mul(t,n)}return a.geq(c,a.zero)?c:a.neg(c)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}function Q(t,a,e,i,o){t[a]=t[a]+t[e]>>>0,t[o]=(t[o]^t[a])>>>0,t[o]=(t[o]<<16|t[o]>>>16&65535)>>>0,t[i]=t[i]+t[o]>>>0,t[e]=(t[e]^t[i])>>>0,t[e]=(t[e]<<12|t[e]>>>20&4095)>>>0,t[a]=t[a]+t[e]>>>0,t[o]=(t[o]^t[a])>>>0,t[o]=(t[o]<<8|t[o]>>>24&255)>>>0,t[i]=t[i]+t[o]>>>0,t[e]=(t[e]^t[i])>>>0,t[e]=(t[e]<<7|t[e]>>>25&127)>>>0}class q{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return f(m(this.nextU32(),4294967296),this.nextU32())}nextBool(){return 1==(1&this.nextU32())}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let a=0;a<10;a++)Q(t=this.buff,0,4,8,12),Q(t,1,5,9,13),Q(t,2,6,10,14),Q(t,3,7,11,15),Q(t,0,5,10,15),Q(t,1,6,11,12),Q(t,2,7,8,13),Q(t,3,4,9,14);var t;for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}var M={};function T(t){let a=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(a);else for(let e=0;e<t;e++)a[e]=4294967296*Math.random()>>>0;return a}let k=null;function R(){return k||(k=new q(function(){const t=T(32),a=new Uint32Array(t.buffer),e=[];for(let t=0;t<8;t++)e.push(a[t]);return e}()),k)}class D{constructor(t,a,e){this.F=a,this.G=t,this.opMulGF=e;let i=a.sqrt_t||a.t,o=a.sqrt_s||a.s,n=a.one;for(;a.eq(a.pow(n,a.half),a.one);)n=a.add(n,a.one);this.w=new Array(o+1),this.wi=new Array(o+1),this.w[o]=this.F.pow(n,i),this.wi[o]=this.F.inv(this.w[o]);let c=o-1;for(;c>=0;)this.w[c]=this.F.square(this.w[c+1]),this.wi[c]=this.F.square(this.wi[c+1]),c--;this.roots=[],this._setRoots(Math.min(o,15))}_setRoots(t){for(let a=t;a>=0&&!this.roots[a];a--){let t=this.F.one;const e=1<<a,i=new Array(e);for(let o=0;o<e;o++)i[o]=t,t=this.F.mul(t,this.w[a]);this.roots[a]=i}}fft(t){if(t.length<=1)return t;const a=N(t.length-1)+1;this._setRoots(a);const e=1<<a;if(t.length!=e)throw new Error("Size must be multiple of 2");return K(this,t,a,0,1)}ifft(t){if(t.length<=1)return t;const a=N(t.length-1)+1;this._setRoots(a);const e=1<<a;if(t.length!=e)throw new Error("Size must be multiple of 2");const i=K(this,t,a,0,1),o=this.F.inv(this.F.mulScalar(this.F.one,e)),n=new Array(e);for(let t=0;t<e;t++)n[t]=this.opMulGF(i[(e-t)%e],o);return n}}function N(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function K(t,a,e,i,o){const n=1<<e;if(1==n)return[a[i]];if(2==n)return[t.G.add(a[i],a[i+o]),t.G.sub(a[i],a[i+o])];const c=n>>1,r=K(t,a,e-1,i,2*o),l=K(t,a,e-1,i+o,2*o),s=new Array(n);for(let a=0;a<c;a++)s[a]=t.G.add(r[a],t.opMulGF(l[a],t.roots[e][a])),s[a+c]=t.G.sub(r[a],t.opMulGF(l[a],t.roots[e][a]));return s}class V{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=o(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const a=this.negone>>this.one;this.nqr=this.two;let e=this.pow(this.nqr,a);for(;!this.eq(e,this.negone);)this.nqr=this.nqr+this.one,e=this.pow(this.nqr,a);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),z(this),this.FFT=new D(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,a){let e;if(a?16==a&&(e=BigInt("0x"+t)):e=BigInt(t),e<0){let t=-e;return t>=this.p&&(t%=this.p),this.p-t}return e>=this.p?e%this.p:e}add(t,a){const e=t+a;return e>=this.p?e-this.p:e}sub(t,a){return t>=a?t-a:this.p-a+t}neg(t){return t?this.p-t:t}mul(t,a){return t*a%this.p}mulScalar(t,a){return t*this.e(a)%this.p}square(t){return t*t%this.p}eq(t,a){return t==a}neq(t,a){return t!=a}lt(t,a){return(t>this.half?t-this.p:t)<(a>this.half?a-this.p:a)}gt(t,a){return(t>this.half?t-this.p:t)>(a>this.half?a-this.p:a)}leq(t,a){return(t>this.half?t-this.p:t)<=(a>this.half?a-this.p:a)}geq(t,a){return(t>this.half?t-this.p:t)>=(a>this.half?a-this.p:a)}div(t,a){return this.mul(t,this.inv(a))}idiv(t,a){if(!a)throw new Error("Division by zero");return t/a}inv(t){if(!t)throw new Error("Division by zero");let a=this.zero,e=this.p,i=this.one,o=t%this.p;for(;o;){let t=e/o;[a,i]=[i,a-t*i],[e,o]=[o,e-t*o]}return a<this.zero&&(a+=this.p),a}mod(t,a){return t%a}pow(t,a){return O(this,t,a)}exp(t,a){return O(this,t,a)}band(t,a){const e=t&a&this.mask;return e>=this.p?e-this.p:e}bor(t,a){const e=(t|a)&this.mask;return e>=this.p?e-this.p:e}bxor(t,a){const e=(t^a)&this.mask;return e>=this.p?e-this.p:e}bnot(t){const a=t^this.mask;return a>=this.p?a-this.p:a}shl(t,a){if(Number(a)<this.bitLength){const e=t<<a&this.mask;return e>=this.p?e-this.p:e}{const e=this.p-a;return Number(e)<this.bitLength?t>>e:this.zero}}shr(t,a){if(Number(a)<this.bitLength)return t>>a;{const e=this.p-a;if(Number(e)<this.bitLength){const a=t<<e&this.mask;return a>=this.p?a-this.p:a}return 0}}land(t,a){return t&&a?this.one:this.zero}lor(t,a){return t||a?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let a=this.s,e=this.nqr_to_t,i=this.pow(t,this.t),o=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),n=1;for(;t!=this.one;)n++,t=this.square(t);let c=e;for(let t=0;t<a-n-1;t++)c=this.square(c);a=n,e=this.square(c),i=this.mul(i,e),o=this.mul(o,c)}return o>this.p>>this.one&&(o=this.neg(o)),o}normalize(t,a){if((t=BigInt(t,a))<0){let a=-t;return a>=this.p&&(a%=this.p),this.p-a}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let a=this.zero;for(let e=0;e<t;e++)a=(a<<BigInt(8))+BigInt(T(1)[0]);return a%this.p}toString(t,a){let e;if(a=a||10,t>this.half&&10==a){e="-"+(this.p-t).toString(a)}else e=t.toString(a);return e}isZero(t){return t==this.zero}fromRng(t){let a;do{a=this.zero;for(let e=0;e<this.n64;e++)a+=t.nextU64()<<BigInt(64*e);a&=this.mask}while(a>=this.p);return a=a*this.Ri%this.p,a}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,a,e){x(t,a,e,8*this.n64)}toRprBE(t,a,e){F(t,a,e,8*this.n64)}toRprBEM(t,a,e){return this.toRprBE(t,a,this.mul(this.R,e))}toRprLEM(t,a,e){return this.toRprLE(t,a,this.mul(this.R,e))}fromRprLE(t,a){return E(t,a,this.n8)}fromRprBE(t,a){return B(t,a,this.n8)}fromRprLEM(t,a){return this.mul(this.fromRprLE(t,a),this.Ri)}fromRprBEM(t,a){return this.mul(this.fromRprBE(t,a),this.Ri)}toObject(t){return t}}var j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},H={bigInt2BytesLE:function(t,a){const e=Array(a);let i=BigInt(t);for(let t=0;t<a;t++)e[t]=Number(0xFFn&i),i>>=8n;return e},bigInt2U32LE:function(t,a){const e=Array(a);let i=BigInt(t);for(let t=0;t<a;t++)e[t]=Number(0xFFFFFFFFn&i),i>>=32n;return e},isOcamNum:function(t){return!!Array.isArray(t)&&(3==t.length&&("number"==typeof t[0]&&("number"==typeof t[1]&&!!Array.isArray(t[2]))))}},$=function(t,a,e,i,o,n,c){const r=t.addFunction(a);r.addParam("base","i32"),r.addParam("scalar","i32"),r.addParam("scalarLength","i32"),r.addParam("r","i32"),r.addLocal("i","i32"),r.addLocal("b","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(e));r.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(c,l.getLocal("r")),...l.ret([])])),r.addCode(l.call(n,l.getLocal("base"),s)),r.addCode(l.call(c,l.getLocal("r"))),r.addCode(l.setLocal("i",l.getLocal("scalarLength"))),r.addCode(l.block(l.loop(l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.setLocal("b",l.i32_load8_u(l.i32_add(l.getLocal("scalar"),l.getLocal("i")))),...function(){const t=[];for(let a=0;a<8;a++)t.push(...l.call(o,l.getLocal("r"),l.getLocal("r")),...l.if(l.i32_ge_u(l.getLocal("b"),l.i32_const(128>>a)),[...l.setLocal("b",l.i32_sub(l.getLocal("b"),l.i32_const(128>>a))),...l.call(i,l.getLocal("r"),s,l.getLocal("r"))]));return t}(),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.br(0))))},Y=function(t,a){const e=8*t.modules[a].n64,i=t.addFunction(a+"_batchInverse");i.addParam("pIn","i32"),i.addParam("inStep","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addParam("outStep","i32"),i.addLocal("itAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(e));i.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(e))))),i.addCode(o.call(a+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(a+"_isZero",o.getLocal("itIn")),o.call(a+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(e)),o.getLocal("itAux")),o.call(a+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(e)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(a+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(a+"_isZero",o.getLocal("itIn")),[...o.call(a+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),...o.call(a+"_zero",o.getLocal("itOut"))],[...o.call(a+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(e)),n),...o.call(a+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),...o.call(a+"_mul",o.getLocal("itAux"),n,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),i.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))};var W=function(t,a,e,i,o,n){void 0===n&&(n=i<o);const c=t.addFunction(a);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn","i32"),c.addLocal("itOut","i32");const r=c.getCodeBuilder();n?c.addCode(r.setLocal("itIn",r.i32_add(r.getLocal("pIn"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(e,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_sub(r.getLocal("itIn"),r.i32_const(i))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):c.addCode(r.setLocal("itIn",r.getLocal("pIn")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(e,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_add(r.getLocal("itIn"),r.i32_const(i))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))};var Z=function(t,a,e,i,o,n){void 0===n&&(n=i<o);const c=t.addFunction(a);c.addParam("pIn1","i32"),c.addParam("pIn2","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn1","i32"),c.addLocal("itIn2","i32"),c.addLocal("itOut","i32");const r=c.getCodeBuilder();n?c.addCode(r.setLocal("itIn1",r.i32_add(r.getLocal("pIn1"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itIn2",r.i32_add(r.getLocal("pIn2"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(e,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_sub(r.getLocal("itIn1"),r.i32_const(i))),r.setLocal("itIn2",r.i32_sub(r.getLocal("itIn2"),r.i32_const(i))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):c.addCode(r.setLocal("itIn1",r.getLocal("pIn1")),r.setLocal("itIn2",r.getLocal("pIn2")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(e,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_add(r.getLocal("itIn1"),r.i32_const(i))),r.setLocal("itIn2",r.i32_add(r.getLocal("itIn2"),r.i32_const(i))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))};var J={};function X(t,a){return t===a?0:t>a?1:-1}function tt(t){return t*t}function at(t){return t%2n!==0n}function et(t){return t%2n===0n}function it(t){return t<0n}function ot(t){return t>0n}function nt(t){return it(t)?t.toString(2).length-1:t.toString(2).length}function ct(t){return t<0n?-t:t}function rt(t){return 1n===ct(t)}function lt(t,a){for(var e,i,o,n=0n,c=1n,r=a,l=ct(t);0n!==l;)e=r/l,i=n,o=r,n=c,r=l,c=i-e*c,l=o-e*l;if(!rt(r))throw new Error(t.toString()+" and "+a.toString()+" are not co-prime");return-1===X(n,0n)&&(n+=a),it(t)?-n:n}function st(t,a,e){if(0n===e)throw new Error("Cannot take modPow with modulus 0");var i=1n,o=t%e;for(it(a)&&(a*=-1n,o=lt(o,e));ot(a);){if(0n===o)return 0n;at(a)&&(i=i*o%e),a/=2n,o=tt(o)%e}return i}function dt(t,a){return 0n!==a&&(!!rt(a)||(0===function(t,a){return(t=t>=0n?t:-t)===(a=a>=0n?a:-a)?0:t>a?1:-1}(a,2n)?et(t):t%a===0n))}function ut(t,a){for(var e,i,o,n=function(t){return t-1n}(t),c=n,r=0;et(c);)c/=2n,r++;t:for(i=0;i<a.length;i++)if(!(t<a[i]||rt(o=st(BigInt(a[i]),c,t))||o===n)){for(e=r-1;0!=e;e--){if(rt(o=tt(o)%t))return!1;if(o===n)continue t}return!1}return!0}J.bitLength=nt,J.isOdd=at,J.isNegative=it,J.abs=ct,J.isUnit=rt,J.compare=X,J.modInv=lt,J.modPow=st,J.isPrime=function(t){var a=function(t){var a=ct(t);return!rt(a)&&(2n===a||3n===a||5n===a||!(et(a)||dt(a,3n)||dt(a,5n))&&(a<49n||void 0))}(t);if(void 0!==a)return a;var e=ct(t),i=nt(e);if(i<=64)return ut(e,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*Number(i),n=Math.ceil(o),c=[],r=0;r<n;r++)c.push(BigInt(r+2));return ut(e,c)},J.square=tt;const gt=function(t,a,e){const i=e||"int";if(t.modules[i])return i;t.modules[i]={};const o=2*a,n=8*a;return function(){const e=t.addFunction(i+"_copy");e.addParam("px","i32"),e.addParam("pr","i32");const o=e.getCodeBuilder();for(let t=0;t<a;t++)e.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_load(o.getLocal("px"),8*t)))}(),function(){const e=t.addFunction(i+"_zero");e.addParam("pr","i32");const o=e.getCodeBuilder();for(let t=0;t<a;t++)e.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){const e=t.addFunction(i+"_isZero");e.addParam("px","i32"),e.setReturnType("i32");const o=e.getCodeBuilder();e.addCode(function t(a){return 0==a?o.ret(o.i64_eqz(o.i64_load(o.getLocal("px")))):o.if(o.i64_eqz(o.i64_load(o.getLocal("px"),8*a)),t(a-1),o.ret(o.i32_const(0)))}(a-1)),e.addCode(o.ret(o.i32_const(0)))}(),function(){const e=t.addFunction(i+"_one");e.addParam("pr","i32");const o=e.getCodeBuilder();e.addCode(o.i64_store(o.getLocal("pr"),0,o.i64_const(1)));for(let t=1;t<a;t++)e.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){const e=t.addFunction(i+"_eq");e.addParam("px","i32"),e.addParam("py","i32"),e.setReturnType("i32");const o=e.getCodeBuilder();e.addCode(function t(a){return 0==a?o.ret(o.i64_eq(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_eq(o.i64_load(o.getLocal("px"),8*a),o.i64_load(o.getLocal("py"),8*a)),t(a-1),o.ret(o.i32_const(0)))}(a-1)),e.addCode(o.ret(o.i32_const(0)))}(),function(){const e=t.addFunction(i+"_gte");e.addParam("px","i32"),e.addParam("py","i32"),e.setReturnType("i32");const o=e.getCodeBuilder();e.addCode(function t(a){return 0==a?o.ret(o.i64_ge_u(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_lt_u(o.i64_load(o.getLocal("px"),8*a),o.i64_load(o.getLocal("py"),8*a)),o.ret(o.i32_const(0)),o.if(o.i64_gt_u(o.i64_load(o.getLocal("px"),8*a),o.i64_load(o.getLocal("py"),8*a)),o.ret(o.i32_const(1)),t(a-1)))}(a-1)),e.addCode(o.ret(o.i32_const(0)))}(),function(){const a=t.addFunction(i+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.setReturnType("i32"),a.addLocal("c","i64");const e=a.getCodeBuilder();a.addCode(e.setLocal("c",e.i64_add(e.i64_load32_u(e.getLocal("x")),e.i64_load32_u(e.getLocal("y"))))),a.addCode(e.i64_store32(e.getLocal("r"),e.getLocal("c")));for(let t=1;t<o;t++)a.addCode(e.setLocal("c",e.i64_add(e.i64_add(e.i64_load32_u(e.getLocal("x"),4*t),e.i64_load32_u(e.getLocal("y"),4*t)),e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))),a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.getLocal("c")));a.addCode(e.i32_wrap_i64(e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))}(),function(){const a=t.addFunction(i+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.setReturnType("i32"),a.addLocal("c","i64");const e=a.getCodeBuilder();a.addCode(e.setLocal("c",e.i64_sub(e.i64_load32_u(e.getLocal("x")),e.i64_load32_u(e.getLocal("y"))))),a.addCode(e.i64_store32(e.getLocal("r"),e.i64_and(e.getLocal("c"),e.i64_const("0xFFFFFFFF"))));for(let t=1;t<o;t++)a.addCode(e.setLocal("c",e.i64_add(e.i64_sub(e.i64_load32_u(e.getLocal("x"),4*t),e.i64_load32_u(e.getLocal("y"),4*t)),e.i64_shr_s(e.getLocal("c"),e.i64_const(32))))),a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.i64_and(e.getLocal("c"),e.i64_const("0xFFFFFFFF"))));a.addCode(e.i32_wrap_i64(e.i64_shr_s(e.getLocal("c"),e.i64_const(32))))}(),function(){const a=t.addFunction(i+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64");for(let t=0;t<o;t++)a.addLocal("x"+t,"i64"),a.addLocal("y"+t,"i64");const e=a.getCodeBuilder(),n=[],c=[];function r(t,a){let i,o;return n[t]?i=e.getLocal("x"+t):(i=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),n[t]=!0),c[a]?o=e.getLocal("y"+a):(o=e.teeLocal("y"+a,e.i64_load32_u(e.getLocal("y"),4*a)),c[a]=!0),e.i64_mul(i,o)}let l="c0",s="c1";for(let t=0;t<2*o-1;t++){for(let i=Math.max(0,t-o+1);i<=t&&i<o;i++){const o=t-i;a.addCode(e.setLocal(l,e.i64_add(e.i64_and(e.getLocal(l),e.i64_const(4294967295)),r(i,o)))),a.addCode(e.setLocal(s,e.i64_add(e.getLocal(s),e.i64_shr_u(e.getLocal(l),e.i64_const(32)))))}a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.getLocal(l))),[l,s]=[s,l],a.addCode(e.setLocal(s,e.i64_shr_u(e.getLocal(l),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),4*o*2-4,e.getLocal(l)))}(),function(){const a=t.addFunction(i+"_square");a.addParam("x","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("c0_old","i64"),a.addLocal("c1_old","i64");for(let t=0;t<o;t++)a.addLocal("x"+t,"i64");const e=a.getCodeBuilder(),n=[];function c(t,a){let i,o;return n[t]?i=e.getLocal("x"+t):(i=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),n[t]=!0),n[a]?o=e.getLocal("x"+a):(o=e.teeLocal("x"+a,e.i64_load32_u(e.getLocal("x"),4*a)),n[a]=!0),e.i64_mul(i,o)}let r="c0",l="c1",s="c0_old",d="c1_old";for(let t=0;t<2*o-1;t++){a.addCode(e.setLocal(r,e.i64_const(0)),e.setLocal(l,e.i64_const(0)));for(let i=Math.max(0,t-o+1);i<t+1>>1&&i<o;i++){const o=t-i;a.addCode(e.setLocal(r,e.i64_add(e.i64_and(e.getLocal(r),e.i64_const(4294967295)),c(i,o)))),a.addCode(e.setLocal(l,e.i64_add(e.getLocal(l),e.i64_shr_u(e.getLocal(r),e.i64_const(32)))))}a.addCode(e.setLocal(r,e.i64_shl(e.i64_and(e.getLocal(r),e.i64_const(4294967295)),e.i64_const(1)))),a.addCode(e.setLocal(l,e.i64_add(e.i64_shl(e.getLocal(l),e.i64_const(1)),e.i64_shr_u(e.getLocal(r),e.i64_const(32))))),t%2==0&&(a.addCode(e.setLocal(r,e.i64_add(e.i64_and(e.getLocal(r),e.i64_const(4294967295)),c(t>>1,t>>1)))),a.addCode(e.setLocal(l,e.i64_add(e.getLocal(l),e.i64_shr_u(e.getLocal(r),e.i64_const(32)))))),t>0&&(a.addCode(e.setLocal(r,e.i64_add(e.i64_and(e.getLocal(r),e.i64_const(4294967295)),e.i64_and(e.getLocal(s),e.i64_const(4294967295))))),a.addCode(e.setLocal(l,e.i64_add(e.i64_add(e.getLocal(l),e.i64_shr_u(e.getLocal(r),e.i64_const(32))),e.getLocal(d))))),a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.getLocal(r))),a.addCode(e.setLocal(s,e.getLocal(l)),e.setLocal(d,e.i64_shr_u(e.getLocal(s),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),4*o*2-4,e.getLocal(s)))}(),function(){const a=t.addFunction(i+"_squareOld");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.call(i+"_mul",e.getLocal("x"),e.getLocal("x"),e.getLocal("r")))}(),function(){!function(){const a=t.addFunction(i+"__mul1");a.addParam("px","i32"),a.addParam("y","i64"),a.addParam("pr","i32"),a.addLocal("c","i64");const e=a.getCodeBuilder();a.addCode(e.setLocal("c",e.i64_mul(e.i64_load32_u(e.getLocal("px"),0,0),e.getLocal("y")))),a.addCode(e.i64_store32(e.getLocal("pr"),0,0,e.getLocal("c")));for(let t=1;t<o;t++)a.addCode(e.setLocal("c",e.i64_add(e.i64_mul(e.i64_load32_u(e.getLocal("px"),4*t,0),e.getLocal("y")),e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))),a.addCode(e.i64_store32(e.getLocal("pr"),4*t,0,e.getLocal("c")))}(),function(){const a=t.addFunction(i+"__add1");a.addParam("x","i32"),a.addParam("y","i64"),a.addLocal("c","i64"),a.addLocal("px","i32");const e=a.getCodeBuilder();a.addCode(e.setLocal("px",e.getLocal("x"))),a.addCode(e.setLocal("c",e.i64_add(e.i64_load32_u(e.getLocal("px"),0,0),e.getLocal("y")))),a.addCode(e.i64_store32(e.getLocal("px"),0,0,e.getLocal("c"))),a.addCode(e.setLocal("c",e.i64_shr_u(e.getLocal("c"),e.i64_const(32)))),a.addCode(e.block(e.loop(e.br_if(1,e.i64_eqz(e.getLocal("c"))),e.setLocal("px",e.i32_add(e.getLocal("px"),e.i32_const(4))),e.setLocal("c",e.i64_add(e.i64_load32_u(e.getLocal("px"),0,0),e.getLocal("c"))),e.i64_store32(e.getLocal("px"),0,0,e.getLocal("c")),e.setLocal("c",e.i64_shr_u(e.getLocal("c"),e.i64_const(32))),e.br(0))))}();const a=t.addFunction(i+"_div");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("c","i32"),a.addParam("r","i32"),a.addLocal("rr","i32"),a.addLocal("cc","i32"),a.addLocal("eX","i32"),a.addLocal("eY","i32"),a.addLocal("sy","i64"),a.addLocal("sx","i64"),a.addLocal("ec","i32");const e=a.getCodeBuilder(),c=e.i32_const(t.alloc(n)),r=e.i32_const(t.alloc(n)),l=e.i32_const(t.alloc(n)),s=e.getLocal("cc"),d=e.getLocal("rr"),u=t.alloc(2*n),g=e.i32_const(u),_=e.i32_const(u+n);a.addCode(e.if(e.getLocal("c"),e.setLocal("cc",e.getLocal("c")),e.setLocal("cc",r))),a.addCode(e.if(e.getLocal("r"),e.setLocal("rr",e.getLocal("r")),e.setLocal("rr",l))),a.addCode(e.call(i+"_copy",e.getLocal("x"),d)),a.addCode(e.call(i+"_copy",e.getLocal("y"),c)),a.addCode(e.call(i+"_zero",s)),a.addCode(e.call(i+"_zero",g)),a.addCode(e.setLocal("eX",e.i32_const(n-1))),a.addCode(e.setLocal("eY",e.i32_const(n-1))),a.addCode(e.block(e.loop(e.br_if(1,e.i32_or(e.i32_load8_u(e.i32_add(c,e.getLocal("eY")),0,0),e.i32_eq(e.getLocal("eY"),e.i32_const(3)))),e.setLocal("eY",e.i32_sub(e.getLocal("eY"),e.i32_const(1))),e.br(0)))),a.addCode(e.setLocal("sy",e.i64_add(e.i64_load32_u(e.i32_sub(e.i32_add(c,e.getLocal("eY")),e.i32_const(3)),0,0),e.i64_const(1)))),a.addCode(e.if(e.i64_eq(e.getLocal("sy"),e.i64_const(1)),e.drop(e.i64_div_u(e.i64_const(0),e.i64_const(0))))),a.addCode(e.block(e.loop(e.block(e.loop(e.br_if(1,e.i32_or(e.i32_load8_u(e.i32_add(d,e.getLocal("eX")),0,0),e.i32_eq(e.getLocal("eX"),e.i32_const(7)))),e.setLocal("eX",e.i32_sub(e.getLocal("eX"),e.i32_const(1))),e.br(0))),e.setLocal("sx",e.i64_load(e.i32_sub(e.i32_add(d,e.getLocal("eX")),e.i32_const(7)),0,0)),e.setLocal("sx",e.i64_div_u(e.getLocal("sx"),e.getLocal("sy"))),e.setLocal("ec",e.i32_sub(e.i32_sub(e.getLocal("eX"),e.getLocal("eY")),e.i32_const(4))),e.block(e.loop(e.br_if(1,e.i32_and(e.i64_eqz(e.i64_and(e.getLocal("sx"),e.i64_const("0xFFFFFFFF00000000"))),e.i32_ge_s(e.getLocal("ec"),e.i32_const(0)))),e.setLocal("sx",e.i64_shr_u(e.getLocal("sx"),e.i64_const(8))),e.setLocal("ec",e.i32_add(e.getLocal("ec"),e.i32_const(1))),e.br(0))),e.if(e.i64_eqz(e.getLocal("sx")),[...e.br_if(2,e.i32_eqz(e.call(i+"_gte",d,c))),...e.setLocal("sx",e.i64_const(1)),...e.setLocal("ec",e.i32_const(0))]),e.call(i+"__mul1",c,e.getLocal("sx"),_),e.drop(e.call(i+"_sub",d,e.i32_sub(_,e.getLocal("ec")),d)),e.call(i+"__add1",e.i32_add(s,e.getLocal("ec")),e.getLocal("sx")),e.br(0))))}(),function(){const a=t.addFunction(i+"_inverseMod");a.addParam("px","i32"),a.addParam("pm","i32"),a.addParam("pr","i32"),a.addLocal("t","i32"),a.addLocal("newt","i32"),a.addLocal("r","i32"),a.addLocal("qq","i32"),a.addLocal("qr","i32"),a.addLocal("newr","i32"),a.addLocal("swp","i32"),a.addLocal("x","i32"),a.addLocal("signt","i32"),a.addLocal("signnewt","i32"),a.addLocal("signx","i32");const e=a.getCodeBuilder(),o=e.i32_const(t.alloc(n)),c=e.i32_const(t.alloc(n)),r=e.i32_const(t.alloc(n)),l=e.i32_const(t.alloc(n)),s=e.i32_const(t.alloc(n)),d=e.i32_const(t.alloc(n)),u=e.i32_const(t.alloc(2*n)),g=e.i32_const(t.alloc(n));a.addCode(e.setLocal("t",o),e.call(i+"_zero",o),e.setLocal("signt",e.i32_const(0))),a.addCode(e.setLocal("r",c),e.call(i+"_copy",e.getLocal("pm"),c)),a.addCode(e.setLocal("newt",r),e.call(i+"_one",r),e.setLocal("signnewt",e.i32_const(0))),a.addCode(e.setLocal("newr",l),e.call(i+"_copy",e.getLocal("px"),l)),a.addCode(e.setLocal("qq",s)),a.addCode(e.setLocal("qr",d)),a.addCode(e.setLocal("x",g)),a.addCode(e.block(e.loop(e.br_if(1,e.call(i+"_isZero",e.getLocal("newr"))),e.call(i+"_div",e.getLocal("r"),e.getLocal("newr"),e.getLocal("qq"),e.getLocal("qr")),e.call(i+"_mul",e.getLocal("qq"),e.getLocal("newt"),u),e.if(e.getLocal("signt"),e.if(e.getLocal("signnewt"),e.if(e.call(i+"_gte",u,e.getLocal("t")),[...e.drop(e.call(i+"_sub",u,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(0))],[...e.drop(e.call(i+"_sub",e.getLocal("t"),u,e.getLocal("x"))),...e.setLocal("signx",e.i32_const(1))]),[...e.drop(e.call(i+"_add",u,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(1))]),e.if(e.getLocal("signnewt"),[...e.drop(e.call(i+"_add",u,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(0))],e.if(e.call(i+"_gte",e.getLocal("t"),u),[...e.drop(e.call(i+"_sub",e.getLocal("t"),u,e.getLocal("x"))),...e.setLocal("signx",e.i32_const(0))],[...e.drop(e.call(i+"_sub",u,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(1))]))),e.setLocal("swp",e.getLocal("t")),e.setLocal("t",e.getLocal("newt")),e.setLocal("newt",e.getLocal("x")),e.setLocal("x",e.getLocal("swp")),e.setLocal("signt",e.getLocal("signnewt")),e.setLocal("signnewt",e.getLocal("signx")),e.setLocal("swp",e.getLocal("r")),e.setLocal("r",e.getLocal("newr")),e.setLocal("newr",e.getLocal("qr")),e.setLocal("qr",e.getLocal("swp")),e.br(0)))),a.addCode(e.if(e.getLocal("signt"),e.drop(e.call(i+"_sub",e.getLocal("pm"),e.getLocal("t"),e.getLocal("pr"))),e.call(i+"_copy",e.getLocal("t"),e.getLocal("pr"))))}(),t.exportFunction(i+"_copy"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_gte"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_squareOld"),t.exportFunction(i+"_div"),t.exportFunction(i+"_inverseMod"),i},_t=H,ft=$,pt=Y,ht=W,mt=Z,{bitLength:Lt,modInv:wt,modPow:At,isPrime:bt,isOdd:yt,square:It}=J;var Ct=function(t,a,e,i){const o=BigInt(a),n=Math.floor((Lt(o-1n)-1)/64)+1,c=2*n,r=8*n,l=e||"f1m";if(t.modules[l])return l;const s=gt(t,n,i),d=t.alloc(r,_t.bigInt2BytesLE(o,r)),u=t.alloc(_t.bigInt2BytesLE(It(1n<<BigInt(64*n))%o,r)),g=t.alloc(_t.bigInt2BytesLE((1n<<BigInt(64*n))%o,r)),_=t.alloc(_t.bigInt2BytesLE(0n,r)),f=o-1n,p=f>>1n,h=t.alloc(r,_t.bigInt2BytesLE(p,r)),m=p+1n,L=t.alloc(r,_t.bigInt2BytesLE(m,r));t.modules[l]={pq:d,pR2:u,n64:n,q:o,pOne:g,pZero:_,pePlusOne:L};let w=2n;if(bt(o))for(;At(w,p,o)!==f;)w+=1n;let A=0,b=f;for(;!yt(b)&&0n!==b;)A++,b>>=1n;const y=t.alloc(r,_t.bigInt2BytesLE(b,r)),I=At(w,b,o),C=t.alloc(_t.bigInt2BytesLE((I<<BigInt(64*n))%o,r)),x=b+1n>>1n,F=t.alloc(r,_t.bigInt2BytesLE(x,r));return t.exportFunction(s+"_copy",l+"_copy"),t.exportFunction(s+"_zero",l+"_zero"),t.exportFunction(s+"_isZero",l+"_isZero"),t.exportFunction(s+"_eq",l+"_eq"),function(){const a=t.addFunction(l+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");const e=a.getCodeBuilder();a.addCode(e.ret(e.call(s+"_eq",e.getLocal("x"),e.i32_const(g))))}(),function(){const a=t.addFunction(l+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.if(e.call(s+"_add",e.getLocal("x"),e.getLocal("y"),e.getLocal("r")),e.drop(e.call(s+"_sub",e.getLocal("r"),e.i32_const(d),e.getLocal("r"))),e.if(e.call(s+"_gte",e.getLocal("r"),e.i32_const(d)),e.drop(e.call(s+"_sub",e.getLocal("r"),e.i32_const(d),e.getLocal("r"))))))}(),function(){const a=t.addFunction(l+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.if(e.call(s+"_sub",e.getLocal("x"),e.getLocal("y"),e.getLocal("r")),e.drop(e.call(s+"_add",e.getLocal("r"),e.i32_const(d),e.getLocal("r")))))}(),function(){const a=t.addFunction(l+"_neg");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.call(l+"_sub",e.i32_const(_),e.getLocal("x"),e.getLocal("r")))}(),function(){const a=t.alloc(c*c*8),e=t.addFunction(l+"_mReduct");e.addParam("t","i32"),e.addParam("r","i32"),e.addLocal("np32","i64"),e.addLocal("c","i64"),e.addLocal("m","i64");const i=e.getCodeBuilder(),n=Number(0x100000000n-wt(o,0x100000000n));e.addCode(i.setLocal("np32",i.i64_const(n)));for(let t=0;t<c;t++){e.addCode(i.setLocal("c",i.i64_const(0))),e.addCode(i.setLocal("m",i.i64_and(i.i64_mul(i.i64_load32_u(i.getLocal("t"),4*t),i.getLocal("np32")),i.i64_const("0xFFFFFFFF"))));for(let a=0;a<c;a++)e.addCode(i.setLocal("c",i.i64_add(i.i64_add(i.i64_load32_u(i.getLocal("t"),4*(t+a)),i.i64_shr_u(i.getLocal("c"),i.i64_const(32))),i.i64_mul(i.i64_load32_u(i.i32_const(d),4*a),i.getLocal("m"))))),e.addCode(i.i64_store32(i.getLocal("t"),4*(t+a),i.getLocal("c")));e.addCode(i.i64_store32(i.i32_const(a),4*t,i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))}e.addCode(i.call(l+"_add",i.i32_const(a),i.i32_add(i.getLocal("t"),i.i32_const(4*c)),i.getLocal("r")))}(),function(){const a=t.addFunction(l+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("np32","i64");for(let t=0;t<c;t++)a.addLocal("x"+t,"i64"),a.addLocal("y"+t,"i64"),a.addLocal("m"+t,"i64"),a.addLocal("q"+t,"i64");const e=a.getCodeBuilder(),i=Number(0x100000000n-wt(o,0x100000000n));a.addCode(e.setLocal("np32",e.i64_const(i)));const n=[],r=[],u=[];function g(t,a){let i,o;return n[t]?i=e.getLocal("x"+t):(i=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),n[t]=!0),r[a]?o=e.getLocal("y"+a):(o=e.teeLocal("y"+a,e.i64_load32_u(e.getLocal("y"),4*a)),r[a]=!0),e.i64_mul(i,o)}function _(t,a){let i,o;return u[t]?i=e.getLocal("q"+t):(i=e.teeLocal("q"+t,e.i64_load32_u(e.i32_const(0),d+4*t)),u[t]=!0),o=e.getLocal("m"+a),e.i64_mul(i,o)}let f="c0",p="c1";for(let t=0;t<2*c-1;t++){for(let i=Math.max(0,t-c+1);i<=t&&i<c;i++){const o=t-i;a.addCode(e.setLocal(f,e.i64_add(e.i64_and(e.getLocal(f),e.i64_const(4294967295)),g(i,o)))),a.addCode(e.setLocal(p,e.i64_add(e.getLocal(p),e.i64_shr_u(e.getLocal(f),e.i64_const(32)))))}for(let i=Math.max(1,t-c+1);i<=t&&i<c;i++){const o=t-i;a.addCode(e.setLocal(f,e.i64_add(e.i64_and(e.getLocal(f),e.i64_const(4294967295)),_(i,o)))),a.addCode(e.setLocal(p,e.i64_add(e.getLocal(p),e.i64_shr_u(e.getLocal(f),e.i64_const(32)))))}t<c&&(a.addCode(e.setLocal("m"+t,e.i64_and(e.i64_mul(e.i64_and(e.getLocal(f),e.i64_const(4294967295)),e.getLocal("np32")),e.i64_const("0xFFFFFFFF")))),a.addCode(e.setLocal(f,e.i64_add(e.i64_and(e.getLocal(f),e.i64_const(4294967295)),_(0,t)))),a.addCode(e.setLocal(p,e.i64_add(e.getLocal(p),e.i64_shr_u(e.getLocal(f),e.i64_const(32)))))),t>=c&&a.addCode(e.i64_store32(e.getLocal("r"),4*(t-c),e.getLocal(f))),[f,p]=[p,f],a.addCode(e.setLocal(p,e.i64_shr_u(e.getLocal(f),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),4*c-4,e.getLocal(f))),a.addCode(e.if(e.i32_wrap_i64(e.getLocal(p)),e.drop(e.call(s+"_sub",e.getLocal("r"),e.i32_const(d),e.getLocal("r"))),e.if(e.call(s+"_gte",e.getLocal("r"),e.i32_const(d)),e.drop(e.call(s+"_sub",e.getLocal("r"),e.i32_const(d),e.getLocal("r"))))))}(),function(){const a=t.addFunction(l+"_square");a.addParam("x","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("c0_old","i64"),a.addLocal("c1_old","i64"),a.addLocal("np32","i64");for(let t=0;t<c;t++)a.addLocal("x"+t,"i64"),a.addLocal("m"+t,"i64"),a.addLocal("q"+t,"i64");const e=a.getCodeBuilder(),i=Number(0x100000000n-wt(o,0x100000000n));a.addCode(e.setLocal("np32",e.i64_const(i)));const n=[],r=[];function u(t,a){let i,o;return n[t]?i=e.getLocal("x"+t):(i=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),n[t]=!0),n[a]?o=e.getLocal("x"+a):(o=e.teeLocal("x"+a,e.i64_load32_u(e.getLocal("x"),4*a)),n[a]=!0),e.i64_mul(i,o)}function g(t,a){let i,o;return r[t]?i=e.getLocal("q"+t):(i=e.teeLocal("q"+t,e.i64_load32_u(e.i32_const(0),d+4*t)),r[t]=!0),o=e.getLocal("m"+a),e.i64_mul(i,o)}let _="c0",f="c1",p="c0_old",h="c1_old";for(let t=0;t<2*c-1;t++){a.addCode(e.setLocal(_,e.i64_const(0)),e.setLocal(f,e.i64_const(0)));for(let i=Math.max(0,t-c+1);i<t+1>>1&&i<c;i++){const o=t-i;a.addCode(e.setLocal(_,e.i64_add(e.i64_and(e.getLocal(_),e.i64_const(4294967295)),u(i,o)))),a.addCode(e.setLocal(f,e.i64_add(e.getLocal(f),e.i64_shr_u(e.getLocal(_),e.i64_const(32)))))}a.addCode(e.setLocal(_,e.i64_shl(e.i64_and(e.getLocal(_),e.i64_const(4294967295)),e.i64_const(1)))),a.addCode(e.setLocal(f,e.i64_add(e.i64_shl(e.getLocal(f),e.i64_const(1)),e.i64_shr_u(e.getLocal(_),e.i64_const(32))))),t%2==0&&(a.addCode(e.setLocal(_,e.i64_add(e.i64_and(e.getLocal(_),e.i64_const(4294967295)),u(t>>1,t>>1)))),a.addCode(e.setLocal(f,e.i64_add(e.getLocal(f),e.i64_shr_u(e.getLocal(_),e.i64_const(32)))))),t>0&&(a.addCode(e.setLocal(_,e.i64_add(e.i64_and(e.getLocal(_),e.i64_const(4294967295)),e.i64_and(e.getLocal(p),e.i64_const(4294967295))))),a.addCode(e.setLocal(f,e.i64_add(e.i64_add(e.getLocal(f),e.i64_shr_u(e.getLocal(_),e.i64_const(32))),e.getLocal(h)))));for(let i=Math.max(1,t-c+1);i<=t&&i<c;i++){const o=t-i;a.addCode(e.setLocal(_,e.i64_add(e.i64_and(e.getLocal(_),e.i64_const(4294967295)),g(i,o)))),a.addCode(e.setLocal(f,e.i64_add(e.getLocal(f),e.i64_shr_u(e.getLocal(_),e.i64_const(32)))))}t<c&&(a.addCode(e.setLocal("m"+t,e.i64_and(e.i64_mul(e.i64_and(e.getLocal(_),e.i64_const(4294967295)),e.getLocal("np32")),e.i64_const("0xFFFFFFFF")))),a.addCode(e.setLocal(_,e.i64_add(e.i64_and(e.getLocal(_),e.i64_const(4294967295)),g(0,t)))),a.addCode(e.setLocal(f,e.i64_add(e.getLocal(f),e.i64_shr_u(e.getLocal(_),e.i64_const(32)))))),t>=c&&a.addCode(e.i64_store32(e.getLocal("r"),4*(t-c),e.getLocal(_))),a.addCode(e.setLocal(p,e.getLocal(f)),e.setLocal(h,e.i64_shr_u(e.getLocal(p),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),4*c-4,e.getLocal(p))),a.addCode(e.if(e.i32_wrap_i64(e.getLocal(h)),e.drop(e.call(s+"_sub",e.getLocal("r"),e.i32_const(d),e.getLocal("r"))),e.if(e.call(s+"_gte",e.getLocal("r"),e.i32_const(d)),e.drop(e.call(s+"_sub",e.getLocal("r"),e.i32_const(d),e.getLocal("r"))))))}(),function(){const a=t.addFunction(l+"_squareOld");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.call(l+"_mul",e.getLocal("x"),e.getLocal("x"),e.getLocal("r")))}(),function(){const a=t.addFunction(l+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.call(l+"_mul",e.getLocal("x"),e.i32_const(u),e.getLocal("r")))}(),function(){const a=t.alloc(2*r),e=t.addFunction(l+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(s+"_copy",i.getLocal("x"),i.i32_const(a))),e.addCode(i.call(s+"_zero",i.i32_const(a+r))),e.addCode(i.call(l+"_mReduct",i.i32_const(a),i.getLocal("r")))}(),function(){const a=t.addFunction(l+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(r));a.addCode(e.call(l+"_fromMontgomery",e.getLocal("x"),i),e.call(s+"_gte",i,e.i32_const(L)))}(),function(){const a=t.addFunction(l+"_sign");a.addParam("x","i32"),a.setReturnType("i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(r));a.addCode(e.if(e.call(s+"_isZero",e.getLocal("x")),e.ret(e.i32_const(0))),e.call(l+"_fromMontgomery",e.getLocal("x"),i),e.if(e.call(s+"_gte",i,e.i32_const(L)),e.ret(e.i32_const(-1))),e.ret(e.i32_const(1)))}(),function(){const a=t.addFunction(l+"_inverse");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.call(l+"_fromMontgomery",e.getLocal("x"),e.getLocal("r"))),a.addCode(e.call(s+"_inverseMod",e.getLocal("r"),e.i32_const(d),e.getLocal("r"))),a.addCode(e.call(l+"_toMontgomery",e.getLocal("r"),e.getLocal("r")))}(),function(){const a=t.addFunction(l+"_one");a.addParam("pr","i32");const e=a.getCodeBuilder();a.addCode(e.call(s+"_copy",e.i32_const(g),e.getLocal("pr")))}(),function(){const a=t.addFunction(l+"_load");a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32"),a.addLocal("p","i32"),a.addLocal("l","i32"),a.addLocal("i","i32"),a.addLocal("j","i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(r)),o=t.alloc(r),n=e.i32_const(o);a.addCode(e.call(s+"_zero",e.getLocal("r")),e.setLocal("i",e.i32_const(r)),e.setLocal("p",e.getLocal("scalar")),e.block(e.loop(e.br_if(1,e.i32_gt_u(e.getLocal("i"),e.getLocal("scalarLen"))),e.if(e.i32_eq(e.getLocal("i"),e.i32_const(r)),e.call(l+"_one",i),e.call(l+"_mul",i,e.i32_const(u),i)),e.call(l+"_mul",e.getLocal("p"),i,n),e.call(l+"_add",e.getLocal("r"),n,e.getLocal("r")),e.setLocal("p",e.i32_add(e.getLocal("p"),e.i32_const(r))),e.setLocal("i",e.i32_add(e.getLocal("i"),e.i32_const(r))),e.br(0))),e.setLocal("l",e.i32_rem_u(e.getLocal("scalarLen"),e.i32_const(r))),e.if(e.i32_eqz(e.getLocal("l")),e.ret([])),e.call(s+"_zero",n),e.setLocal("j",e.i32_const(0)),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("j"),e.getLocal("l"))),e.i32_store8(e.getLocal("j"),o,e.i32_load8_u(e.getLocal("p"))),e.setLocal("p",e.i32_add(e.getLocal("p"),e.i32_const(1))),e.setLocal("j",e.i32_add(e.getLocal("j"),e.i32_const(1))),e.br(0))),e.if(e.i32_eq(e.getLocal("i"),e.i32_const(r)),e.call(l+"_one",i),e.call(l+"_mul",i,e.i32_const(u),i)),e.call(l+"_mul",n,i,n),e.call(l+"_add",e.getLocal("r"),n,e.getLocal("r")))}(),function(){const a=t.addFunction(l+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(r));a.addCode(e.call(l+"_load",e.getLocal("scalar"),e.getLocal("scalarLen"),i),e.call(l+"_toMontgomery",i,i),e.call(l+"_mul",e.getLocal("x"),i,e.getLocal("r")))}(),pt(t,l),ht(t,l+"_batchToMontgomery",l+"_toMontgomery",r,r),ht(t,l+"_batchFromMontgomery",l+"_fromMontgomery",r,r),ht(t,l+"_batchNeg",l+"_neg",r,r),mt(t,l+"_batchAdd",l+"_add",r,r),mt(t,l+"_batchSub",l+"_sub",r,r),mt(t,l+"_batchMul",l+"_mul",r,r),t.exportFunction(l+"_add"),t.exportFunction(l+"_sub"),t.exportFunction(l+"_neg"),t.exportFunction(l+"_isNegative"),t.exportFunction(l+"_isOne"),t.exportFunction(l+"_sign"),t.exportFunction(l+"_mReduct"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_squareOld"),t.exportFunction(l+"_fromMontgomery"),t.exportFunction(l+"_toMontgomery"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_one"),t.exportFunction(l+"_load"),t.exportFunction(l+"_timesScalar"),ft(t,l+"_exp",r,l+"_mul",l+"_square",s+"_copy",l+"_one"),t.exportFunction(l+"_exp"),t.exportFunction(l+"_batchInverse"),bt(o)&&(!function(){const a=t.addFunction(l+"_sqrt");a.addParam("n","i32"),a.addParam("r","i32"),a.addLocal("m","i32"),a.addLocal("i","i32"),a.addLocal("j","i32");const e=a.getCodeBuilder(),i=e.i32_const(g),o=e.i32_const(t.alloc(r)),n=e.i32_const(t.alloc(r)),c=e.i32_const(t.alloc(r)),s=e.i32_const(t.alloc(r)),d=e.i32_const(t.alloc(r));a.addCode(e.if(e.call(l+"_isZero",e.getLocal("n")),e.ret(e.call(l+"_zero",e.getLocal("r")))),e.setLocal("m",e.i32_const(A)),e.call(l+"_copy",e.i32_const(C),o),e.call(l+"_exp",e.getLocal("n"),e.i32_const(y),e.i32_const(r),n),e.call(l+"_exp",e.getLocal("n"),e.i32_const(F),e.i32_const(r),c),e.block(e.loop(e.br_if(1,e.call(l+"_eq",n,i)),e.call(l+"_square",n,s),e.setLocal("i",e.i32_const(1)),e.block(e.loop(e.br_if(1,e.call(l+"_eq",s,i)),e.call(l+"_square",s,s),e.setLocal("i",e.i32_add(e.getLocal("i"),e.i32_const(1))),e.br(0))),e.call(l+"_copy",o,d),e.setLocal("j",e.i32_sub(e.i32_sub(e.getLocal("m"),e.getLocal("i")),e.i32_const(1))),e.block(e.loop(e.br_if(1,e.i32_eqz(e.getLocal("j"))),e.call(l+"_square",d,d),e.setLocal("j",e.i32_sub(e.getLocal("j"),e.i32_const(1))),e.br(0))),e.setLocal("m",e.getLocal("i")),e.call(l+"_square",d,o),e.call(l+"_mul",n,o,n),e.call(l+"_mul",c,d,c),e.br(0))),e.if(e.call(l+"_isNegative",c),e.call(l+"_neg",c,e.getLocal("r")),e.call(l+"_copy",c,e.getLocal("r"))))}(),function(){const a=t.addFunction(l+"_isSquare");a.addParam("n","i32"),a.setReturnType("i32");const e=a.getCodeBuilder(),i=e.i32_const(g),o=e.i32_const(t.alloc(r));a.addCode(e.if(e.call(l+"_isZero",e.getLocal("n")),e.ret(e.i32_const(1))),e.call(l+"_exp",e.getLocal("n"),e.i32_const(h),e.i32_const(r),o),e.call(l+"_eq",o,i))}(),t.exportFunction(l+"_sqrt"),t.exportFunction(l+"_isSquare")),t.exportFunction(l+"_batchToMontgomery"),t.exportFunction(l+"_batchFromMontgomery"),l};const xt=Ct,{bitLength:Ft}=J;var Et=function(t,a,e,i,o){const n=BigInt(a),c=Math.floor((Ft(n-1n)-1)/64)+1,r=8*c,l=e||"f1";if(t.modules[l])return l;t.modules[l]={n64:c};const s=o||"int",d=xt(t,n,i,s),u=t.modules[d].pR2,g=t.modules[d].pq,_=t.modules[d].pePlusOne;return function(){const a=t.alloc(r),e=t.addFunction(l+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const i=e.getCodeBuilder();e.addCode(i.call(d+"_mul",i.getLocal("x"),i.getLocal("y"),i.i32_const(a))),e.addCode(i.call(d+"_mul",i.i32_const(a),i.i32_const(u),i.getLocal("r")))}(),function(){const a=t.addFunction(l+"_square");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.call(l+"_mul",e.getLocal("x"),e.getLocal("x"),e.getLocal("r")))}(),function(){const a=t.addFunction(l+"_inverse");a.addParam("x","i32"),a.addParam("r","i32");const e=a.getCodeBuilder();a.addCode(e.call(s+"_inverseMod",e.getLocal("x"),e.i32_const(g),e.getLocal("r")))}(),function(){const a=t.addFunction(l+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const e=a.getCodeBuilder();a.addCode(e.call(s+"_gte",e.getLocal("x"),e.i32_const(_)))}(),t.exportFunction(d+"_add",l+"_add"),t.exportFunction(d+"_sub",l+"_sub"),t.exportFunction(d+"_neg",l+"_neg"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_isNegative"),t.exportFunction(d+"_copy",l+"_copy"),t.exportFunction(d+"_zero",l+"_zero"),t.exportFunction(d+"_one",l+"_one"),t.exportFunction(d+"_isZero",l+"_isZero"),t.exportFunction(d+"_eq",l+"_eq"),l};const Bt=$,vt=Y,St=H;var Gt=function(t,a,e,i){if(t.modules[e])return e;const o=8*t.modules[i].n64,n=t.modules[i].q;return t.modules[e]={n64:2*t.modules[i].n64},function(){const a=t.addFunction(e+"_isZero");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));a.addCode(n.i32_and(n.call(i+"_isZero",c),n.call(i+"_isZero",r)))}(),function(){const a=t.addFunction(e+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));a.addCode(n.ret(n.i32_and(n.call(i+"_isOne",c),n.call(i+"_isZero",r))))}(),function(){const a=t.addFunction(e+"_zero");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));a.addCode(n.call(i+"_zero",c),n.call(i+"_zero",r))}(),function(){const a=t.addFunction(e+"_one");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));a.addCode(n.call(i+"_one",c),n.call(i+"_zero",r))}(),function(){const a=t.addFunction(e+"_copy");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_copy",c,l),n.call(i+"_copy",r,s))}(),function(){const n=t.addFunction(e+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.getLocal("y"),d=c.i32_add(c.getLocal("y"),c.i32_const(o)),u=c.getLocal("r"),g=c.i32_add(c.getLocal("r"),c.i32_const(o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_mul",r,s,_),c.call(i+"_mul",l,d,f),c.call(i+"_add",r,l,p),c.call(i+"_add",s,d,h),c.call(i+"_mul",p,h,p),c.call(a,f,u),c.call(i+"_add",_,u,u),c.call(i+"_add",_,f,g),c.call(i+"_sub",p,g,g))}(),function(){const a=t.addFunction(e+"_mul1");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_mul",c,l,s),n.call(i+"_mul",r,l,d))}(),function(){const n=t.addFunction(e+"_square");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.getLocal("r"),d=c.i32_add(c.getLocal("r"),c.i32_const(o)),u=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_mul",r,l,u),c.call(i+"_add",r,l,g),c.call(a,l,_),c.call(i+"_add",r,_,_),c.call(a,u,f),c.call(i+"_add",f,u,f),c.call(i+"_mul",g,_,s),c.call(i+"_sub",s,f,s),c.call(i+"_add",u,u,d))}(),function(){const a=t.addFunction(e+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o)),d=n.getLocal("r"),u=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_add",c,l,d),n.call(i+"_add",r,s,u))}(),function(){const a=t.addFunction(e+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o)),d=n.getLocal("r"),u=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_sub",c,l,d),n.call(i+"_sub",r,s,u))}(),function(){const a=t.addFunction(e+"_neg");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_neg",c,l),n.call(i+"_neg",r,s))}(),function(){const a=t.addFunction(e+"_conjugate");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_copy",c,l),n.call(i+"_neg",r,s))}(),function(){const a=t.addFunction(e+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_toMontgomery",c,l),n.call(i+"_toMontgomery",r,s))}(),function(){const a=t.addFunction(e+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_fromMontgomery",c,l),n.call(i+"_fromMontgomery",r,s))}(),function(){const a=t.addFunction(e+"_eq");a.addParam("x","i32"),a.addParam("y","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("y"),s=n.i32_add(n.getLocal("y"),n.i32_const(o));a.addCode(n.i32_and(n.call(i+"_eq",c,l),n.call(i+"_eq",r,s)))}(),function(){const n=t.addFunction(e+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.getLocal("r"),d=c.i32_add(c.getLocal("r"),c.i32_const(o)),u=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_square",r,u),c.call(i+"_square",l,g),c.call(a,g,_),c.call(i+"_sub",u,_,_),c.call(i+"_inverse",_,f),c.call(i+"_mul",r,f,s),c.call(i+"_mul",l,f,d),c.call(i+"_neg",d,d))}(),function(){const a=t.addFunction(e+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.getLocal("r"),s=n.i32_add(n.getLocal("r"),n.i32_const(o));a.addCode(n.call(i+"_timesScalar",c,n.getLocal("scalar"),n.getLocal("scalarLen"),l),n.call(i+"_timesScalar",r,n.getLocal("scalar"),n.getLocal("scalarLen"),s))}(),function(){const a=t.addFunction(e+"_sign");a.addParam("x","i32"),a.addLocal("s","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));a.addCode(n.setLocal("s",n.call(i+"_sign",r)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(i+"_sign",c)))}(),function(){const a=t.addFunction(e+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o));a.addCode(n.if(n.call(i+"_isZero",r),n.ret(n.call(i+"_isNegative",c))),n.ret(n.call(i+"_isNegative",r)))}(),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isOne"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_one"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_mul"),t.exportFunction(e+"_mul1"),t.exportFunction(e+"_square"),t.exportFunction(e+"_add"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_sign"),t.exportFunction(e+"_conjugate"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_inverse"),vt(t,e),Bt(t,e+"_exp",2*o,e+"_mul",e+"_square",e+"_copy",e+"_one"),function(){const a=t.addFunction(e+"_sqrt");a.addParam("a","i32"),a.addParam("pr","i32");const c=a.getCodeBuilder(),r=c.i32_const(t.alloc(St.bigInt2BytesLE((BigInt(n||0)-3n)/4n,o))),l=c.i32_const(t.alloc(St.bigInt2BytesLE((BigInt(n||0)-1n)/2n,o))),s=c.getLocal("a"),d=c.i32_const(t.alloc(2*o)),u=c.i32_const(t.alloc(2*o)),g=c.i32_const(t.alloc(2*o)),_=t.alloc(2*o),f=c.i32_const(_),p=c.i32_const(_),h=c.i32_const(_+o),m=c.i32_const(t.alloc(2*o)),L=c.i32_const(t.alloc(2*o));a.addCode(c.call(e+"_one",f),c.call(e+"_neg",f,f),c.call(e+"_exp",s,r,c.i32_const(o),d),c.call(e+"_square",d,u),c.call(e+"_mul",s,u,u),c.call(e+"_conjugate",u,g),c.call(e+"_mul",g,u,g),c.if(c.call(e+"_eq",g,f),c.unreachable()),c.call(e+"_mul",d,s,m),c.if(c.call(e+"_eq",u,f),[...c.call(i+"_zero",p),...c.call(i+"_one",h),...c.call(e+"_mul",f,m,c.getLocal("pr"))],[...c.call(e+"_one",L),...c.call(e+"_add",L,u,L),...c.call(e+"_exp",L,l,c.i32_const(o),L),...c.call(e+"_mul",L,m,c.getLocal("pr"))]))}(),function(){const a=t.addFunction(e+"_isSquare");a.addParam("a","i32"),a.setReturnType("i32");const i=a.getCodeBuilder(),c=i.i32_const(t.alloc(St.bigInt2BytesLE((BigInt(n||0)-3n)/4n,o))),r=i.getLocal("a"),l=i.i32_const(t.alloc(2*o)),s=i.i32_const(t.alloc(2*o)),d=i.i32_const(t.alloc(2*o)),u=t.alloc(2*o),g=i.i32_const(u);a.addCode(i.call(e+"_one",g),i.call(e+"_neg",g,g),i.call(e+"_exp",r,c,i.i32_const(o),l),i.call(e+"_square",l,s),i.call(e+"_mul",r,s,s),i.call(e+"_conjugate",s,d),i.call(e+"_mul",d,s,d),i.if(i.call(e+"_eq",d,g),i.ret(i.i32_const(0))),i.ret(i.i32_const(1)))}(),t.exportFunction(e+"_exp"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_batchInverse"),t.exportFunction(e+"_sqrt"),t.exportFunction(e+"_isSquare"),t.exportFunction(e+"_isNegative"),e};const Pt=$,Ut=Y;var Ot=function(t,a,e,i){if(t.modules[e])return e;const o=8*t.modules[i].n64;return t.modules[e]={n64:3*t.modules[i].n64},function(){const a=t.addFunction(e+"_isZero");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));a.addCode(n.i32_and(n.i32_and(n.call(i+"_isZero",c),n.call(i+"_isZero",r)),n.call(i+"_isZero",l)))}(),function(){const a=t.addFunction(e+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));a.addCode(n.ret(n.i32_and(n.i32_and(n.call(i+"_isOne",c),n.call(i+"_isZero",r)),n.call(i+"_isZero",l))))}(),function(){const a=t.addFunction(e+"_zero");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));a.addCode(n.call(i+"_zero",c),n.call(i+"_zero",r),n.call(i+"_zero",l))}(),function(){const a=t.addFunction(e+"_one");a.addParam("x","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));a.addCode(n.call(i+"_one",c),n.call(i+"_zero",r),n.call(i+"_zero",l))}(),function(){const a=t.addFunction(e+"_copy");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));a.addCode(n.call(i+"_copy",c,s),n.call(i+"_copy",r,d),n.call(i+"_copy",l,u))}(),function(){const n=t.addFunction(e+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),d=c.getLocal("y"),u=c.i32_add(c.getLocal("y"),c.i32_const(o)),g=c.i32_add(c.getLocal("y"),c.i32_const(2*o)),_=c.getLocal("r"),f=c.i32_add(c.getLocal("r"),c.i32_const(o)),p=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),h=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),w=c.i32_const(t.alloc(o)),A=c.i32_const(t.alloc(o)),b=c.i32_const(t.alloc(o)),y=c.i32_const(t.alloc(o)),I=c.i32_const(t.alloc(o)),C=c.i32_const(t.alloc(o)),x=c.i32_const(t.alloc(o)),F=c.i32_const(t.alloc(o)),E=c.i32_const(t.alloc(o)),B=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_mul",r,d,h),c.call(i+"_mul",l,u,m),c.call(i+"_mul",s,g,L),c.call(i+"_add",r,l,w),c.call(i+"_add",d,u,A),c.call(i+"_add",r,s,b),c.call(i+"_add",d,g,y),c.call(i+"_add",l,s,I),c.call(i+"_add",u,g,C),c.call(i+"_add",h,m,x),c.call(i+"_add",h,L,F),c.call(i+"_add",m,L,E),c.call(i+"_mul",I,C,_),c.call(i+"_sub",_,E,_),c.call(a,_,_),c.call(i+"_add",h,_,_),c.call(i+"_mul",w,A,f),c.call(i+"_sub",f,x,f),c.call(a,L,B),c.call(i+"_add",f,B,f),c.call(i+"_mul",b,y,p),c.call(i+"_sub",p,F,p),c.call(i+"_add",p,m,p))}(),function(){const n=t.addFunction(e+"_square");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),d=c.getLocal("r"),u=c.i32_add(c.getLocal("r"),c.i32_const(o)),g=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),w=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_square",r,_),c.call(i+"_mul",r,l,f),c.call(i+"_add",f,f,p),c.call(i+"_sub",r,l,h),c.call(i+"_add",h,s,h),c.call(i+"_square",h,h),c.call(i+"_mul",l,s,m),c.call(i+"_add",m,m,L),c.call(i+"_square",s,w),c.call(a,L,d),c.call(i+"_add",_,d,d),c.call(a,w,u),c.call(i+"_add",p,u,u),c.call(i+"_add",_,w,g),c.call(i+"_sub",L,g,g),c.call(i+"_add",h,g,g),c.call(i+"_add",p,g,g))}(),function(){const a=t.addFunction(e+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o)),g=n.getLocal("r"),_=n.i32_add(n.getLocal("r"),n.i32_const(o)),f=n.i32_add(n.getLocal("r"),n.i32_const(2*o));a.addCode(n.call(i+"_add",c,s,g),n.call(i+"_add",r,d,_),n.call(i+"_add",l,u,f))}(),function(){const a=t.addFunction(e+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o)),g=n.getLocal("r"),_=n.i32_add(n.getLocal("r"),n.i32_const(o)),f=n.i32_add(n.getLocal("r"),n.i32_const(2*o));a.addCode(n.call(i+"_sub",c,s,g),n.call(i+"_sub",r,d,_),n.call(i+"_sub",l,u,f))}(),function(){const a=t.addFunction(e+"_neg");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));a.addCode(n.call(i+"_neg",c,s),n.call(i+"_neg",r,d),n.call(i+"_neg",l,u))}(),function(){const a=t.addFunction(e+"_sign");a.addParam("x","i32"),a.addLocal("s","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));a.addCode(n.setLocal("s",n.call(i+"_sign",l)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.setLocal("s",n.call(i+"_sign",r)),n.if(n.getLocal("s"),n.ret(n.getLocal("s"))),n.ret(n.call(i+"_sign",c)))}(),function(){const a=t.addFunction(e+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));a.addCode(n.call(i+"_toMontgomery",c,s),n.call(i+"_toMontgomery",r,d),n.call(i+"_toMontgomery",l,u))}(),function(){const a=t.addFunction(e+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));a.addCode(n.call(i+"_fromMontgomery",c,s),n.call(i+"_fromMontgomery",r,d),n.call(i+"_fromMontgomery",l,u))}(),function(){const a=t.addFunction(e+"_eq");a.addParam("x","i32"),a.addParam("y","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("y"),d=n.i32_add(n.getLocal("y"),n.i32_const(o)),u=n.i32_add(n.getLocal("y"),n.i32_const(2*o));a.addCode(n.i32_and(n.i32_and(n.call(i+"_eq",c,s),n.call(i+"_eq",r,d)),n.call(i+"_eq",l,u)))}(),function(){const n=t.addFunction(e+"_inverse");n.addParam("x","i32"),n.addParam("r","i32");const c=n.getCodeBuilder(),r=c.getLocal("x"),l=c.i32_add(c.getLocal("x"),c.i32_const(o)),s=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),d=c.getLocal("r"),u=c.i32_add(c.getLocal("r"),c.i32_const(o)),g=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),_=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),w=c.i32_const(t.alloc(o)),A=c.i32_const(t.alloc(o)),b=c.i32_const(t.alloc(o)),y=c.i32_const(t.alloc(o)),I=c.i32_const(t.alloc(o));n.addCode(c.call(i+"_square",r,_),c.call(i+"_square",l,f),c.call(i+"_square",s,p),c.call(i+"_mul",r,l,h),c.call(i+"_mul",r,s,m),c.call(i+"_mul",l,s,L),c.call(a,L,w),c.call(i+"_sub",_,w,w),c.call(a,p,A),c.call(i+"_sub",A,h,A),c.call(i+"_sub",f,m,b),c.call(i+"_mul",s,A,y),c.call(i+"_mul",l,b,I),c.call(i+"_add",y,I,y),c.call(a,y,y),c.call(i+"_mul",r,w,I),c.call(i+"_add",I,y,y),c.call(i+"_inverse",y,y),c.call(i+"_mul",y,w,d),c.call(i+"_mul",y,A,u),c.call(i+"_mul",y,b,g))}(),function(){const a=t.addFunction(e+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o)),s=n.getLocal("r"),d=n.i32_add(n.getLocal("r"),n.i32_const(o)),u=n.i32_add(n.getLocal("r"),n.i32_const(2*o));a.addCode(n.call(i+"_timesScalar",c,n.getLocal("scalar"),n.getLocal("scalarLen"),s),n.call(i+"_timesScalar",r,n.getLocal("scalar"),n.getLocal("scalarLen"),d),n.call(i+"_timesScalar",l,n.getLocal("scalar"),n.getLocal("scalarLen"),u))}(),function(){const a=t.addFunction(e+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");const n=a.getCodeBuilder(),c=n.getLocal("x"),r=n.i32_add(n.getLocal("x"),n.i32_const(o)),l=n.i32_add(n.getLocal("x"),n.i32_const(2*o));a.addCode(n.if(n.call(i+"_isZero",l),n.if(n.call(i+"_isZero",r),n.ret(n.call(i+"_isNegative",c)),n.ret(n.call(i+"_isNegative",r)))),n.ret(n.call(i+"_isNegative",l)))}(),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isOne"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_one"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_mul"),t.exportFunction(e+"_square"),t.exportFunction(e+"_add"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_sign"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_inverse"),Ut(t,e),Pt(t,e+"_exp",3*o,e+"_mul",e+"_square",e+"_copy",e+"_one"),t.exportFunction(e+"_exp"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_batchInverse"),t.exportFunction(e+"_isNegative"),e};const zt=function(t,a,e,i,o,n,c,r){const l=t.addFunction(a);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("old0","i32"),l.addLocal("nbits","i32"),l.addLocal("i","i32"),l.addLocal("last","i32"),l.addLocal("cur","i32"),l.addLocal("carry","i32"),l.addLocal("p","i32");const s=l.getCodeBuilder(),d=s.i32_const(t.alloc(e));function u(t){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(t,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(t,s.i32_const(31))),s.i32_const(1))}function g(t){return[...s.i32_store8(s.getLocal("p"),s.i32_const(t)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}l.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(r,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",u(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",u(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...g(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...g(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...g(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...g(255),...g(0),...g(1)],[...g(1)]),s.if(s.getLocal("carry"),[...g(0),...g(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(c,s.getLocal("base"),d),s.call(r,s.getLocal("r")),s.block(s.loop(s.call(o,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(i,s.getLocal("r"),d,s.getLocal("r")),s.call(n,s.getLocal("r"),d,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},Qt=W,qt=function(t,a,e,i,o){const n=8*t.modules[a].n64;function c(){const i=t.addFunction(e);i.addParam("pBases","i32"),i.addParam("pScalars","i32"),i.addParam("scalarSize","i32"),i.addParam("n","i32"),i.addParam("pr","i32"),i.addLocal("chunkSize","i32"),i.addLocal("nChunks","i32"),i.addLocal("itScalar","i32"),i.addLocal("endScalar","i32"),i.addLocal("itBase","i32"),i.addLocal("itBit","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("nTable","i32"),i.addLocal("pTable","i32"),i.addLocal("idx","i32"),i.addLocal("pIdxTable","i32");const o=i.getCodeBuilder(),c=o.i32_const(t.alloc(n)),r=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);i.addCode(o.call(a+"_zero",o.getLocal("pr")),o.if(o.i32_eqz(o.getLocal("n")),o.ret([])),o.setLocal("chunkSize",o.i32_load8_u(o.i32_clz(o.getLocal("n")),r)),o.setLocal("nChunks",o.i32_add(o.i32_div_u(o.i32_sub(o.i32_shl(o.getLocal("scalarSize"),o.i32_const(3)),o.i32_const(1)),o.getLocal("chunkSize")),o.i32_const(1))),o.setLocal("itBit",o.i32_mul(o.i32_sub(o.getLocal("nChunks"),o.i32_const(1)),o.getLocal("chunkSize"))),o.block(o.loop(o.br_if(1,o.i32_lt_s(o.getLocal("itBit"),o.i32_const(0))),o.if(o.i32_eqz(o.call(a+"_isZero",o.getLocal("pr"))),[...o.setLocal("j",o.i32_const(0)),...o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("chunkSize"))),o.call(a+"_double",o.getLocal("pr"),o.getLocal("pr")),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0)))]),o.call(e+"_chunk",o.getLocal("pBases"),o.getLocal("pScalars"),o.getLocal("scalarSize"),o.getLocal("n"),o.getLocal("itBit"),o.getLocal("chunkSize"),c),o.call(a+"_add",o.getLocal("pr"),c,o.getLocal("pr")),o.setLocal("itBit",o.i32_sub(o.getLocal("itBit"),o.getLocal("chunkSize"))),o.br(0))))}!function(){const a=t.addFunction(e+"_getChunk");a.addParam("pScalar","i32"),a.addParam("scalarSize","i32"),a.addParam("startBit","i32"),a.addParam("chunkSize","i32"),a.addLocal("bitsToEnd","i32"),a.addLocal("mask","i32"),a.setReturnType("i32");const i=a.getCodeBuilder();a.addCode(i.setLocal("bitsToEnd",i.i32_sub(i.i32_mul(i.getLocal("scalarSize"),i.i32_const(8)),i.getLocal("startBit"))),i.if(i.i32_gt_s(i.getLocal("chunkSize"),i.getLocal("bitsToEnd")),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("bitsToEnd")),i.i32_const(1))),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("chunkSize")),i.i32_const(1)))),i.i32_and(i.i32_shr_u(i.i32_load(i.i32_add(i.getLocal("pScalar"),i.i32_shr_u(i.getLocal("startBit"),i.i32_const(3))),0,0),i.i32_and(i.getLocal("startBit"),i.i32_const(7))),i.getLocal("mask")))}(),function(){const i=t.addFunction(e+"_reduceTable");i.addParam("pTable","i32"),i.addParam("p","i32"),i.addLocal("half","i32"),i.addLocal("it1","i32"),i.addLocal("it2","i32"),i.addLocal("pAcc","i32");const o=i.getCodeBuilder();i.addCode(o.if(o.i32_eq(o.getLocal("p"),o.i32_const(1)),o.ret([])),o.setLocal("half",o.i32_shl(o.i32_const(1),o.i32_sub(o.getLocal("p"),o.i32_const(1)))),o.setLocal("it1",o.getLocal("pTable")),o.setLocal("it2",o.i32_add(o.getLocal("pTable"),o.i32_mul(o.getLocal("half"),o.i32_const(n)))),o.setLocal("pAcc",o.i32_sub(o.getLocal("it2"),o.i32_const(n))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("it1"),o.getLocal("pAcc"))),o.call(a+"_add",o.getLocal("it1"),o.getLocal("it2"),o.getLocal("it1")),o.call(a+"_add",o.getLocal("pAcc"),o.getLocal("it2"),o.getLocal("pAcc")),o.setLocal("it1",o.i32_add(o.getLocal("it1"),o.i32_const(n))),o.setLocal("it2",o.i32_add(o.getLocal("it2"),o.i32_const(n))),o.br(0))),o.call(e+"_reduceTable",o.getLocal("pTable"),o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("p"))),o.call(a+"_double",o.getLocal("pAcc"),o.getLocal("pAcc")),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.br(0))),o.call(a+"_add",o.getLocal("pTable"),o.getLocal("pAcc"),o.getLocal("pTable")))}(),function(){const c=t.addFunction(e+"_chunk");c.addParam("pBases","i32"),c.addParam("pScalars","i32"),c.addParam("scalarSize","i32"),c.addParam("n","i32"),c.addParam("startBit","i32"),c.addParam("chunkSize","i32"),c.addParam("pr","i32"),c.addLocal("nChunks","i32"),c.addLocal("itScalar","i32"),c.addLocal("endScalar","i32"),c.addLocal("itBase","i32"),c.addLocal("i","i32"),c.addLocal("j","i32"),c.addLocal("nTable","i32"),c.addLocal("pTable","i32"),c.addLocal("idx","i32"),c.addLocal("pIdxTable","i32");const r=c.getCodeBuilder();c.addCode(r.if(r.i32_eqz(r.getLocal("n")),[...r.call(a+"_zero",r.getLocal("pr")),...r.ret([])]),r.setLocal("nTable",r.i32_shl(r.i32_const(1),r.getLocal("chunkSize"))),r.setLocal("pTable",r.i32_load(r.i32_const(0))),r.i32_store(r.i32_const(0),r.i32_add(r.getLocal("pTable"),r.i32_mul(r.getLocal("nTable"),r.i32_const(n)))),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("j"),r.getLocal("nTable"))),r.call(a+"_zero",r.i32_add(r.getLocal("pTable"),r.i32_mul(r.getLocal("j"),r.i32_const(n)))),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("itBase",r.getLocal("pBases")),r.setLocal("itScalar",r.getLocal("pScalars")),r.setLocal("endScalar",r.i32_add(r.getLocal("pScalars"),r.i32_mul(r.getLocal("n"),r.getLocal("scalarSize")))),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("itScalar"),r.getLocal("endScalar"))),r.setLocal("idx",r.call(e+"_getChunk",r.getLocal("itScalar"),r.getLocal("scalarSize"),r.getLocal("startBit"),r.getLocal("chunkSize"))),r.if(r.getLocal("idx"),[...r.setLocal("pIdxTable",r.i32_add(r.getLocal("pTable"),r.i32_mul(r.i32_sub(r.getLocal("idx"),r.i32_const(1)),r.i32_const(n)))),...r.call(i,r.getLocal("pIdxTable"),r.getLocal("itBase"),r.getLocal("pIdxTable"))]),r.setLocal("itScalar",r.i32_add(r.getLocal("itScalar"),r.getLocal("scalarSize"))),r.setLocal("itBase",r.i32_add(r.getLocal("itBase"),r.i32_const(o))),r.br(0))),r.call(e+"_reduceTable",r.getLocal("pTable"),r.getLocal("chunkSize")),r.call(a+"_copy",r.getLocal("pTable"),r.getLocal("pr")),r.i32_store(r.i32_const(0),r.getLocal("pTable")))}(),c(),t.exportFunction(e),t.exportFunction(e+"_chunk")};var Mt=function(t,a,e,i){const o=t.modules[e].n64,n=8*o;if(t.modules[a])return a;return t.modules[a]={n64:3*o},function(){const i=t.addFunction(a+"_isZeroAffine");i.addParam("p1","i32"),i.setReturnType("i32");const o=i.getCodeBuilder();i.addCode(o.i32_and(o.call(e+"_isZero",o.getLocal("p1")),o.call(e+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(n)))))}(),function(){const i=t.addFunction(a+"_isZero");i.addParam("p1","i32"),i.setReturnType("i32");const o=i.getCodeBuilder();i.addCode(o.call(e+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))))}(),function(){const i=t.addFunction(a+"_zeroAffine");i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(e+"_zero",o.getLocal("pr"))),i.addCode(o.call(e+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(n))))}(),function(){const i=t.addFunction(a+"_zero");i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(e+"_zero",o.getLocal("pr"))),i.addCode(o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(n)))),i.addCode(o.call(e+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))))}(),function(){const e=t.addFunction(a+"_copyAffine");e.addParam("ps","i32"),e.addParam("pd","i32");const i=e.getCodeBuilder();for(let t=0;t<2*o;t++)e.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const e=t.addFunction(a+"_copy");e.addParam("ps","i32"),e.addParam("pd","i32");const i=e.getCodeBuilder();for(let t=0;t<3*o;t++)e.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const i=t.addFunction(a+"_toJacobian");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*n));i.addCode(o.if(o.call(a+"_isZeroAffine",o.getLocal("p1")),o.call(a+"_zero",o.getLocal("pr")),[...o.call(e+"_one",d),...o.call(e+"_copy",r,s),...o.call(e+"_copy",c,l)]))}(),function(){const i=t.addFunction(a+"_eqAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder();i.addCode(o.ret(o.i32_and(o.call(e+"_eq",o.getLocal("p1"),o.getLocal("p2")),o.call(e+"_eq",o.i32_add(o.getLocal("p1"),o.i32_const(n)),o.i32_add(o.getLocal("p2"),o.i32_const(n))))))}(),function(){const i=t.addFunction(a+"_eqMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),o.ret(o.call(a+"_isZeroAffine",o.getLocal("p2")))),o.if(o.call(a+"_isZeroAffine",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(e+"_isOne",l),o.ret(o.call(a+"_eqAffine",o.getLocal("p1"),o.getLocal("p2")))),o.call(e+"_square",l,u),o.call(e+"_mul",s,u,g),o.call(e+"_mul",l,u,_),o.call(e+"_mul",d,_,f),o.if(o.call(e+"_eq",c,g),o.if(o.call(e+"_eq",r,f),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){const i=t.addFunction(a+"_eq");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*n))));const u=o.getLocal("z2"),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),o.ret(o.call(a+"_isZero",o.getLocal("p2")))),o.if(o.call(a+"_isZero",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(e+"_isOne",l),o.ret(o.call(a+"_eqMixed",o.getLocal("p2"),o.getLocal("p1")))),o.if(o.call(e+"_isOne",u),o.ret(o.call(a+"_eqMixed",o.getLocal("p1"),o.getLocal("p2")))),o.call(e+"_square",l,g),o.call(e+"_square",u,_),o.call(e+"_mul",c,_,f),o.call(e+"_mul",s,g,p),o.call(e+"_mul",l,g,h),o.call(e+"_mul",u,_,m),o.call(e+"_mul",r,m,L),o.call(e+"_mul",d,h,w),o.if(o.call(e+"_eq",f,p),o.if(o.call(e+"_eq",L,w),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){const i=t.addFunction(a+"_doubleAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZeroAffine",o.getLocal("p1")),[...o.call(a+"_toJacobian",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.call(e+"_square",c,u),o.call(e+"_square",r,g),o.call(e+"_square",g,_),o.call(e+"_add",c,g,f),o.call(e+"_square",f,f),o.call(e+"_sub",f,u,f),o.call(e+"_sub",f,_,f),o.call(e+"_add",f,f,f),o.call(e+"_add",u,u,p),o.call(e+"_add",p,u,p),o.call(e+"_add",r,r,d),o.call(e+"_square",p,l),o.call(e+"_sub",l,f,l),o.call(e+"_sub",l,f,l),o.call(e+"_add",_,_,h),o.call(e+"_add",h,h,h),o.call(e+"_add",h,h,h),o.call(e+"_sub",f,l,s),o.call(e+"_mul",s,p,s),o.call(e+"_sub",s,h,s))}(),function(){const i=t.addFunction(a+"_double");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(a+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isOne",l),[...o.ret(o.call(a+"_doubleAffine",o.getLocal("p1"),o.getLocal("pr"))),...o.ret([])]),o.call(e+"_square",c,g),o.call(e+"_square",r,_),o.call(e+"_square",_,f),o.call(e+"_add",c,_,p),o.call(e+"_square",p,p),o.call(e+"_sub",p,g,p),o.call(e+"_sub",p,f,p),o.call(e+"_add",p,p,p),o.call(e+"_add",g,g,h),o.call(e+"_add",h,g,h),o.call(e+"_square",h,m),o.call(e+"_mul",r,l,L),o.call(e+"_add",p,p,s),o.call(e+"_sub",m,s,s),o.call(e+"_add",f,f,w),o.call(e+"_add",w,w,w),o.call(e+"_add",w,w,w),o.call(e+"_sub",p,s,d),o.call(e+"_mul",d,h,d),o.call(e+"_sub",d,w,d),o.call(e+"_add",L,L,u))}(),function(){const i=t.addFunction(a+"_addAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("p2"),s=o.i32_add(o.getLocal("p2"),o.i32_const(n)),d=o.getLocal("pr"),u=o.i32_add(o.getLocal("pr"),o.i32_const(n)),g=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZeroAffine",o.getLocal("p1")),[...o.call(a+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(a+"_isZeroAffine",o.getLocal("p2")),[...o.call(a+"_copyAffine",o.getLocal("p1"),o.getLocal("pr")),...o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(e+"_eq",c,l),o.if(o.call(e+"_eq",r,s),[...o.call(a+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(e+"_sub",l,c,_),o.call(e+"_sub",s,r,p),o.call(e+"_square",_,f),o.call(e+"_add",f,f,h),o.call(e+"_add",h,h,h),o.call(e+"_mul",_,h,m),o.call(e+"_add",p,p,L),o.call(e+"_mul",c,h,A),o.call(e+"_square",L,w),o.call(e+"_add",A,A,b),o.call(e+"_sub",w,m,d),o.call(e+"_sub",d,b,d),o.call(e+"_mul",r,m,y),o.call(e+"_add",y,y,y),o.call(e+"_sub",A,d,u),o.call(e+"_mul",u,L,u),o.call(e+"_sub",u,y,u),o.call(e+"_add",_,_,g))}(),function(){const i=t.addFunction(a+"_addMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n)),u=o.getLocal("pr"),g=o.i32_add(o.getLocal("pr"),o.i32_const(n)),_=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),f=o.i32_const(t.alloc(n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n)),I=o.i32_const(t.alloc(n)),C=o.i32_const(t.alloc(n)),x=o.i32_const(t.alloc(n)),F=o.i32_const(t.alloc(n)),E=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(a+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*n))),...o.ret([])]),o.if(o.call(a+"_isZeroAffine",o.getLocal("p2")),[...o.call(a+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isOne",l),[...o.call(a+"_addAffine",c,s,u),...o.ret([])]),o.call(e+"_square",l,f),o.call(e+"_mul",s,f,p),o.call(e+"_mul",l,f,h),o.call(e+"_mul",d,h,m),o.if(o.call(e+"_eq",c,p),o.if(o.call(e+"_eq",r,m),[...o.call(a+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(e+"_sub",p,c,L),o.call(e+"_sub",m,r,A),o.call(e+"_square",L,w),o.call(e+"_add",w,w,b),o.call(e+"_add",b,b,b),o.call(e+"_mul",L,b,y),o.call(e+"_add",A,A,I),o.call(e+"_mul",c,b,x),o.call(e+"_square",I,C),o.call(e+"_add",x,x,F),o.call(e+"_sub",C,y,u),o.call(e+"_sub",u,F,u),o.call(e+"_mul",r,y,E),o.call(e+"_add",E,E,E),o.call(e+"_sub",x,u,g),o.call(e+"_mul",g,I,g),o.call(e+"_sub",g,E,g),o.call(e+"_add",l,L,_),o.call(e+"_square",_,_),o.call(e+"_sub",_,f,_),o.call(e+"_sub",_,w,_))}(),function(){const i=t.addFunction(a+"_add");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*n))));const l=o.getLocal("z1"),s=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(n));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*n))));const u=o.getLocal("z2"),g=o.getLocal("pr"),_=o.i32_add(o.getLocal("pr"),o.i32_const(n)),f=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),p=o.i32_const(t.alloc(n)),h=o.i32_const(t.alloc(n)),m=o.i32_const(t.alloc(n)),L=o.i32_const(t.alloc(n)),w=o.i32_const(t.alloc(n)),A=o.i32_const(t.alloc(n)),b=o.i32_const(t.alloc(n)),y=o.i32_const(t.alloc(n)),I=o.i32_const(t.alloc(n)),C=o.i32_const(t.alloc(n)),x=o.i32_const(t.alloc(n)),F=o.i32_const(t.alloc(n)),E=o.i32_const(t.alloc(n)),B=o.i32_const(t.alloc(n)),v=o.i32_const(t.alloc(n)),S=o.i32_const(t.alloc(n)),G=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(a+"_copy",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isZero",o.getLocal("p2")),[...o.call(a+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isOne",l),[...o.call(a+"_addMixed",s,c,g),...o.ret([])]),o.if(o.call(e+"_isOne",u),[...o.call(a+"_addMixed",c,s,g),...o.ret([])]),o.call(e+"_square",l,p),o.call(e+"_square",u,h),o.call(e+"_mul",c,h,m),o.call(e+"_mul",s,p,L),o.call(e+"_mul",l,p,w),o.call(e+"_mul",u,h,A),o.call(e+"_mul",r,A,b),o.call(e+"_mul",d,w,y),o.if(o.call(e+"_eq",m,L),o.if(o.call(e+"_eq",b,y),[...o.call(a+"_double",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])])),o.call(e+"_sub",L,m,I),o.call(e+"_sub",y,b,C),o.call(e+"_add",I,I,x),o.call(e+"_square",x,x),o.call(e+"_mul",I,x,F),o.call(e+"_add",C,C,E),o.call(e+"_mul",m,x,v),o.call(e+"_square",E,B),o.call(e+"_add",v,v,S),o.call(e+"_sub",B,F,g),o.call(e+"_sub",g,S,g),o.call(e+"_mul",b,F,G),o.call(e+"_add",G,G,G),o.call(e+"_sub",v,g,_),o.call(e+"_mul",_,E,_),o.call(e+"_sub",_,G,_),o.call(e+"_add",l,u,f),o.call(e+"_square",f,f),o.call(e+"_sub",f,p,f),o.call(e+"_sub",f,h,f),o.call(e+"_mul",f,I,f))}(),function(){const i=t.addFunction(a+"_negAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(n));i.addCode(o.call(e+"_copy",c,l),o.call(e+"_neg",r,s))}(),function(){const i=t.addFunction(a+"_neg");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n));i.addCode(o.call(e+"_copy",c,s),o.call(e+"_neg",r,d),o.call(e+"_copy",l,u))}(),function(){const e=t.addFunction(a+"_subAffine");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));e.addCode(i.call(a+"_negAffine",i.getLocal("p2"),o),i.call(a+"_addAffine",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const e=t.addFunction(a+"_subMixed");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));e.addCode(i.call(a+"_negAffine",i.getLocal("p2"),o),i.call(a+"_addMixed",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const e=t.addFunction(a+"_sub");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(3*n));e.addCode(i.call(a+"_neg",i.getLocal("p2"),o),i.call(a+"_add",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){const i=t.addFunction(a+"_fromMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(e+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(e+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(a+"_fromMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(e+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(e+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(a+"_toMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(e+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(e+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(a+"_toMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder();i.addCode(o.call(e+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(e+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*n)),o.i32_add(o.getLocal("pr"),o.i32_const(t*n))))}(),function(){const i=t.addFunction(a+"_toAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_const(t.alloc(n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(e+"_zero",s),...o.call(e+"_zero",d)],[...o.call(e+"_inverse",l,u),...o.call(e+"_square",u,g),...o.call(e+"_mul",u,g,_),...o.call(e+"_mul",c,g,s),...o.call(e+"_mul",r,_,d)]))}(),function(){const o=t.addFunction(a+"_inCurveAffine");o.addParam("pIn","i32"),o.setReturnType("i32");const c=o.getCodeBuilder(),r=c.getLocal("pIn"),l=c.i32_add(c.getLocal("pIn"),c.i32_const(n)),s=c.i32_const(t.alloc(n)),d=c.i32_const(t.alloc(n));o.addCode(c.call(e+"_square",l,s),c.call(e+"_square",r,d),c.call(e+"_mul",r,d,d),c.call(e+"_add",d,c.i32_const(i),d),c.ret(c.call(e+"_eq",s,d)))}(),function(){const e=t.addFunction(a+"_inCurve");e.addParam("pIn","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),o=i.i32_const(t.alloc(2*n));e.addCode(i.call(a+"_toAffine",i.getLocal("pIn"),o),i.ret(i.call(a+"_inCurveAffine",o)))}(),function(){const i=t.addFunction(a+"_batchToAffine");i.addParam("pIn","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addLocal("pAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itAux","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const o=i.getCodeBuilder(),c=o.i32_const(t.alloc(n));i.addCode(o.setLocal("pAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("pAux"),o.i32_mul(o.getLocal("n"),o.i32_const(n)))),o.call(e+"_batchInverse",o.i32_add(o.getLocal("pIn"),o.i32_const(2*n)),o.i32_const(3*n),o.getLocal("n"),o.getLocal("pAux"),o.i32_const(n)),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.getLocal("pAux")),o.setLocal("itOut",o.getLocal("pOut")),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(e+"_isZero",o.getLocal("itAux")),[...o.call(e+"_zero",o.getLocal("itOut")),...o.call(e+"_zero",o.i32_add(o.getLocal("itOut"),o.i32_const(n)))],[...o.call(e+"_mul",o.getLocal("itAux"),o.i32_add(o.getLocal("itIn"),o.i32_const(n)),c),...o.call(e+"_square",o.getLocal("itAux"),o.getLocal("itAux")),...o.call(e+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.getLocal("itOut")),...o.call(e+"_mul",o.getLocal("itAux"),c,o.i32_add(o.getLocal("itOut"),o.i32_const(n)))]),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.i32_const(3*n))),o.setLocal("itOut",o.i32_add(o.getLocal("itOut"),o.i32_const(2*n))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.i32_store(o.i32_const(0),o.getLocal("pAux")))}(),function(){const i=t.addFunction(a+"_normalize");i.addParam("p1","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),c=o.getLocal("p1"),r=o.i32_add(o.getLocal("p1"),o.i32_const(n)),l=o.i32_add(o.getLocal("p1"),o.i32_const(2*n)),s=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(n)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*n)),g=o.i32_const(t.alloc(n)),_=o.i32_const(t.alloc(n)),f=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),o.call(a+"_zero",o.getLocal("pr")),[...o.call(e+"_inverse",l,g),...o.call(e+"_square",g,_),...o.call(e+"_mul",g,_,f),...o.call(e+"_mul",c,_,s),...o.call(e+"_mul",r,f,d),...o.call(e+"_one",u)]))}(),function(){const e=t.addFunction(a+"__reverseBytes");e.addParam("pIn","i32"),e.addParam("n","i32"),e.addParam("pOut","i32"),e.addLocal("itOut","i32"),e.addLocal("itIn","i32");const i=e.getCodeBuilder();e.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}(),function(){const e=t.addFunction(a+"_LEMtoU");e.addParam("pIn","i32"),e.addParam("pOut","i32");const i=e.getCodeBuilder(),o=t.alloc(2*n),c=i.i32_const(o),r=i.i32_const(o),l=i.i32_const(o+n);e.addCode(i.if(i.call(a+"_isZeroAffine",i.getLocal("pIn")),[...i.call(a+"_zeroAffine",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(a+"_fromMontgomeryAffine",i.getLocal("pIn"),c),i.call(a+"__reverseBytes",r,i.i32_const(n),i.getLocal("pOut")),i.call(a+"__reverseBytes",l,i.i32_const(n),i.i32_add(i.getLocal("pOut"),i.i32_const(n))))}(),function(){const i=t.addFunction(a+"_LEMtoC");i.addParam("pIn","i32"),i.addParam("pOut","i32");const o=i.getCodeBuilder(),c=o.i32_const(t.alloc(n));i.addCode(o.if(o.call(a+"_isZero",o.getLocal("pIn")),[...o.call(e+"_zero",o.getLocal("pOut")),...o.i32_store8(o.getLocal("pOut"),o.i32_const(64)),...o.ret([])]),o.call(e+"_fromMontgomery",o.getLocal("pIn"),c),o.call(a+"__reverseBytes",c,o.i32_const(n),o.getLocal("pOut")),o.if(o.i32_eq(o.call(e+"_sign",o.i32_add(o.getLocal("pIn"),o.i32_const(n))),o.i32_const(-1)),o.i32_store8(o.getLocal("pOut"),o.i32_or(o.i32_load8_u(o.getLocal("pOut")),o.i32_const(128)))))}(),function(){const e=t.addFunction(a+"_UtoLEM");e.addParam("pIn","i32"),e.addParam("pOut","i32");const i=e.getCodeBuilder(),o=t.alloc(2*n),c=i.i32_const(o),r=i.i32_const(o),l=i.i32_const(o+n);e.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(a+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(a+"__reverseBytes",i.getLocal("pIn"),i.i32_const(n),r),i.call(a+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(n)),i.i32_const(n),l),i.call(a+"_toMontgomeryAffine",c,i.getLocal("pOut")))}(),function(){const o=t.addFunction(a+"_CtoLEM");o.addParam("pIn","i32"),o.addParam("pOut","i32"),o.addLocal("firstByte","i32"),o.addLocal("greatest","i32");const c=o.getCodeBuilder(),r=t.alloc(2*n),l=c.i32_const(r),s=c.i32_const(r+n);o.addCode(c.setLocal("firstByte",c.i32_load8_u(c.getLocal("pIn"))),c.if(c.i32_and(c.getLocal("firstByte"),c.i32_const(64)),[...c.call(a+"_zeroAffine",c.getLocal("pOut")),...c.ret([])]),c.setLocal("greatest",c.i32_and(c.getLocal("firstByte"),c.i32_const(128))),c.call(e+"_copy",c.getLocal("pIn"),s),c.i32_store8(s,c.i32_and(c.getLocal("firstByte"),c.i32_const(63))),c.call(a+"__reverseBytes",s,c.i32_const(n),l),c.call(e+"_toMontgomery",l,c.getLocal("pOut")),c.call(e+"_square",c.getLocal("pOut"),s),c.call(e+"_mul",c.getLocal("pOut"),s,s),c.call(e+"_add",s,c.i32_const(i),s),c.call(e+"_sqrt",s,s),c.call(e+"_neg",s,l),c.if(c.i32_eq(c.call(e+"_sign",s),c.i32_const(-1)),c.if(c.getLocal("greatest"),c.call(e+"_copy",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n))),c.call(e+"_neg",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n)))),c.if(c.getLocal("greatest"),c.call(e+"_neg",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n))),c.call(e+"_copy",s,c.i32_add(c.getLocal("pOut"),c.i32_const(n))))))}(),Qt(t,a+"_batchLEMtoU",a+"_LEMtoU",2*n,2*n),Qt(t,a+"_batchLEMtoC",a+"_LEMtoC",2*n,n),Qt(t,a+"_batchUtoLEM",a+"_UtoLEM",2*n,2*n),Qt(t,a+"_batchCtoLEM",a+"_CtoLEM",n,2*n,!0),Qt(t,a+"_batchToJacobian",a+"_toJacobian",2*n,3*n,!0),qt(t,a,a+"_multiexp",a+"_add",3*n),qt(t,a,a+"_multiexpAffine",a+"_addMixed",2*n),zt(t,a+"_timesScalar",3*n,a+"_add",a+"_double",a+"_sub",a+"_copy",a+"_zero"),zt(t,a+"_timesScalarAffine",2*n,a+"_addMixed",a+"_double",a+"_subMixed",a+"_copyAffine",a+"_zero"),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isZeroAffine"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_eqMixed"),t.exportFunction(a+"_eqAffine"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_copyAffine"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_zeroAffine"),t.exportFunction(a+"_double"),t.exportFunction(a+"_doubleAffine"),t.exportFunction(a+"_add"),t.exportFunction(a+"_addMixed"),t.exportFunction(a+"_addAffine"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_negAffine"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_subMixed"),t.exportFunction(a+"_subAffine"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_fromMontgomeryAffine"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_toMontgomeryAffine"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_timesScalarAffine"),t.exportFunction(a+"_normalize"),t.exportFunction(a+"_LEMtoU"),t.exportFunction(a+"_LEMtoC"),t.exportFunction(a+"_UtoLEM"),t.exportFunction(a+"_CtoLEM"),t.exportFunction(a+"_batchLEMtoU"),t.exportFunction(a+"_batchLEMtoC"),t.exportFunction(a+"_batchUtoLEM"),t.exportFunction(a+"_batchCtoLEM"),t.exportFunction(a+"_toAffine"),t.exportFunction(a+"_toJacobian"),t.exportFunction(a+"_batchToAffine"),t.exportFunction(a+"_batchToJacobian"),t.exportFunction(a+"_inCurve"),t.exportFunction(a+"_inCurveAffine"),a};const{isOdd:Tt,modInv:kt,modPow:Rt}=J,Dt=H;var Nt=function(t,a,e,i,o){const n=8*t.modules[i].n64,c=8*t.modules[e].n64,r=t.modules[i].q;let l=r-1n,s=0;for(;!Tt(l);)s++,l>>=1n;let d=2n;for(;1n===Rt(d,r>>1n,r);)d+=1n;const u=new Array(s+1);u[s]=Rt(d,l,r);let g=s-1;for(;g>=0;)u[g]=Rt(u[g+1],2n,r),g--;const _=[],f=(1n<<BigInt(8*n))%r;for(let t=0;t<u.length;t++){const a=u[t]*f%r;_.push(...Dt.bigInt2BytesLE(a,n))}const p=t.alloc(_),h=new Array(s+1);h[0]=1n;for(let t=1;t<=s;t++)h[t]=2n*h[t-1];const m=[];for(let t=0;t<=s;t++){const a=kt(h[t],r)*f%r;m.push(...Dt.bigInt2BytesLE(a,n))}const L=t.alloc(m),w=Rt(d,2n,r),A=[],b=[];for(let t=0;t<=s;t++){const a=Rt(w,2n**BigInt(t),r),e=kt(r+1n-a,r);A.push(...Dt.bigInt2BytesLE(a*f%r,n)),b.push(...Dt.bigInt2BytesLE(e*f%r,n))}const y=t.alloc(A),I=t.alloc(b);function C(t){let a=0;for(let e=0;e<8;e++)t&1<<e&&(a|=128>>e);return a}const x=Array(256);for(let t=0;t<256;t++)x[t]=C(t);const F=t.alloc(x);function E(){const e=t.addFunction(a+"_fft");e.addParam("px","i32"),e.addParam("n","i32"),e.addLocal("bits","i32");const o=e.getCodeBuilder(),c=o.i32_const(t.alloc(n));e.addCode(o.setLocal("bits",o.call(a+"__log2",o.getLocal("n"))),o.call(i+"_one",c),o.call(a+"_rawfft",o.getLocal("px"),o.getLocal("bits"),o.i32_const(0),c))}!function(){const e=t.addFunction(a+"__rev");e.addParam("x","i32"),e.addParam("bits","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.i32_rotl(i.i32_add(i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.getLocal("x"),i.i32_const(255)),F,0),i.i32_const(24)),i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(8)),i.i32_const(255)),F,0),i.i32_const(16))),i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(16)),i.i32_const(255)),F,0),i.i32_const(8)),i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(24)),i.i32_const(255)),F,0))),i.getLocal("bits")))}(),function(){const i=t.addFunction(a+"__reversePermutation");i.addParam("px","i32"),i.addParam("bits","i32"),i.addLocal("n","i32"),i.addLocal("i","i32"),i.addLocal("ri","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c));i.addCode(o.setLocal("n",o.i32_shl(o.i32_const(1),o.getLocal("bits"))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("i"),o.i32_const(c)))),o.setLocal("ri",o.call(a+"__rev",o.getLocal("i"),o.getLocal("bits"))),o.setLocal("idx2",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("ri"),o.i32_const(c)))),o.if(o.i32_lt_u(o.getLocal("i"),o.getLocal("ri")),[...o.call(e+"_copy",o.getLocal("idx1"),n),...o.call(e+"_copy",o.getLocal("idx2"),o.getLocal("idx1")),...o.call(e+"_copy",n,o.getLocal("idx2"))]),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){const n=t.addFunction(a+"__fftFinal");n.addParam("px","i32"),n.addParam("bits","i32"),n.addParam("reverse","i32"),n.addParam("mulFactor","i32"),n.addLocal("n","i32"),n.addLocal("ndiv2","i32"),n.addLocal("pInv2","i32"),n.addLocal("i","i32"),n.addLocal("mask","i32"),n.addLocal("idx1","i32"),n.addLocal("idx2","i32");const r=n.getCodeBuilder(),l=r.i32_const(t.alloc(c));n.addCode(r.if(r.i32_and(r.i32_eqz(r.getLocal("reverse")),r.call(i+"_isOne",r.getLocal("mulFactor"))),r.ret([])),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("mask",r.i32_sub(r.getLocal("n"),r.i32_const(1))),r.setLocal("i",r.i32_const(1)),r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(c)))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.getLocal("i")),r.i32_const(c)))),r.if(r.getLocal("reverse"),r.if(r.call(i+"_isOne",r.getLocal("mulFactor")),[...r.call(e+"_copy",r.getLocal("idx1"),l),...r.call(e+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(e+"_copy",l,r.getLocal("idx2"))],[...r.call(e+"_copy",r.getLocal("idx1"),l),...r.call(o,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(o,l,r.getLocal("mulFactor"),r.getLocal("idx2"))]),r.if(r.call(i+"_isOne",r.getLocal("mulFactor")),[],[...r.call(o,r.getLocal("idx1"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(o,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))])),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.call(i+"_isOne",r.getLocal("mulFactor")),[],[...r.call(o,r.getLocal("px"),r.getLocal("mulFactor"),r.getLocal("px")),...r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(c)))),...r.call(o,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))]))}(),function(){const r=t.addFunction(a+"_rawfft");r.addParam("px","i32"),r.addParam("bits","i32"),r.addParam("reverse","i32"),r.addParam("mulFactor","i32"),r.addLocal("s","i32"),r.addLocal("k","i32"),r.addLocal("j","i32"),r.addLocal("m","i32"),r.addLocal("mdiv2","i32"),r.addLocal("n","i32"),r.addLocal("pwm","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c)),u=l.i32_const(t.alloc(c));r.addCode(l.call(a+"__reversePermutation",l.getLocal("px"),l.getLocal("bits")),l.setLocal("n",l.i32_shl(l.i32_const(1),l.getLocal("bits"))),l.setLocal("s",l.i32_const(1)),l.block(l.loop(l.br_if(1,l.i32_gt_u(l.getLocal("s"),l.getLocal("bits"))),l.setLocal("m",l.i32_shl(l.i32_const(1),l.getLocal("s"))),l.setLocal("pwm",l.i32_add(l.i32_const(p),l.i32_mul(l.getLocal("s"),l.i32_const(n)))),l.setLocal("k",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_ge_u(l.getLocal("k"),l.getLocal("n"))),l.call(i+"_one",s),l.setLocal("mdiv2",l.i32_shr_u(l.getLocal("m"),l.i32_const(1))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_ge_u(l.getLocal("j"),l.getLocal("mdiv2"))),l.setLocal("idx1",l.i32_add(l.getLocal("px"),l.i32_mul(l.i32_add(l.getLocal("k"),l.getLocal("j")),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("idx1"),l.i32_mul(l.getLocal("mdiv2"),l.i32_const(c)))),l.call(o,l.getLocal("idx2"),s,d),l.call(e+"_copy",l.getLocal("idx1"),u),l.call(e+"_add",u,d,l.getLocal("idx1")),l.call(e+"_sub",u,d,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("pwm"),s),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("k",l.i32_add(l.getLocal("k"),l.getLocal("m"))),l.br(0))),l.setLocal("s",l.i32_add(l.getLocal("s"),l.i32_const(1))),l.br(0))),l.call(a+"__fftFinal",l.getLocal("px"),l.getLocal("bits"),l.getLocal("reverse"),l.getLocal("mulFactor")))}(),function(){const e=t.addFunction(a+"__log2");e.addParam("n","i32"),e.setReturnType("i32"),e.addLocal("bits","i32"),e.addLocal("aux","i32");const i=e.getCodeBuilder();e.addCode(i.setLocal("aux",i.i32_shr_u(i.getLocal("n"),i.i32_const(1)))),e.addCode(i.setLocal("bits",i.i32_const(0))),e.addCode(i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("aux"))),i.setLocal("aux",i.i32_shr_u(i.getLocal("aux"),i.i32_const(1))),i.setLocal("bits",i.i32_add(i.getLocal("bits"),i.i32_const(1))),i.br(0)))),e.addCode(i.if(i.i32_ne(i.getLocal("n"),i.i32_shl(i.i32_const(1),i.getLocal("bits"))),i.unreachable())),e.addCode(i.if(i.i32_gt_u(i.getLocal("bits"),i.i32_const(s)),i.unreachable())),e.addCode(i.getLocal("bits"))}(),E(),function(){const e=t.addFunction(a+"_ifft");e.addParam("px","i32"),e.addParam("n","i32"),e.addLocal("bits","i32"),e.addLocal("pInv2","i32");const i=e.getCodeBuilder();e.addCode(i.setLocal("bits",i.call(a+"__log2",i.getLocal("n"))),i.setLocal("pInv2",i.i32_add(i.i32_const(L),i.i32_mul(i.getLocal("bits"),i.i32_const(n)))),i.call(a+"_rawfft",i.getLocal("px"),i.getLocal("bits"),i.i32_const(1),i.getLocal("pInv2")))}(),function(){const r=t.addFunction(a+"_fftJoin");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c)),u=l.i32_const(t.alloc(c));r.addCode(l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(o,l.getLocal("idx2"),s,d),l.call(e+"_copy",l.getLocal("idx1"),u),l.call(e+"_add",u,d,l.getLocal("idx1")),l.call(e+"_sub",u,d,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const r=t.addFunction(a+"_fftJoinExt");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addParam("totalBits","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("pShiftToM","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c));r.addCode(l.setLocal("pShiftToM",l.i32_add(l.i32_const(y),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(e+"_add",l.getLocal("idx1"),l.getLocal("idx2"),d),l.call(o,l.getLocal("idx2"),l.getLocal("pShiftToM"),l.getLocal("idx2")),l.call(e+"_add",l.getLocal("idx1"),l.getLocal("idx2"),l.getLocal("idx2")),l.call(o,l.getLocal("idx2"),s,l.getLocal("idx2")),l.call(e+"_copy",d,l.getLocal("idx1")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const r=t.addFunction(a+"_fftJoinExtInv");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addParam("totalBits","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("pShiftToM","i32"),r.addLocal("pSConst","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c));r.addCode(l.setLocal("pShiftToM",l.i32_add(l.i32_const(y),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.setLocal("pSConst",l.i32_add(l.i32_const(I),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(o,l.getLocal("idx2"),s,d),l.call(e+"_sub",l.getLocal("idx1"),d,l.getLocal("idx2")),l.call(o,l.getLocal("idx2"),l.getLocal("pSConst"),l.getLocal("idx2")),l.call(o,l.getLocal("idx1"),l.getLocal("pShiftToM"),l.getLocal("idx1")),l.call(e+"_sub",d,l.getLocal("idx1"),l.getLocal("idx1")),l.call(o,l.getLocal("idx1"),l.getLocal("pSConst"),l.getLocal("idx1")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const r=t.addFunction(a+"_fftMix");r.addParam("pBuff","i32"),r.addParam("n","i32"),r.addParam("exp","i32"),r.addLocal("nGroups","i32"),r.addLocal("nPerGroup","i32"),r.addLocal("nPerGroupDiv2","i32"),r.addLocal("pairOffset","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("j","i32"),r.addLocal("pwm","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c)),u=l.i32_const(t.alloc(c));r.addCode(l.setLocal("nPerGroup",l.i32_shl(l.i32_const(1),l.getLocal("exp"))),l.setLocal("nPerGroupDiv2",l.i32_shr_u(l.getLocal("nPerGroup"),l.i32_const(1))),l.setLocal("nGroups",l.i32_shr_u(l.getLocal("n"),l.getLocal("exp"))),l.setLocal("pairOffset",l.i32_mul(l.getLocal("nPerGroupDiv2"),l.i32_const(c))),l.setLocal("pwm",l.i32_add(l.i32_const(p),l.i32_mul(l.getLocal("exp"),l.i32_const(n)))),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nGroups"))),l.call(i+"_one",s),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("nPerGroupDiv2"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff"),l.i32_mul(l.i32_add(l.i32_mul(l.getLocal("i"),l.getLocal("nPerGroup")),l.getLocal("j")),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("idx1"),l.getLocal("pairOffset"))),l.call(o,l.getLocal("idx2"),s,d),l.call(e+"_copy",l.getLocal("idx1"),u),l.call(e+"_add",u,d,l.getLocal("idx1")),l.call(e+"_sub",u,d,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("pwm"),s),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){const i=t.addFunction(a+"_fftFinal");i.addParam("pBuff","i32"),i.addParam("n","i32"),i.addParam("factor","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("ndiv2","i32");const n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c));i.addCode(n.setLocal("ndiv2",n.i32_shr_u(n.getLocal("n"),n.i32_const(1))),n.if(n.i32_and(n.getLocal("n"),n.i32_const(1)),n.call(o,n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(c))),n.getLocal("factor"),n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("ndiv2"),n.i32_const(c))))),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_ge_u(n.getLocal("i"),n.getLocal("ndiv2"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.getLocal("i"),n.i32_const(c)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.i32_sub(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.getLocal("i")),n.i32_const(c)))),n.call(o,n.getLocal("idx2"),n.getLocal("factor"),r),n.call(o,n.getLocal("idx1"),n.getLocal("factor"),n.getLocal("idx2")),n.call(e+"_copy",r,n.getLocal("idx1")),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){const r=t.addFunction(a+"_prepareLagrangeEvaluation");r.addParam("pBuff1","i32"),r.addParam("pBuff2","i32"),r.addParam("n","i32"),r.addParam("first","i32"),r.addParam("inc","i32"),r.addParam("totalBits","i32"),r.addLocal("idx1","i32"),r.addLocal("idx2","i32"),r.addLocal("i","i32"),r.addLocal("pShiftToM","i32"),r.addLocal("pSConst","i32");const l=r.getCodeBuilder(),s=l.i32_const(t.alloc(n)),d=l.i32_const(t.alloc(c));r.addCode(l.setLocal("pShiftToM",l.i32_add(l.i32_const(y),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.setLocal("pSConst",l.i32_add(l.i32_const(I),l.i32_mul(l.getLocal("totalBits"),l.i32_const(n)))),l.call(i+"_copy",l.getLocal("first"),s),l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.setLocal("idx1",l.i32_add(l.getLocal("pBuff1"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.setLocal("idx2",l.i32_add(l.getLocal("pBuff2"),l.i32_mul(l.getLocal("i"),l.i32_const(c)))),l.call(o,l.getLocal("idx1"),l.getLocal("pShiftToM"),d),l.call(e+"_sub",l.getLocal("idx2"),d,d),l.call(e+"_sub",l.getLocal("idx1"),l.getLocal("idx2"),l.getLocal("idx2")),l.call(o,d,l.getLocal("pSConst"),l.getLocal("idx1")),l.call(o,l.getLocal("idx2"),s,l.getLocal("idx2")),l.call(i+"_mul",s,l.getLocal("inc"),s),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),t.exportFunction(a+"_fft"),t.exportFunction(a+"_ifft"),t.exportFunction(a+"_rawfft"),t.exportFunction(a+"_fftJoin"),t.exportFunction(a+"_fftJoinExt"),t.exportFunction(a+"_fftJoinExtInv"),t.exportFunction(a+"_fftMix"),t.exportFunction(a+"_fftFinal"),t.exportFunction(a+"_prepareLagrangeEvaluation")},Kt=function(t,a,e){const i=8*t.modules[e].n64;return function(){const o=t.addFunction(a+"_zero");o.addParam("px","i32"),o.addParam("n","i32"),o.addLocal("lastp","i32"),o.addLocal("p","i32");const n=o.getCodeBuilder();o.addCode(n.setLocal("p",n.getLocal("px")),n.setLocal("lastp",n.i32_add(n.getLocal("px"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("p"),n.getLocal("lastp"))),n.call(e+"_zero",n.getLocal("p")),n.setLocal("p",n.i32_add(n.getLocal("p"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(a+"_constructLC");o.addParam("ppolynomials","i32"),o.addParam("psignals","i32"),o.addParam("nSignals","i32"),o.addParam("pres","i32"),o.addLocal("i","i32"),o.addLocal("j","i32"),o.addLocal("pp","i32"),o.addLocal("ps","i32"),o.addLocal("pd","i32"),o.addLocal("ncoefs","i32");const n=o.getCodeBuilder(),c=n.i32_const(t.alloc(i));o.addCode(n.setLocal("i",n.i32_const(0)),n.setLocal("pp",n.getLocal("ppolynomials")),n.setLocal("ps",n.getLocal("psignals")),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("nSignals"))),n.setLocal("ncoefs",n.i32_load(n.getLocal("pp"))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("ncoefs"))),n.setLocal("pd",n.i32_add(n.getLocal("pres"),n.i32_mul(n.i32_load(n.getLocal("pp")),n.i32_const(i)))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.call(e+"_mul",n.getLocal("ps"),n.getLocal("pp"),c),n.call(e+"_add",c,n.getLocal("pd"),n.getLocal("pd")),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(i))),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("ps",n.i32_add(n.getLocal("ps"),n.i32_const(i))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),t.exportFunction(a+"_zero"),t.exportFunction(a+"_constructLC"),a},Vt=function(t,a,e){const i=8*t.modules[e].n64;return function(){const o=t.addFunction(a+"_buildABC");o.addParam("pCoefs","i32"),o.addParam("nCoefs","i32"),o.addParam("pWitness","i32"),o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("offsetOut","i32"),o.addParam("nOut","i32"),o.addParam("offsetWitness","i32"),o.addParam("nWitness","i32"),o.addLocal("it","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("last","i32"),o.addLocal("m","i32"),o.addLocal("c","i32"),o.addLocal("s","i32"),o.addLocal("pOut","i32");const n=o.getCodeBuilder(),c=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(e+"_zero",n.getLocal("ita")),n.call(e+"_zero",n.getLocal("itb")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.br(0))),n.setLocal("it",n.getLocal("pCoefs")),n.setLocal("last",n.i32_add(n.getLocal("pCoefs"),n.i32_mul(n.getLocal("nCoefs"),n.i32_const(i+12)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("it"),n.getLocal("last"))),n.setLocal("s",n.i32_load(n.getLocal("it"),8)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_ge_u(n.getLocal("s"),n.i32_add(n.getLocal("offsetWitness"),n.getLocal("nWitness")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("m",n.i32_load(n.getLocal("it"))),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(0)),n.setLocal("pOut",n.getLocal("pA")),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(1)),n.setLocal("pOut",n.getLocal("pB")),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)])),n.setLocal("c",n.i32_load(n.getLocal("it"),4)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_ge_u(n.getLocal("c"),n.i32_add(n.getLocal("offsetOut"),n.getLocal("nOut")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("pOut",n.i32_add(n.getLocal("pOut"),n.i32_mul(n.i32_sub(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_const(i)))),n.call(e+"_mul",n.i32_add(n.getLocal("pWitness"),n.i32_mul(n.i32_sub(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_const(i))),n.i32_add(n.getLocal("it"),n.i32_const(12)),c),n.call(e+"_add",n.getLocal("pOut"),c,n.getLocal("pOut")),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),n.br(0))),n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("it",n.getLocal("pC")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(e+"_mul",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("it")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(a+"_joinABC");o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("n","i32"),o.addParam("pP","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itc","i32"),o.addLocal("itp","i32"),o.addLocal("last","i32");const n=o.getCodeBuilder(),c=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("itc",n.getLocal("pC")),n.setLocal("itp",n.getLocal("pP")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(e+"_mul",n.getLocal("ita"),n.getLocal("itb"),c),n.call(e+"_sub",c,n.getLocal("itc"),n.getLocal("itp")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itc",n.i32_add(n.getLocal("itc"),n.i32_const(i))),n.setLocal("itp",n.i32_add(n.getLocal("itp"),n.i32_const(i))),n.br(0))))}(),function(){const o=t.addFunction(a+"_batchAdd");o.addParam("pa","i32"),o.addParam("pb","i32"),o.addParam("n","i32"),o.addParam("pr","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itr","i32"),o.addLocal("last","i32");const n=o.getCodeBuilder();o.addCode(n.setLocal("ita",n.getLocal("pa")),n.setLocal("itb",n.getLocal("pb")),n.setLocal("itr",n.getLocal("pr")),n.setLocal("last",n.i32_add(n.getLocal("pa"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(e+"_add",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("itr")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itr",n.i32_add(n.getLocal("itr"),n.i32_const(i))),n.br(0))))}(),t.exportFunction(a+"_buildABC"),t.exportFunction(a+"_joinABC"),t.exportFunction(a+"_batchAdd"),a},jt=function(t,a,e,i,o,n,c,r){const l=t.addFunction(a);l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pFirst","i32"),l.addParam("pInc","i32"),l.addParam("pOut","i32"),l.addLocal("pOldFree","i32"),l.addLocal("i","i32"),l.addLocal("pFrom","i32"),l.addLocal("pTo","i32");const s=l.getCodeBuilder(),d=s.i32_const(t.alloc(c));l.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),l.addCode(s.call(i+"_copy",s.getLocal("pFirst"),d)),l.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(r,s.getLocal("pFrom"),d,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(o))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(n))),s.call(i+"_mul",d,s.getLocal("pInc"),d),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(a)};const Ht=H,$t=Ct,Yt=Et,Wt=Gt,Zt=Ot,Jt=Mt,Xt=Nt,ta=Kt,aa=Vt,ea=jt,{bitLength:ia,modInv:oa,isOdd:na,isNegative:ca}=J;const ra=H,la=Ct,sa=Et,da=Gt,ua=Ot,ga=Mt,_a=Nt,fa=Kt,pa=Vt,ha=jt,{bitLength:ma,isOdd:La,isNegative:wa}=J;var Aa=function(t,a){const e=a||"bn128";if(t.modules[e])return e;const i=21888242871839275222246405745257275088696311157297823662689037894645226208583n,o=21888242871839275222246405745257275088548364400416034343698204186575808495617n,n=Math.floor((ia(i-1n)-1)/64)+1,c=8*n,r=c,l=c,s=2*l,d=12*l,u=t.alloc(Ht.bigInt2BytesLE(o,r)),g=$t(t,i,"f1m");Yt(t,o,"fr","frm");const _=t.alloc(Ht.bigInt2BytesLE(w(3n),l)),f=Jt(t,"g1m","f1m",_);Xt(t,"frm","frm","frm","frm_mul"),ta(t,"pol","frm"),aa(t,"qap","frm");const p=Wt(t,"f1m_neg","f2m","f1m"),h=t.alloc([...Ht.bigInt2BytesLE(w(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...Ht.bigInt2BytesLE(w(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]),m=Jt(t,"g2m","f2m",h);function L(a,e){const i=t.addFunction(a);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(e,o.getLocal("pG"),n,o.i32_const(c),o.getLocal("pr"))),t.exportFunction(a)}function w(t){return BigInt(t)*(1n<<BigInt(8*l))%i}L("g1m_timesFr","g1m_timesScalar"),Xt(t,"g1m","g1m","frm","g1m_timesFr"),L("g2m_timesFr","g2m_timesScalar"),Xt(t,"g2m","g2m","frm","g2m_timesFr"),L("g1m_timesFrAffine","g1m_timesScalarAffine"),L("g2m_timesFrAffine","g2m_timesScalarAffine"),ea(t,"frm_batchApplyKey","fmr","frm",c,c,c,"frm_mul"),ea(t,"g1m_batchApplyKey","g1m","frm",3*c,3*c,c,"g1m_timesFr"),ea(t,"g1m_batchApplyKeyMixed","g1m","frm",2*c,3*c,c,"g1m_timesFrAffine"),ea(t,"g2m_batchApplyKey","g2m","frm",2*c*3,3*c*2,c,"g2m_timesFr"),ea(t,"g2m_batchApplyKeyMixed","g2m","frm",2*c*2,3*c*2,c,"g2m_timesFrAffine");const A=[1n,2n,1n],b=t.alloc([...Ht.bigInt2BytesLE(w(A[0]),l),...Ht.bigInt2BytesLE(w(A[1]),l),...Ht.bigInt2BytesLE(w(A[2]),l)]),y=[0n,1n,0n],I=t.alloc([...Ht.bigInt2BytesLE(w(y[0]),l),...Ht.bigInt2BytesLE(w(y[1]),l),...Ht.bigInt2BytesLE(w(y[2]),l)]),C=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],x=t.alloc([...Ht.bigInt2BytesLE(w(C[0][0]),l),...Ht.bigInt2BytesLE(w(C[0][1]),l),...Ht.bigInt2BytesLE(w(C[1][0]),l),...Ht.bigInt2BytesLE(w(C[1][1]),l),...Ht.bigInt2BytesLE(w(C[2][0]),l),...Ht.bigInt2BytesLE(w(C[2][1]),l)]),F=[[0n,0n],[1n,0n],[0n,0n]],E=t.alloc([...Ht.bigInt2BytesLE(w(F[0][0]),l),...Ht.bigInt2BytesLE(w(F[0][1]),l),...Ht.bigInt2BytesLE(w(F[1][0]),l),...Ht.bigInt2BytesLE(w(F[1][1]),l),...Ht.bigInt2BytesLE(w(F[2][0]),l),...Ht.bigInt2BytesLE(w(F[2][1]),l)]),B=t.alloc([...Ht.bigInt2BytesLE(w(1),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l),...Ht.bigInt2BytesLE(w(0),l)]),v=t.alloc([...Ht.bigInt2BytesLE(w(9),l),...Ht.bigInt2BytesLE(w(1),l)]),S=t.alloc([...Ht.bigInt2BytesLE(w(oa(2n,i)),l),...Ht.bigInt2BytesLE(0n,l)]),G=v,P=t.alloc([...Ht.bigInt2BytesLE(w(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...Ht.bigInt2BytesLE(w(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]);!function(){const a=t.addFunction(e+"_mulNR6");a.addParam("x","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder();a.addCode(i.call(p+"_mul",i.i32_const(v),i.getLocal("x"),i.getLocal("pr")))}();const U=Zt(t,e+"_mulNR6","f6m","f2m");!function(){const a=t.addFunction(e+"_mulNR12");a.addParam("x","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder();a.addCode(i.call(p+"_mul",i.i32_const(v),i.i32_add(i.getLocal("x"),i.i32_const(4*c)),i.getLocal("pr")),i.call(p+"_copy",i.getLocal("x"),i.i32_add(i.getLocal("pr"),i.i32_const(2*c))),i.call(p+"_copy",i.i32_add(i.getLocal("x"),i.i32_const(2*c)),i.i32_add(i.getLocal("pr"),i.i32_const(4*c))))}();const O=Wt(t,e+"_mulNR12","ftm",U),z=function(t){let a=t;const e=[];for(;a>0n;)na(a)?e.push(1):e.push(0),a>>=1n;return e}(29793968203157093288n),Q=t.alloc(z),q=3*s,M=z.length-1,T=z.reduce(((t,a)=>t+(0!=a?1:0)),0),k=6*c,R=3*c*2+(T+M+1)*q;t.modules[e]={n64:n,pG1gen:b,pG1zero:I,pG1b:_,pG2gen:x,pG2zero:E,pG2b:h,pq:t.modules.f1m.pq,pr:u,pOneT:B,prePSize:k,preQSize:R,r:o.toString(),q:i.toString()};const D=4965661367192848881n;function N(a){const o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],n=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],c=t.addFunction(e+"__frobeniusMap"+a);c.addParam("x","i32"),c.addParam("r","i32");const r=c.getCodeBuilder();for(let e=0;e<6;e++){const i=0==e?r.getLocal("x"):r.i32_add(r.getLocal("x"),r.i32_const(e*s)),u=i,_=r.i32_add(r.getLocal("x"),r.i32_const(e*s+l)),f=0==e?r.getLocal("r"):r.i32_add(r.getLocal("r"),r.i32_const(e*s)),h=f,m=r.i32_add(r.getLocal("r"),r.i32_const(e*s+l)),L=d(o[Math.floor(e/3)][a%12],n[e%3][a%6]),A=t.alloc([...Ht.bigInt2BytesLE(w(L[0]),32),...Ht.bigInt2BytesLE(w(L[1]),32)]);a%2==1?c.addCode(r.call(g+"_copy",u,h),r.call(g+"_neg",_,m),r.call(p+"_mul",f,r.i32_const(A),f)):c.addCode(r.call(p+"_mul",i,r.i32_const(A),f))}function d(t,a){const e=BigInt(t[0]),o=BigInt(t[1]),n=BigInt(a[0]),c=BigInt(a[1]),r=[(e*n-o*c)%i,(e*c+o*n)%i];return ca(r[0])&&(r[0]=r[0]+i),r}}function K(a,i){const o=function(t){let a=t;const e=[];for(;a>0n;){if(na(a)){const t=2-Number(a%4n);e.push(t),a-=BigInt(t)}else e.push(0);a>>=1n}return e}(a).map((t=>-1==t?255:t)),n=t.alloc(o),c=t.addFunction(e+"__cyclotomicExp_"+i);c.addParam("x","i32"),c.addParam("r","i32"),c.addLocal("bit","i32"),c.addLocal("i","i32");const r=c.getCodeBuilder(),l=r.getLocal("x"),s=r.getLocal("r"),u=r.i32_const(t.alloc(d));c.addCode(r.call(O+"_conjugate",l,u),r.call(O+"_one",s),r.if(r.teeLocal("bit",r.i32_load8_s(r.i32_const(o.length-1),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(O+"_mul",s,l,s),r.call(O+"_mul",s,u,s))),r.setLocal("i",r.i32_const(o.length-2)),r.block(r.loop(r.call(e+"__cyclotomicSquare",s,s),r.if(r.teeLocal("bit",r.i32_load8_s(r.getLocal("i"),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(O+"_mul",s,l,s),r.call(O+"_mul",s,u,s))),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function V(){!function(){const a=t.addFunction(e+"__cyclotomicSquare");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(s)),c=i.i32_add(i.getLocal("x"),i.i32_const(2*s)),r=i.i32_add(i.getLocal("x"),i.i32_const(3*s)),l=i.i32_add(i.getLocal("x"),i.i32_const(4*s)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*s)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(s)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*s)),f=i.i32_add(i.getLocal("r"),i.i32_const(3*s)),h=i.i32_add(i.getLocal("r"),i.i32_const(4*s)),m=i.i32_add(i.getLocal("r"),i.i32_const(5*s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s)),C=i.i32_const(t.alloc(s)),x=i.i32_const(t.alloc(s));a.addCode(i.call(p+"_mul",o,l,C),i.call(p+"_mul",l,i.i32_const(v),L),i.call(p+"_add",o,L,L),i.call(p+"_add",o,l,x),i.call(p+"_mul",x,L,L),i.call(p+"_mul",i.i32_const(v),C,x),i.call(p+"_add",C,x,x),i.call(p+"_sub",L,x,L),i.call(p+"_add",C,C,w),i.call(p+"_mul",r,c,C),i.call(p+"_mul",c,i.i32_const(v),A),i.call(p+"_add",r,A,A),i.call(p+"_add",r,c,x),i.call(p+"_mul",x,A,A),i.call(p+"_mul",i.i32_const(v),C,x),i.call(p+"_add",C,x,x),i.call(p+"_sub",A,x,A),i.call(p+"_add",C,C,b),i.call(p+"_mul",n,d,C),i.call(p+"_mul",d,i.i32_const(v),y),i.call(p+"_add",n,y,y),i.call(p+"_add",n,d,x),i.call(p+"_mul",x,y,y),i.call(p+"_mul",i.i32_const(v),C,x),i.call(p+"_add",C,x,x),i.call(p+"_sub",y,x,y),i.call(p+"_add",C,C,I),i.call(p+"_sub",L,o,u),i.call(p+"_add",u,u,u),i.call(p+"_add",L,u,u),i.call(p+"_add",w,l,h),i.call(p+"_add",h,h,h),i.call(p+"_add",w,h,h),i.call(p+"_mul",I,i.i32_const(G),x),i.call(p+"_add",x,r,f),i.call(p+"_add",f,f,f),i.call(p+"_add",x,f,f),i.call(p+"_sub",y,c,_),i.call(p+"_add",_,_,_),i.call(p+"_add",y,_,_),i.call(p+"_sub",A,n,g),i.call(p+"_add",g,g,g),i.call(p+"_add",A,g,g),i.call(p+"_add",b,d,m),i.call(p+"_add",m,m,m),i.call(p+"_add",b,m,m))}(),K(D,"w0");const a=t.addFunction(e+"__finalExponentiationLastChunk");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),c=i.i32_const(t.alloc(d)),r=i.i32_const(t.alloc(d)),l=i.i32_const(t.alloc(d)),u=i.i32_const(t.alloc(d)),g=i.i32_const(t.alloc(d)),_=i.i32_const(t.alloc(d)),f=i.i32_const(t.alloc(d)),h=i.i32_const(t.alloc(d)),m=i.i32_const(t.alloc(d)),L=i.i32_const(t.alloc(d)),w=i.i32_const(t.alloc(d)),A=i.i32_const(t.alloc(d)),b=i.i32_const(t.alloc(d)),y=i.i32_const(t.alloc(d)),I=i.i32_const(t.alloc(d)),C=i.i32_const(t.alloc(d)),x=i.i32_const(t.alloc(d)),F=i.i32_const(t.alloc(d)),E=i.i32_const(t.alloc(d)),B=i.i32_const(t.alloc(d)),S=i.i32_const(t.alloc(d));a.addCode(i.call(e+"__cyclotomicExp_w0",o,c),i.call(O+"_conjugate",c,c),i.call(e+"__cyclotomicSquare",c,r),i.call(e+"__cyclotomicSquare",r,l),i.call(O+"_mul",l,r,u),i.call(e+"__cyclotomicExp_w0",u,g),i.call(O+"_conjugate",g,g),i.call(e+"__cyclotomicSquare",g,_),i.call(e+"__cyclotomicExp_w0",_,f),i.call(O+"_conjugate",f,f),i.call(O+"_conjugate",u,h),i.call(O+"_conjugate",f,m),i.call(O+"_mul",m,g,L),i.call(O+"_mul",L,h,w),i.call(O+"_mul",w,r,A),i.call(O+"_mul",w,g,b),i.call(O+"_mul",b,o,y),i.call(e+"__frobeniusMap1",A,I),i.call(O+"_mul",I,y,C),i.call(e+"__frobeniusMap2",w,x),i.call(O+"_mul",x,C,F),i.call(O+"_conjugate",o,E),i.call(O+"_mul",E,A,B),i.call(e+"__frobeniusMap3",B,S),i.call(O+"_mul",S,F,n))}const j=t.alloc(k),H=t.alloc(R);function $(a){const i=t.addFunction(e+"_pairingEq"+a);for(let t=0;t<a;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(d)),c=o.i32_const(t.alloc(d));i.addCode(o.call(O+"_one",n));for(let t=0;t<a;t++)i.addCode(o.call(e+"_prepareG1",o.getLocal("p_"+t),o.i32_const(j))),i.addCode(o.call(e+"_prepareG2",o.getLocal("q_"+t),o.i32_const(H))),i.addCode(o.call(e+"_millerLoop",o.i32_const(j),o.i32_const(H),c)),i.addCode(o.call(O+"_mul",n,c,n));i.addCode(o.call(e+"_finalExponentiation",n,n)),i.addCode(o.call(O+"_eq",n,o.getLocal("c")))}!function(){const a=t.addFunction(e+"_prepAddStep");a.addParam("pQ","i32"),a.addParam("pR","i32"),a.addParam("pCoef","i32");const i=a.getCodeBuilder(),o=i.getLocal("pQ"),n=i.i32_add(i.getLocal("pQ"),i.i32_const(s)),c=i.getLocal("pR"),r=i.i32_add(i.getLocal("pR"),i.i32_const(s)),l=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),d=i.getLocal("pCoef"),u=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),g=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),_=u,f=i.i32_const(t.alloc(s)),h=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s));a.addCode(i.call(p+"_mul",o,l,_),i.call(p+"_sub",c,_,_),i.call(p+"_mul",n,l,f),i.call(p+"_sub",r,f,f),i.call(p+"_square",_,h),i.call(p+"_square",f,m),i.call(p+"_mul",_,h,L),i.call(p+"_mul",c,h,w),i.call(p+"_add",w,w,b),i.call(p+"_mul",l,m,A),i.call(p+"_add",L,A,A),i.call(p+"_sub",A,b,A),i.call(p+"_mul",_,A,c),i.call(p+"_mul",L,r,r),i.call(p+"_sub",w,A,b),i.call(p+"_mul",f,b,b),i.call(p+"_sub",b,r,r),i.call(p+"_mul",l,L,l),i.call(p+"_mul",_,n,b),i.call(p+"_mul",f,o,d),i.call(p+"_sub",d,b,d),i.call(p+"_mul",d,i.i32_const(G),d),i.call(p+"_neg",f,g))}(),function(){const a=t.addFunction(e+"_prepDblStep");a.addParam("pR","i32"),a.addParam("pCoef","i32");const i=a.getCodeBuilder(),o=i.getLocal("pR"),n=i.i32_add(i.getLocal("pR"),i.i32_const(s)),c=i.i32_add(i.getLocal("pR"),i.i32_const(2*s)),r=i.getLocal("pCoef"),l=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),u=i.i32_const(t.alloc(s)),g=i.i32_const(t.alloc(s)),_=i.i32_const(t.alloc(s)),f=i.i32_const(t.alloc(s)),h=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s));a.addCode(i.call(p+"_mul",n,i.i32_const(S),u),i.call(p+"_mul",o,u,u),i.call(p+"_square",n,g),i.call(p+"_square",c,_),i.call(p+"_add",_,_,f),i.call(p+"_add",f,_,f),i.call(p+"_mul",i.i32_const(P),f,h),i.call(p+"_add",h,h,m),i.call(p+"_add",h,m,m),i.call(p+"_add",g,m,L),i.call(p+"_mul",L,i.i32_const(S),L),i.call(p+"_add",g,_,I),i.call(p+"_add",n,c,w),i.call(p+"_square",w,w),i.call(p+"_sub",w,I,w),i.call(p+"_sub",h,g,A),i.call(p+"_square",o,b),i.call(p+"_square",h,y),i.call(p+"_sub",g,m,I),i.call(p+"_mul",u,I,o),i.call(p+"_add",y,y,I),i.call(p+"_add",y,I,I),i.call(p+"_square",L,n),i.call(p+"_sub",n,I,n),i.call(p+"_mul",g,w,c),i.call(p+"_mul",i.i32_const(G),A,r),i.call(p+"_neg",w,l),i.call(p+"_add",b,b,d),i.call(p+"_add",b,d,d))}(),function(){const a=t.addFunction(e+"_prepareG1");a.addParam("pP","i32"),a.addParam("ppreP","i32");const i=a.getCodeBuilder();a.addCode(i.call(f+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){!function(){const a=t.addFunction(e+"_mulByQ");a.addParam("p1","i32"),a.addParam("pr","i32");const i=a.getCodeBuilder(),o=i.getLocal("p1"),n=i.i32_add(i.getLocal("p1"),i.i32_const(s)),c=i.i32_add(i.getLocal("p1"),i.i32_const(2*s)),r=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(s)),u=i.i32_add(i.getLocal("pr"),i.i32_const(2*s)),g=i.i32_const(t.alloc([...Ht.bigInt2BytesLE(w("21575463638280843010398324269430826099269044274347216827212613867836435027261"),l),...Ht.bigInt2BytesLE(w("10307601595873709700152284273816112264069230130616436755625194854815875713954"),l)])),_=i.i32_const(t.alloc([...Ht.bigInt2BytesLE(w("2821565182194536844548159561693502659359617185244120367078079554186484126554"),l),...Ht.bigInt2BytesLE(w("3505843767911556378687030309984248845540243509899259641013678093033130930403"),l)]));a.addCode(i.call(p+"_conjugate",o,r),i.call(p+"_mul",g,r,r),i.call(p+"_conjugate",n,d),i.call(p+"_mul",_,d,d),i.call(p+"_conjugate",c,u))}();const a=t.addFunction(e+"_prepareG2");a.addParam("pQ","i32"),a.addParam("ppreQ","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const i=a.getCodeBuilder(),o=i.getLocal("pQ"),n=t.alloc(3*s),c=i.i32_const(n),r=i.i32_const(n),d=i.i32_const(n+s),u=i.i32_const(n+2*s),g=i.i32_add(i.getLocal("ppreQ"),i.i32_const(0)),_=i.i32_add(i.getLocal("ppreQ"),i.i32_const(s)),f=t.alloc(3*s),h=i.i32_const(f),L=t.alloc(3*s),A=i.i32_const(L),b=i.i32_const(L+s);a.addCode(i.call(m+"_normalize",o,g),i.call(p+"_copy",g,r),i.call(p+"_copy",_,d),i.call(p+"_one",u)),a.addCode(i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*s))),i.setLocal("i",i.i32_const(z.length-2)),i.block(i.loop(i.call(e+"_prepDblStep",c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.if(i.i32_load8_s(i.getLocal("i"),Q),[...i.call(e+"_prepAddStep",g,c,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),a.addCode(i.call(e+"_mulByQ",g,h),i.call(e+"_mulByQ",h,A)),a.addCode(i.call(p+"_neg",b,b),i.call(e+"_prepAddStep",h,c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.call(e+"_prepAddStep",A,c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))))}(),function(){const a=t.addFunction(e+"__mulBy024");a.addParam("pEll0","i32"),a.addParam("pEllVW","i32"),a.addParam("pEllVV","i32"),a.addParam("pR","i32");const i=a.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),r=i.getLocal("pEllVW"),l=i.getLocal("pR"),d=i.i32_add(i.getLocal("pR"),i.i32_const(2*c)),u=i.i32_add(i.getLocal("pR"),i.i32_const(4*c)),g=i.i32_add(i.getLocal("pR"),i.i32_const(6*c)),_=i.i32_add(i.getLocal("pR"),i.i32_const(8*c)),f=i.i32_add(i.getLocal("pR"),i.i32_const(10*c)),h=i.i32_const(t.alloc(s)),m=i.i32_const(t.alloc(s)),L=i.i32_const(t.alloc(s)),w=i.i32_const(t.alloc(s)),A=i.i32_const(t.alloc(s)),b=i.i32_const(t.alloc(s)),y=i.i32_const(t.alloc(s)),I=i.i32_const(t.alloc(s)),C=i.i32_const(t.alloc(s)),x=i.i32_const(t.alloc(s)),F=i.i32_const(t.alloc(s));a.addCode(i.call(p+"_mul",l,o,y),i.call(p+"_mul",u,n,I),i.call(p+"_mul",_,r,C),i.call(p+"_add",l,_,L),i.call(p+"_add",l,u,m),i.call(p+"_add",d,g,w),i.call(p+"_add",w,f,w),i.call(p+"_mul",d,n,x),i.call(p+"_add",x,C,A),i.call(p+"_mul",i.i32_const(v),A,b),i.call(p+"_add",b,y,l),i.call(p+"_mul",f,r,A),i.call(p+"_add",x,A,x),i.call(p+"_add",A,I,A),i.call(p+"_mul",i.i32_const(v),A,b),i.call(p+"_mul",d,o,A),i.call(p+"_add",x,A,x),i.call(p+"_add",b,A,d),i.call(p+"_add",o,n,h),i.call(p+"_mul",m,h,A),i.call(p+"_add",y,I,F),i.call(p+"_sub",A,F,A),i.call(p+"_mul",g,r,b),i.call(p+"_add",x,b,x),i.call(p+"_add",u,_,h),i.call(p+"_add",A,b,u),i.call(p+"_add",n,r,m),i.call(p+"_mul",m,h,A),i.call(p+"_add",I,C,F),i.call(p+"_sub",A,F,A),i.call(p+"_mul",i.i32_const(v),A,b),i.call(p+"_mul",g,o,A),i.call(p+"_add",x,A,x),i.call(p+"_add",b,A,g),i.call(p+"_mul",f,n,A),i.call(p+"_add",x,A,x),i.call(p+"_mul",i.i32_const(v),A,b),i.call(p+"_add",o,r,h),i.call(p+"_mul",L,h,A),i.call(p+"_add",y,C,F),i.call(p+"_sub",A,F,A),i.call(p+"_add",b,A,_),i.call(p+"_add",o,n,h),i.call(p+"_add",h,r,h),i.call(p+"_mul",w,h,A),i.call(p+"_sub",A,x,f))}(),function(){const a=t.addFunction(e+"__mulBy024Old");a.addParam("pEll0","i32"),a.addParam("pEllVW","i32"),a.addParam("pEllVV","i32"),a.addParam("pR","i32");const i=a.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),c=i.getLocal("pEllVW"),r=i.getLocal("pR"),l=t.alloc(d),u=i.i32_const(l),g=i.i32_const(l),_=i.i32_const(l+s),f=i.i32_const(l+2*s),h=i.i32_const(l+3*s),m=i.i32_const(l+4*s),L=i.i32_const(l+5*s);a.addCode(i.call(p+"_copy",o,g),i.call(p+"_zero",_),i.call(p+"_copy",n,f),i.call(p+"_zero",h),i.call(p+"_copy",c,m),i.call(p+"_zero",L),i.call(O+"_mul",u,r,r))}(),function(){const a=t.addFunction(e+"_millerLoop");a.addParam("ppreP","i32"),a.addParam("ppreQ","i32"),a.addParam("r","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const i=a.getCodeBuilder(),o=i.getLocal("ppreP"),n=i.i32_add(i.getLocal("ppreP"),i.i32_const(l)),c=i.getLocal("pCoef"),r=i.i32_add(i.getLocal("pCoef"),i.i32_const(s)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*s)),u=t.alloc(s),g=i.i32_const(u),_=t.alloc(s),f=i.i32_const(_),h=i.getLocal("r");a.addCode(i.call(O+"_one",h),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*s))),i.setLocal("i",i.i32_const(z.length-2)),i.block(i.loop(i.call(O+"_square",h,h),i.call(p+"_mul1",r,n,g),i.call(p+"_mul1",d,o,f),i.call(e+"__mulBy024",c,g,f,h),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.if(i.i32_load8_s(i.getLocal("i"),Q),[...i.call(p+"_mul1",r,n,g),...i.call(p+"_mul1",d,o,f),...i.call(e+"__mulBy024",c,g,f,h),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),a.addCode(i.call(p+"_mul1",r,n,g),i.call(p+"_mul1",d,o,f),i.call(e+"__mulBy024",c,g,f,h),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))),i.call(p+"_mul1",r,n,g),i.call(p+"_mul1",d,o,f),i.call(e+"__mulBy024",c,g,f,h),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(q))))}();for(let a=0;a<10;a++)N(a),t.exportFunction(e+"__frobeniusMap"+a);!function(){const a=t.addFunction(e+"_finalExponentiationOld");a.addParam("x","i32"),a.addParam("r","i32");const i=t.alloc(Ht.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),o=a.getCodeBuilder();a.addCode(o.call(O+"_exp",o.getLocal("x"),o.i32_const(i),o.i32_const(352),o.getLocal("r")))}(),function(){!function(){const a=t.addFunction(e+"__finalExponentiationFirstChunk");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("x"),n=o,r=i.i32_add(o,i.i32_const(6*c)),l=i.getLocal("r"),s=t.alloc(d),u=i.i32_const(s),g=u,_=i.i32_const(s+6*c),f=i.i32_const(t.alloc(d)),p=i.i32_const(t.alloc(d)),h=i.i32_const(t.alloc(d));a.addCode(i.call(U+"_copy",n,g),i.call(U+"_neg",r,_),i.call(O+"_inverse",o,f),i.call(O+"_mul",u,f,p),i.call(e+"__frobeniusMap2",p,h),i.call(O+"_mul",p,h,l))}(),V();const a=t.addFunction(e+"_finalExponentiation");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),r=i.i32_const(t.alloc(d));a.addCode(i.call(e+"__finalExponentiationFirstChunk",o,r),i.call(e+"__finalExponentiationLastChunk",r,n))}();for(let a=1;a<=5;a++)$(a),t.exportFunction(e+"_pairingEq"+a);!function(){const a=t.addFunction(e+"_pairing");a.addParam("p","i32"),a.addParam("q","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(d));a.addCode(i.call(e+"_prepareG1",i.getLocal("p"),i.i32_const(j))),a.addCode(i.call(e+"_prepareG2",i.getLocal("q"),i.i32_const(H))),a.addCode(i.call(e+"_millerLoop",i.i32_const(j),i.i32_const(H),o)),a.addCode(i.call(e+"_finalExponentiation",o,i.getLocal("r")))}(),t.exportFunction(e+"_pairing"),t.exportFunction(e+"_prepareG1"),t.exportFunction(e+"_prepareG2"),t.exportFunction(e+"_millerLoop"),t.exportFunction(e+"_finalExponentiation"),t.exportFunction(e+"_finalExponentiationOld"),t.exportFunction(e+"__mulBy024"),t.exportFunction(e+"__mulBy024Old"),t.exportFunction(e+"__cyclotomicSquare"),t.exportFunction(e+"__cyclotomicExp_w0")},ba=function(t,a){const e=a||"bls12381";if(t.modules[e])return e;const i=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,o=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,n=Math.floor((ma(i-1n)-1)/64)+1,c=8*n,r=c,l=2*r,s=12*r,d=Math.floor((ma(o-1n)-1)/64)+1,u=8*d,g=u,_=t.alloc(ra.bigInt2BytesLE(o,g)),f=la(t,i,"f1m","intq");sa(t,o,"fr","frm","intr");const p=t.alloc(ra.bigInt2BytesLE(b(4n),r)),h=ga(t,"g1m","f1m",p);_a(t,"frm","frm","frm","frm_mul"),fa(t,"pol","frm"),pa(t,"qap","frm");const m=da(t,"f1m_neg","f2m","f1m"),L=t.alloc([...ra.bigInt2BytesLE(b(4n),r),...ra.bigInt2BytesLE(b(4n),r)]),w=ga(t,"g2m","f2m",L);function A(a,e){const i=t.addFunction(a);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(u));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(e,o.getLocal("pG"),n,o.i32_const(u),o.getLocal("pr"))),t.exportFunction(a)}function b(t){return BigInt(t)*(1n<<BigInt(8*r))%i}A("g1m_timesFr","g1m_timesScalar"),_a(t,"g1m","g1m","frm","g1m_timesFr"),A("g2m_timesFr","g2m_timesScalar"),_a(t,"g2m","g2m","frm","g2m_timesFr"),A("g1m_timesFrAffine","g1m_timesScalarAffine"),A("g2m_timesFrAffine","g2m_timesScalarAffine"),ha(t,"frm_batchApplyKey","fmr","frm",u,u,u,"frm_mul"),ha(t,"g1m_batchApplyKey","g1m","frm",3*c,3*c,u,"g1m_timesFr"),ha(t,"g1m_batchApplyKeyMixed","g1m","frm",2*c,3*c,u,"g1m_timesFrAffine"),ha(t,"g2m_batchApplyKey","g2m","frm",2*c*3,3*c*2,u,"g2m_timesFr"),ha(t,"g2m_batchApplyKeyMixed","g2m","frm",2*c*2,3*c*2,u,"g2m_timesFrAffine");const y=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],I=t.alloc([...ra.bigInt2BytesLE(b(y[0]),r),...ra.bigInt2BytesLE(b(y[1]),r),...ra.bigInt2BytesLE(b(y[2]),r)]),C=[0n,1n,0n],x=t.alloc([...ra.bigInt2BytesLE(b(C[0]),r),...ra.bigInt2BytesLE(b(C[1]),r),...ra.bigInt2BytesLE(b(C[2]),r)]),F=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],E=t.alloc([...ra.bigInt2BytesLE(b(F[0][0]),r),...ra.bigInt2BytesLE(b(F[0][1]),r),...ra.bigInt2BytesLE(b(F[1][0]),r),...ra.bigInt2BytesLE(b(F[1][1]),r),...ra.bigInt2BytesLE(b(F[2][0]),r),...ra.bigInt2BytesLE(b(F[2][1]),r)]),B=[[0n,0n],[1n,0n],[0n,0n]],v=t.alloc([...ra.bigInt2BytesLE(b(B[0][0]),r),...ra.bigInt2BytesLE(b(B[0][1]),r),...ra.bigInt2BytesLE(b(B[1][0]),r),...ra.bigInt2BytesLE(b(B[1][1]),r),...ra.bigInt2BytesLE(b(B[2][0]),r),...ra.bigInt2BytesLE(b(B[2][1]),r)]),S=t.alloc([...ra.bigInt2BytesLE(b(1n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r),...ra.bigInt2BytesLE(b(0n),r)]),G=t.alloc([...ra.bigInt2BytesLE(b(1n),r),...ra.bigInt2BytesLE(b(1n),r)]);!function(){const a=t.addFunction(m+"_mulNR");a.addParam("x","i32"),a.addParam("pr","i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(r)),o=e.getLocal("x"),n=e.i32_add(e.getLocal("x"),e.i32_const(r)),c=e.getLocal("pr"),l=e.i32_add(e.getLocal("pr"),e.i32_const(r));a.addCode(e.call(f+"_copy",o,i),e.call(f+"_sub",o,n,c),e.call(f+"_add",i,n,l))}();const P=ua(t,m+"_mulNR","f6m","f2m");!function(){const a=t.addFunction(P+"_mulNR");a.addParam("x","i32"),a.addParam("pr","i32");const e=a.getCodeBuilder(),i=e.i32_const(t.alloc(2*r));a.addCode(e.call(m+"_copy",e.getLocal("x"),i),e.call(m+"_mulNR",e.i32_add(e.getLocal("x"),e.i32_const(4*c)),e.getLocal("pr")),e.call(m+"_copy",e.i32_add(e.getLocal("x"),e.i32_const(2*c)),e.i32_add(e.getLocal("pr"),e.i32_const(4*c))),e.call(m+"_copy",i,e.i32_add(e.getLocal("pr"),e.i32_const(2*c))))}();const U=da(t,P+"_mulNR","ftm",P),O=function(t){let a=t;const e=[];for(;a>0n;)La(a)?e.push(1):e.push(0),a>>=1n;return e}(0xd201000000010000n),z=t.alloc(O),Q=3*l,q=O.length-1,M=O.reduce(((t,a)=>t+(0!=a?1:0)),0),T=6*c,k=3*c*2+(M+q+1)*Q,R=15132376222941642752n;function D(a){const e=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],n=t.addFunction(U+"_frobeniusMap"+a);n.addParam("x","i32"),n.addParam("r","i32");const s=n.getCodeBuilder();for(let i=0;i<6;i++){const u=0==i?s.getLocal("x"):s.i32_add(s.getLocal("x"),s.i32_const(i*l)),g=u,_=s.i32_add(s.getLocal("x"),s.i32_const(i*l+r)),p=0==i?s.getLocal("r"):s.i32_add(s.getLocal("r"),s.i32_const(i*l)),h=p,L=s.i32_add(s.getLocal("r"),s.i32_const(i*l+r)),w=d(e[Math.floor(i/3)][a%12],o[i%3][a%6]),A=t.alloc([...ra.bigInt2BytesLE(b(w[0]),c),...ra.bigInt2BytesLE(b(w[1]),c)]);a%2==1?n.addCode(s.call(f+"_copy",g,h),s.call(f+"_neg",_,L),s.call(m+"_mul",p,s.i32_const(A),p)):n.addCode(s.call(m+"_mul",u,s.i32_const(A),p))}function d(t,a){const e=t[0],o=t[1],n=a[0],c=a[1],r=[(e*n-o*c)%i,(e*c+o*n)%i];return wa(r[0])&&(r[0]=r[0]+i),r}}function N(a,i,o){const n=function(t){let a=t;const e=[];for(;a>0n;){if(La(a)){const t=2-Number(a%4n);e.push(t),a-=BigInt(t)}else e.push(0);a>>=1n}return e}(a).map((t=>-1==t?255:t)),c=t.alloc(n),r=t.addFunction(e+"__cyclotomicExp_"+o);r.addParam("x","i32"),r.addParam("r","i32"),r.addLocal("bit","i32"),r.addLocal("i","i32");const l=r.getCodeBuilder(),d=l.getLocal("x"),u=l.getLocal("r"),g=l.i32_const(t.alloc(s));r.addCode(l.call(U+"_conjugate",d,g),l.call(U+"_one",u),l.if(l.teeLocal("bit",l.i32_load8_s(l.i32_const(n.length-1),c)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(U+"_mul",u,d,u),l.call(U+"_mul",u,g,u))),l.setLocal("i",l.i32_const(n.length-2)),l.block(l.loop(l.call(e+"__cyclotomicSquare",u,u),l.if(l.teeLocal("bit",l.i32_load8_s(l.getLocal("i"),c)),l.if(l.i32_eq(l.getLocal("bit"),l.i32_const(1)),l.call(U+"_mul",u,d,u),l.call(U+"_mul",u,g,u))),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0)))),i&&r.addCode(l.call(U+"_conjugate",u,u))}t.modules[e]={n64q:n,n64r:d,n8q:c,n8r:u,pG1gen:I,pG1zero:x,pG1b:p,pG2gen:E,pG2zero:v,pG2b:L,pq:t.modules.f1m.pq,pr:_,pOneT:S,r:o,q:i,prePSize:T,preQSize:k},function(){const a=t.addFunction(P+"_mul1");a.addParam("pA","i32"),a.addParam("pC1","i32"),a.addParam("pR","i32");const e=a.getCodeBuilder(),i=e.getLocal("pA"),o=e.i32_add(e.getLocal("pA"),e.i32_const(2*r)),n=e.i32_add(e.getLocal("pA"),e.i32_const(4*r)),c=e.getLocal("pC1"),l=e.getLocal("pR"),s=e.i32_add(e.getLocal("pR"),e.i32_const(2*r)),d=e.i32_add(e.getLocal("pR"),e.i32_const(4*r)),u=e.i32_const(t.alloc(2*r)),g=e.i32_const(t.alloc(2*r));a.addCode(e.call(m+"_add",i,o,u),e.call(m+"_add",o,n,g),e.call(m+"_mul",o,c,d),e.call(m+"_mul",g,c,l),e.call(m+"_sub",l,d,l),e.call(m+"_mulNR",l,l),e.call(m+"_mul",u,c,s),e.call(m+"_sub",s,d,s))}(),function(){const a=t.addFunction(P+"_mul01");a.addParam("pA","i32"),a.addParam("pC0","i32"),a.addParam("pC1","i32"),a.addParam("pR","i32");const e=a.getCodeBuilder(),i=e.getLocal("pA"),o=e.i32_add(e.getLocal("pA"),e.i32_const(2*r)),n=e.i32_add(e.getLocal("pA"),e.i32_const(4*r)),c=e.getLocal("pC0"),l=e.getLocal("pC1"),s=e.getLocal("pR"),d=e.i32_add(e.getLocal("pR"),e.i32_const(2*r)),u=e.i32_add(e.getLocal("pR"),e.i32_const(4*r)),g=e.i32_const(t.alloc(2*r)),_=e.i32_const(t.alloc(2*r)),f=e.i32_const(t.alloc(2*r)),p=e.i32_const(t.alloc(2*r));a.addCode(e.call(m+"_mul",i,c,g),e.call(m+"_mul",o,l,_),e.call(m+"_add",i,o,f),e.call(m+"_add",i,n,p),e.call(m+"_add",o,n,s),e.call(m+"_mul",s,l,s),e.call(m+"_sub",s,_,s),e.call(m+"_mulNR",s,s),e.call(m+"_add",s,g,s),e.call(m+"_add",c,l,d),e.call(m+"_mul",d,f,d),e.call(m+"_sub",d,g,d),e.call(m+"_sub",d,_,d),e.call(m+"_mul",p,c,u),e.call(m+"_sub",u,g,u),e.call(m+"_add",u,_,u))}(),function(){const a=t.addFunction(U+"_mul014");a.addParam("pA","i32"),a.addParam("pC0","i32"),a.addParam("pC1","i32"),a.addParam("pC4","i32"),a.addParam("pR","i32");const e=a.getCodeBuilder(),i=e.getLocal("pA"),o=e.i32_add(e.getLocal("pA"),e.i32_const(6*r)),n=e.getLocal("pC0"),c=e.getLocal("pC1"),l=e.getLocal("pC4"),s=e.i32_const(t.alloc(6*r)),d=e.i32_const(t.alloc(6*r)),u=e.i32_const(t.alloc(2*r)),g=e.getLocal("pR"),_=e.i32_add(e.getLocal("pR"),e.i32_const(6*r));a.addCode(e.call(P+"_mul01",i,n,c,s),e.call(P+"_mul1",o,l,d),e.call(m+"_add",c,l,u),e.call(P+"_add",o,i,_),e.call(P+"_mul01",_,n,u,_),e.call(P+"_sub",_,s,_),e.call(P+"_sub",_,d,_),e.call(P+"_copy",d,g),e.call(P+"_mulNR",g,g),e.call(P+"_add",g,s,g))}(),function(){const a=t.addFunction(e+"_ell");a.addParam("pP","i32"),a.addParam("pCoefs","i32"),a.addParam("pF","i32");const i=a.getCodeBuilder(),o=i.getLocal("pP"),n=i.i32_add(i.getLocal("pP"),i.i32_const(c)),l=i.getLocal("pF"),s=i.getLocal("pCoefs"),d=i.i32_add(i.getLocal("pCoefs"),i.i32_const(r)),u=i.i32_add(i.getLocal("pCoefs"),i.i32_const(2*r)),g=i.i32_add(i.getLocal("pCoefs"),i.i32_const(3*r)),_=i.i32_add(i.getLocal("pCoefs"),i.i32_const(4*r)),p=t.alloc(2*r),h=i.i32_const(p),m=i.i32_const(p),L=i.i32_const(p+r),w=t.alloc(2*r),A=i.i32_const(w),b=i.i32_const(w),y=i.i32_const(w+r);a.addCode(i.call(f+"_mul",s,n,m),i.call(f+"_mul",d,n,L),i.call(f+"_mul",u,o,b),i.call(f+"_mul",g,o,y),i.call(U+"_mul014",l,_,A,h,l))}();const K=t.alloc(T),V=t.alloc(k);function j(a){const i=t.addFunction(e+"_pairingEq"+a);for(let t=0;t<a;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const o=i.getCodeBuilder(),n=o.i32_const(t.alloc(s)),c=o.i32_const(t.alloc(s));i.addCode(o.call(U+"_one",n));for(let t=0;t<a;t++)i.addCode(o.call(e+"_prepareG1",o.getLocal("p_"+t),o.i32_const(K))),i.addCode(o.call(e+"_prepareG2",o.getLocal("q_"+t),o.i32_const(V))),i.addCode(o.if(o.i32_eqz(o.call(h+"_inGroupAffine",o.i32_const(K))),o.ret(o.i32_const(0))),o.if(o.i32_eqz(o.call(w+"_inGroupAffine",o.i32_const(V))),o.ret(o.i32_const(0)))),i.addCode(o.call(e+"_millerLoop",o.i32_const(K),o.i32_const(V),c)),i.addCode(o.call(U+"_mul",n,c,n));i.addCode(o.call(e+"_finalExponentiation",n,n)),i.addCode(o.call(U+"_eq",n,o.getLocal("c")))}for(let a=0;a<10;a++)D(a),t.exportFunction(U+"_frobeniusMap"+a);!function(){const a=t.addFunction(h+"_inGroupAffine");a.addParam("p","i32"),a.setReturnType("i32");const e=a.getCodeBuilder(),i=(R*R-1n)/3n,o=e.i32_const(t.alloc(ra.bigInt2BytesLE(b(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),c))),n=e.i32_const(t.alloc(ra.bigInt2BytesLE(b(793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n),c))),l=e.i32_const(t.alloc(ra.bigInt2BytesLE(i,16))),s=e.getLocal("p"),d=e.i32_add(e.getLocal("p"),e.i32_const(r)),u=t.alloc(3*r),g=e.i32_const(u),_=e.i32_const(u),p=e.i32_const(u+r),m=t.alloc(2*r),L=e.i32_const(m),w=e.i32_const(m),A=e.i32_const(m+r);a.addCode(e.if(e.call(h+"_isZeroAffine",e.getLocal("p")),e.ret(e.i32_const(1))),e.if(e.i32_eqz(e.call(h+"_inCurveAffine",e.getLocal("p"))),e.ret(e.i32_const(0))),e.call(f+"_mul",s,o,_),e.call(f+"_copy",d,p),e.call(f+"_mul",s,n,w),e.call(f+"_copy",d,A),e.call(h+"_doubleAffine",g,g),e.call(h+"_subMixed",g,e.getLocal("p"),g),e.call(h+"_subMixed",g,L,g),e.call(h+"_timesScalar",g,l,e.i32_const(16),g),e.ret(e.call(h+"_eqMixed",g,L)));const y=t.addFunction(h+"_inGroup");y.addParam("pIn","i32"),y.setReturnType("i32");const I=y.getCodeBuilder(),C=I.i32_const(t.alloc(2*r));y.addCode(I.call(h+"_toAffine",I.getLocal("pIn"),C),I.ret(I.call(h+"_inGroupAffine",C)))}(),function(){const a=t.addFunction(w+"_inGroupAffine");a.addParam("p","i32"),a.setReturnType("i32");const e=a.getCodeBuilder(),i=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],o=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],n=e.i32_const(t.alloc([...ra.bigInt2BytesLE(b(i[0]),c),...ra.bigInt2BytesLE(b(i[1]),c)])),s=e.i32_const(t.alloc(ra.bigInt2BytesLE(b(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),c))),d=e.i32_const(t.alloc([...ra.bigInt2BytesLE(b(o[0]),c),...ra.bigInt2BytesLE(b(o[1]),c)])),u=e.i32_const(t.alloc(ra.bigInt2BytesLE(R,8))),g=e.getLocal("p"),_=e.i32_add(e.getLocal("p"),e.i32_const(l)),p=e.i32_const(t.alloc(r)),h=e.i32_const(t.alloc(l)),L=e.i32_const(t.alloc(l)),A=t.alloc(2*l),y=e.i32_const(A),I=e.i32_const(A),C=e.i32_const(A),x=e.i32_const(A+r),F=e.i32_const(A+l),E=e.i32_const(A+l),B=e.i32_const(A+l+r),v=t.alloc(3*l),S=e.i32_const(v),G=e.i32_const(v),P=e.i32_const(v),U=e.i32_const(v+r),O=e.i32_const(v+l),z=e.i32_const(v+l),Q=e.i32_const(v+l+r),q=e.i32_const(v+2*l);a.addCode(e.if(e.call(w+"_isZeroAffine",e.getLocal("p")),e.ret(e.i32_const(1))),e.if(e.i32_eqz(e.call(w+"_inCurveAffine",e.getLocal("p"))),e.ret(e.i32_const(0))),e.call(m+"_mul",g,n,h),e.call(m+"_mul",_,n,L),e.call(m+"_mul1",h,s,I),e.call(m+"_neg",L,F),e.call(m+"_neg",h,G),e.call(m+"_mul",L,d,O),e.call(f+"_sub",C,x,p),e.call(f+"_add",C,x,x),e.call(f+"_copy",p,C),e.call(f+"_sub",E,B,p),e.call(f+"_add",E,B,B),e.call(f+"_copy",p,E),e.call(f+"_add",P,U,p),e.call(f+"_sub",P,U,U),e.call(f+"_copy",p,P),e.call(f+"_sub",Q,z,p),e.call(f+"_add",z,Q,Q),e.call(f+"_copy",p,z),e.call(m+"_one",q),e.call(w+"_timesScalar",S,u,e.i32_const(8),S),e.call(w+"_addMixed",S,y,S),e.ret(e.call(w+"_eqMixed",S,e.getLocal("p"))));const M=t.addFunction(w+"_inGroup");M.addParam("pIn","i32"),M.setReturnType("i32");const T=M.getCodeBuilder(),k=T.i32_const(t.alloc(2*l));M.addCode(T.call(w+"_toAffine",T.getLocal("pIn"),k),T.ret(T.call(w+"_inGroupAffine",k)))}(),function(){const a=t.addFunction(e+"_prepAddStep");a.addParam("R","i32"),a.addParam("Q","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*c)),r=i.i32_add(i.getLocal("R"),i.i32_const(4*c)),s=i.getLocal("Q"),d=i.i32_add(i.getLocal("Q"),i.i32_const(2*c)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(2*c)),_=i.i32_add(i.getLocal("r"),i.i32_const(4*c)),f=i.i32_const(t.alloc(l)),p=i.i32_const(t.alloc(l)),h=i.i32_const(t.alloc(l)),L=i.i32_const(t.alloc(l)),w=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),I=i.i32_const(t.alloc(l)),C=i.i32_const(t.alloc(l)),x=i.i32_const(t.alloc(l));a.addCode(i.call(m+"_square",r,f),i.call(m+"_square",d,p),i.call(m+"_mul",f,s,L),i.call(m+"_add",d,r,g),i.call(m+"_square",g,g),i.call(m+"_sub",g,p,g),i.call(m+"_sub",g,f,g),i.call(m+"_mul",g,f,g),i.call(m+"_sub",L,o,w),i.call(m+"_square",w,A),i.call(m+"_add",A,A,b),i.call(m+"_add",b,b,b),i.call(m+"_mul",b,w,y),i.call(m+"_sub",g,n,I),i.call(m+"_sub",I,n,I),i.call(m+"_mul",I,s,_),i.call(m+"_mul",b,o,C),i.call(m+"_square",I,o),i.call(m+"_sub",o,y,o),i.call(m+"_sub",o,C,o),i.call(m+"_sub",o,C,o),i.call(m+"_add",r,w,r),i.call(m+"_square",r,r),i.call(m+"_sub",r,f,r),i.call(m+"_sub",r,A,r),i.call(m+"_add",d,r,u),i.call(m+"_sub",C,o,x),i.call(m+"_mul",x,I,x),i.call(m+"_mul",n,y,L),i.call(m+"_add",L,L,L),i.call(m+"_sub",x,L,n),i.call(m+"_square",u,u),i.call(m+"_sub",u,p,u),i.call(m+"_square",r,h),i.call(m+"_sub",u,h,u),i.call(m+"_add",_,_,_),i.call(m+"_sub",_,u,_),i.call(m+"_add",r,r,u),i.call(m+"_neg",I,I),i.call(m+"_add",I,I,g))}(),function(){const a=t.addFunction(e+"_prepDblStep");a.addParam("R","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*c)),r=i.i32_add(i.getLocal("R"),i.i32_const(4*c)),s=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(2*c)),u=i.i32_add(i.getLocal("r"),i.i32_const(4*c)),g=i.i32_const(t.alloc(l)),_=i.i32_const(t.alloc(l)),f=i.i32_const(t.alloc(l)),p=i.i32_const(t.alloc(l)),h=i.i32_const(t.alloc(l));a.addCode(i.call(m+"_square",o,s),i.call(m+"_square",n,_),i.call(m+"_square",_,f),i.call(m+"_add",_,o,d),i.call(m+"_square",d,d),i.call(m+"_sub",d,s,d),i.call(m+"_sub",d,f,d),i.call(m+"_add",d,d,d),i.call(m+"_add",s,s,p),i.call(m+"_add",p,s,p),i.call(m+"_add",o,p,u),i.call(m+"_square",p,h),i.call(m+"_square",r,g),i.call(m+"_sub",h,d,o),i.call(m+"_sub",o,d,o),i.call(m+"_add",r,n,r),i.call(m+"_square",r,r),i.call(m+"_sub",r,_,r),i.call(m+"_sub",r,g,r),i.call(m+"_sub",d,o,n),i.call(m+"_mul",n,p,n),i.call(m+"_add",f,f,f),i.call(m+"_add",f,f,f),i.call(m+"_add",f,f,f),i.call(m+"_sub",n,f,n),i.call(m+"_mul",p,g,d),i.call(m+"_add",d,d,d),i.call(m+"_neg",d,d),i.call(m+"_square",u,u),i.call(m+"_sub",u,s,u),i.call(m+"_sub",u,h,u),i.call(m+"_add",_,_,_),i.call(m+"_add",_,_,_),i.call(m+"_sub",u,_,u),i.call(m+"_mul",r,g,s),i.call(m+"_add",s,s,s))}(),function(){const a=t.addFunction(e+"_prepareG1");a.addParam("pP","i32"),a.addParam("ppreP","i32");const i=a.getCodeBuilder();a.addCode(i.call(h+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){const a=t.addFunction(e+"_prepareG2");a.addParam("pQ","i32"),a.addParam("ppreQ","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const i=a.getCodeBuilder(),o=i.getLocal("pQ"),n=t.alloc(3*l),c=i.i32_const(n),r=i.getLocal("ppreQ");a.addCode(i.call(w+"_normalize",o,r),i.if(i.call(w+"_isZero",r),i.ret([])),i.call(w+"_copy",r,c),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*l)))),a.addCode(i.setLocal("i",i.i32_const(O.length-2)),i.block(i.loop(i.call(e+"_prepDblStep",c,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q))),i.if(i.i32_load8_s(i.getLocal("i"),z),[...i.call(e+"_prepAddStep",c,r,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),function(){const a=t.addFunction(e+"_millerLoop");a.addParam("ppreP","i32"),a.addParam("ppreQ","i32"),a.addParam("r","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");const i=a.getCodeBuilder(),o=i.getLocal("ppreP"),n=i.getLocal("pCoef"),c=i.getLocal("r");a.addCode(i.call(U+"_one",c),i.if(i.call(h+"_isZero",o),i.ret([])),i.if(i.call(h+"_isZero",i.getLocal("ppreQ")),i.ret([])),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*l))),i.setLocal("i",i.i32_const(O.length-2)),i.block(i.loop(i.call(e+"_ell",o,n,c),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q))),i.if(i.i32_load8_s(i.getLocal("i"),z),[...i.call(e+"_ell",o,n,c),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(Q)))]),i.call(U+"_square",c,c),i.br_if(1,i.i32_eq(i.getLocal("i"),i.i32_const(1))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.call(e+"_ell",o,n,c)),a.addCode(i.call(U+"_conjugate",c,c))}(),function(){const a=t.addFunction(e+"_finalExponentiationOld");a.addParam("x","i32"),a.addParam("r","i32");const i=t.alloc(ra.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),o=a.getCodeBuilder();a.addCode(o.call(U+"_exp",o.getLocal("x"),o.i32_const(i),o.i32_const(544),o.getLocal("r")))}(),function(){!function(){const a=t.addFunction(e+"__cyclotomicSquare");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(l)),c=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),r=i.i32_add(i.getLocal("x"),i.i32_const(3*l)),s=i.i32_add(i.getLocal("x"),i.i32_const(4*l)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*l)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(l)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*l)),f=i.i32_add(i.getLocal("r"),i.i32_const(3*l)),p=i.i32_add(i.getLocal("r"),i.i32_const(4*l)),h=i.i32_add(i.getLocal("r"),i.i32_const(5*l)),L=i.i32_const(t.alloc(l)),w=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),I=i.i32_const(t.alloc(l)),C=i.i32_const(t.alloc(l)),x=i.i32_const(t.alloc(l));a.addCode(i.call(m+"_mul",o,s,C),i.call(m+"_mulNR",s,L),i.call(m+"_add",o,L,L),i.call(m+"_add",o,s,x),i.call(m+"_mul",x,L,L),i.call(m+"_mulNR",C,x),i.call(m+"_add",C,x,x),i.call(m+"_sub",L,x,L),i.call(m+"_add",C,C,w),i.call(m+"_mul",r,c,C),i.call(m+"_mulNR",c,A),i.call(m+"_add",r,A,A),i.call(m+"_add",r,c,x),i.call(m+"_mul",x,A,A),i.call(m+"_mulNR",C,x),i.call(m+"_add",C,x,x),i.call(m+"_sub",A,x,A),i.call(m+"_add",C,C,b),i.call(m+"_mul",n,d,C),i.call(m+"_mulNR",d,y),i.call(m+"_add",n,y,y),i.call(m+"_add",n,d,x),i.call(m+"_mul",x,y,y),i.call(m+"_mulNR",C,x),i.call(m+"_add",C,x,x),i.call(m+"_sub",y,x,y),i.call(m+"_add",C,C,I),i.call(m+"_sub",L,o,u),i.call(m+"_add",u,u,u),i.call(m+"_add",L,u,u),i.call(m+"_add",w,s,p),i.call(m+"_add",p,p,p),i.call(m+"_add",w,p,p),i.call(m+"_mul",I,i.i32_const(G),x),i.call(m+"_add",x,r,f),i.call(m+"_add",f,f,f),i.call(m+"_add",x,f,f),i.call(m+"_sub",y,c,_),i.call(m+"_add",_,_,_),i.call(m+"_add",y,_,_),i.call(m+"_sub",A,n,g),i.call(m+"_add",g,g,g),i.call(m+"_add",A,g,g),i.call(m+"_add",b,d,h),i.call(m+"_add",h,h,h),i.call(m+"_add",b,h,h))}(),N(R,true,"w0");const a=t.addFunction(e+"_finalExponentiation");a.addParam("x","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),c=i.i32_const(t.alloc(s)),r=i.i32_const(t.alloc(s)),d=i.i32_const(t.alloc(s)),u=i.i32_const(t.alloc(s)),g=i.i32_const(t.alloc(s)),_=i.i32_const(t.alloc(s)),f=i.i32_const(t.alloc(s));a.addCode(i.call(U+"_frobeniusMap6",o,c),i.call(U+"_inverse",o,r),i.call(U+"_mul",c,r,d),i.call(U+"_copy",d,r),i.call(U+"_frobeniusMap2",d,d),i.call(U+"_mul",d,r,d),i.call(e+"__cyclotomicSquare",d,r),i.call(U+"_conjugate",r,r),i.call(e+"__cyclotomicExp_w0",d,u),i.call(e+"__cyclotomicSquare",u,g),i.call(U+"_mul",r,u,_),i.call(e+"__cyclotomicExp_w0",_,r),i.call(e+"__cyclotomicExp_w0",r,c),i.call(e+"__cyclotomicExp_w0",c,f),i.call(U+"_mul",f,g,f),i.call(e+"__cyclotomicExp_w0",f,g),i.call(U+"_conjugate",_,_),i.call(U+"_mul",g,_,g),i.call(U+"_mul",g,d,g),i.call(U+"_conjugate",d,_),i.call(U+"_mul",r,d,r),i.call(U+"_frobeniusMap3",r,r),i.call(U+"_mul",f,_,f),i.call(U+"_frobeniusMap1",f,f),i.call(U+"_mul",u,c,u),i.call(U+"_frobeniusMap2",u,u),i.call(U+"_mul",u,r,u),i.call(U+"_mul",u,f,u),i.call(U+"_mul",u,g,n))}();for(let a=1;a<=5;a++)j(a),t.exportFunction(e+"_pairingEq"+a);!function(){const a=t.addFunction(e+"_pairing");a.addParam("p","i32"),a.addParam("q","i32"),a.addParam("r","i32");const i=a.getCodeBuilder(),o=i.i32_const(t.alloc(s));a.addCode(i.call(e+"_prepareG1",i.getLocal("p"),i.i32_const(K))),a.addCode(i.call(e+"_prepareG2",i.getLocal("q"),i.i32_const(V))),a.addCode(i.call(e+"_millerLoop",i.i32_const(K),i.i32_const(V),o)),a.addCode(i.call(e+"_finalExponentiation",o,i.getLocal("r")))}(),t.exportFunction(e+"_pairing"),t.exportFunction(e+"_prepareG1"),t.exportFunction(e+"_prepareG2"),t.exportFunction(e+"_millerLoop"),t.exportFunction(e+"_finalExponentiation"),t.exportFunction(e+"_finalExponentiationOld"),t.exportFunction(e+"__cyclotomicSquare"),t.exportFunction(e+"__cyclotomicExp_w0"),t.exportFunction(P+"_mul1"),t.exportFunction(P+"_mul01"),t.exportFunction(U+"_mul014"),t.exportFunction(h+"_inGroupAffine"),t.exportFunction(h+"_inGroup"),t.exportFunction(w+"_inGroupAffine"),t.exportFunction(w+"_inGroup")};function ya(t,a){let e=t;void 0===a&&0==(a=Math.floor((o(t)-1)/8)+1)&&(a=1);const i=new Uint8Array(a),n=new DataView(i.buffer);let c=0;for(;c<a;)c+4<=a?(n.setUint32(c,Number(e&BigInt(4294967295)),!0),c+=4,e>>=BigInt(32)):c+2<=a?(n.setUint16(Number(c,e&BigInt(65535)),!0),c+=2,e>>=BigInt(16)):(n.setUint8(Number(c,e&BigInt(255)),!0),c+=1,e>>=BigInt(8));if(e)throw new Error("Number does not fit in this length");return i}const Ia=[];for(let t=0;t<256;t++)Ia[t]=Ca(t,8);function Ca(t,a){let e=0,i=t;for(let t=0;t<a;t++)e<<=1,e|=1&i,i>>=1;return e}function xa(t,a){return(Ia[t>>>24]|Ia[t>>>16&255]<<8|Ia[t>>>8&255]<<16|Ia[255&t]<<24)>>>32-a}function Fa(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function Ea(t,a){const e=t.byteLength/a,i=Fa(e);if(e!=1<<i)throw new Error("Invalid number of pointers");for(let o=0;o<e;o++){const e=xa(o,i);if(o>e){const i=t.slice(o*a,(o+1)*a);t.set(t.slice(e*a,(e+1)*a),o*a),t.set(i,e*a)}}}function Ba(t,a){const e=new Uint8Array(a*t.length);for(let i=0;i<t.length;i++)e.set(t[i],i*a);return e}function va(t,a){const e=t.byteLength/a,i=new Array(e);for(let o=0;o<e;o++)i[o]=t.slice(o*a,o*a+a);return i}var Sa=Object.freeze({__proto__:null,stringifyBigInts:function t(a){if("bigint"==typeof a||void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return E(a,0);if(Array.isArray(a))return a.map(t);if("object"==typeof a){const e={};return Object.keys(a).forEach((i=>{e[i]=t(a[i])})),e}return a},unstringifyBigInts:function t(a){if("string"==typeof a&&/^[0-9]+$/.test(a))return BigInt(a);if("string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return BigInt(a);if(Array.isArray(a))return a.map(t);if("object"==typeof a){if(null===a)return null;const e={};return Object.keys(a).forEach((i=>{e[i]=t(a[i])})),e}return a},beBuff2int:function(t){let a=BigInt(0),e=t.length,i=0;const o=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;e>0;)e>=4?(e-=4,a+=BigInt(o.getUint32(e))<<BigInt(8*i),i+=4):e>=2?(e-=2,a+=BigInt(o.getUint16(e))<<BigInt(8*i),i+=2):(e-=1,a+=BigInt(o.getUint8(e))<<BigInt(8*i),i+=1);return a},beInt2Buff:function(t,a){let e=t;const i=new Uint8Array(a),o=new DataView(i.buffer);let n=a;for(;n>0;)n-4>=0?(n-=4,o.setUint32(n,Number(e&BigInt(4294967295))),e>>=BigInt(32)):n-2>=0?(n-=2,o.setUint16(n,Number(e&BigInt(65535))),e>>=BigInt(16)):(n-=1,o.setUint8(n,Number(e&BigInt(255))),e>>=BigInt(8));if(e)throw new Error("Number does not fit in this length");return i},leBuff2int:function(t){let a=BigInt(0),e=0;const i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;e<t.length;)e+4<=t.length?(a+=BigInt(i.getUint32(e,!0))<<BigInt(8*e),e+=4):e+4<=t.length?(a+=BigInt(i.getUint16(e,!0))<<BigInt(8*e),e+=2):(a+=BigInt(i.getUint8(e,!0))<<BigInt(8*e),e+=1);return a},leInt2Buff:ya,stringifyFElements:function t(a,e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return a.toString(a.e(e));if(Array.isArray(e))return e.map(t.bind(this,a));if("object"==typeof e){const i={};return Object.keys(e).forEach((o=>{i[o]=t(a,e[o])})),i}return e},unstringifyFElements:function t(a,e){if("string"==typeof e&&/^[0-9]+$/.test(e))return a.e(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return a.e(e);if(Array.isArray(e))return e.map(t.bind(this,a));if("object"==typeof e){if(null===e)return null;const i={};return Object.keys(e).forEach((o=>{i[o]=t(a,e[o])})),i}return e},bitReverse:xa,log2:Fa,buffReverseBits:Ea,array2buffer:Ba,buffer2array:va});const Ga=1<<30;class Pa{constructor(t){this.buffers=[],this.byteLength=t;for(let a=0;a<t;a+=Ga){const e=Math.min(t-a,Ga);this.buffers.push(new Uint8Array(e))}}slice(t,a){void 0===a&&(a=this.byteLength),void 0===t&&(t=0);const e=a-t,i=Math.floor(t/Ga);if(i==Math.floor((t+e-1)/Ga)||0==e)return this.buffers[i].slice(t%Ga,t%Ga+e);let o,n=i,c=t%Ga,r=e;for(;r>0;){const t=c+r>Ga?Ga-c:r,a=new Uint8Array(this.buffers[n].buffer,this.buffers[n].byteOffset+c,t);if(t==e)return a.slice();o||(o=e<=Ga?new Uint8Array(e):new Pa(e)),o.set(a,e-r),r-=t,n++,c=0}return o}set(t,a){void 0===a&&(a=0);const e=t.byteLength;if(0==e)return;const i=Math.floor(a/Ga);if(i==Math.floor((a+e-1)/Ga))return t instanceof Pa&&1==t.buffers.length?this.buffers[i].set(t.buffers[0],a%Ga):this.buffers[i].set(t,a%Ga);let o=i,n=a%Ga,c=e;for(;c>0;){const a=n+c>Ga?Ga-n:c,i=t.slice(e-c,e-c+a);new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+n,a).set(i),c-=a,o++,n=0}}}function Ua(t,a,e,i){return async function(o){const n=Math.floor(o.byteLength/e);if(n*e!==o.byteLength)throw new Error("Invalid buffer size");const c=Math.floor(n/t.concurrency),r=[];for(let l=0;l<t.concurrency;l++){let s;if(s=l<t.concurrency-1?c:n-l*c,0==s)continue;const d=[{cmd:"ALLOCSET",var:0,buff:o.slice(l*c*e,l*c*e+s*e)},{cmd:"ALLOC",var:1,len:i*s},{cmd:"CALL",fnName:a,params:[{var:0},{val:s},{var:1}]},{cmd:"GET",out:0,var:1,len:i*s}];r.push(t.queueAction(d))}const l=await Promise.all(r);let s;s=o instanceof Pa?new Pa(n*i):new Uint8Array(n*i);let d=0;for(let t=0;t<l.length;t++)s.set(l[t][0],d),d+=l[t][0].byteLength;return s}}class Oa{constructor(t,a,e,i){if(this.tm=t,this.prefix=a,this.p=i,this.n8=e,this.type="F1",this.m=1,this.half=l(i,P),this.bitLength=o(i),this.mask=p(r(P,this.bitLength),P),this.pOp1=t.alloc(e),this.pOp2=t.alloc(e),this.pOp3=t.alloc(e),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(e/8),this.n32=Math.floor(e/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=l(this.p,P),this.nqr=this.two;let n=this.exp(this.nqr,this.half);for(;!this.eq(n,this.negone);)this.nqr=this.add(this.nqr,this.one),n=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let c=p(this.p,P);for(;!u(c);)this.s=this.s+1,c=l(c,P);this.w=[],this.w[this.s]=this.exp(this.nqr,c);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Ua(t,a+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Ua(t,a+"_batchFromMontgomery",this.n8,this.n8)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){return this.op2("_add",t,a)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=S(i(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,a){if(t instanceof Uint8Array)return t;let e=i(t,a);n(e)?(e=h(e),y(e,this.p)&&(e=A(e,this.p)),e=p(this.p,e)):y(e,this.p)&&(e=A(e,this.p));const o=ya(e,this.n8);return this.toMontgomery(o)}toString(t,a){return v(E(this.fromMontgomery(t),0),a)}fromRng(t){let a;const e=new Uint8Array(this.n8);do{a=G;for(let e=0;e<this.n64;e++)a=f(a,r(t.nextU64(),64*e));a=C(a,this.mask)}while(I(a,this.p));return x(e,0,a,this.n8),e}random(){return this.fromRng(R())}toObject(t){return E(this.fromMontgomery(t),0)}fromObject(t){const a=new Uint8Array(this.n8);return x(a,0,t,this.n8),this.toMontgomery(a)}toRprLE(t,a,e){t.set(this.fromMontgomery(e),a)}toRprBE(t,a,e){const i=this.fromMontgomery(e);for(let t=0;t<this.n8/2;t++){const a=i[t];i[t]=i[this.n8-1-t],i[this.n8-1-t]=a}t.set(i,a)}fromRprLE(t,a){a=a||0;const e=t.slice(a,a+this.n8);return this.toMontgomery(e)}async batchInverse(t){let a=!1;const e=this.n8,i=this.n8;Array.isArray(t)?(t=Ba(t,e),a=!0):t=t.slice(0,t.byteLength);const o=Math.floor(t.byteLength/e);if(o*e!==t.byteLength)throw new Error("Invalid buffer size");const n=Math.floor(o/this.tm.concurrency),c=[];for(let a=0;a<this.tm.concurrency;a++){let r;if(r=a<this.tm.concurrency-1?n:o-a*n,0==r)continue;const l=[{cmd:"ALLOCSET",var:0,buff:t.slice(a*n*e,a*n*e+r*e)},{cmd:"ALLOC",var:1,len:i*r},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:e},{val:r},{var:1},{val:i}]},{cmd:"GET",out:0,var:1,len:i*r}];c.push(this.tm.queueAction(l))}const r=await Promise.all(c);let l;l=t instanceof Pa?new Pa(o*i):new Uint8Array(o*i);let s=0;for(let t=0;t<r.length;t++)l.set(r[t][0],s),s+=r[t][0].byteLength;return a?va(l,i):l}}class za{constructor(t,a,e){this.tm=t,this.prefix=a,this.F=e,this.type="F2",this.m=2*e.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*e.n8),this.pOp2=t.alloc(2*e.n8),this.pOp3=t.alloc(2*e.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){return this.op2("_add",t,a)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}mul1(t,a){return this.op2("_mul1",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=S(i(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,a){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const e=this.F.e(t[0],a),i=this.F.e(t[1],a),o=new Uint8Array(2*this.F.n8);return o.set(e),o.set(i,2*this.F.n8),o}throw new Error("invalid F2")}toString(t,a){return`[${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8),a)}]`}fromRng(t){const a=this.F.fromRng(t),e=this.F.fromRng(t),i=new Uint8Array(2*this.F.n8);return i.set(a),i.set(e,this.F.n8),i}random(){return this.fromRng(R())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const a=new Uint8Array(2*this.F.n8),e=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);return a.set(e),a.set(i,this.F.n8),a}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class Qa{constructor(t,a,e){this.tm=t,this.prefix=a,this.F=e,this.type="F3",this.m=3*e.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*e.n8),this.pOp2=t.alloc(3*e.n8),this.pOp3=t.alloc(3*e.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}add(t,a){return this.op2("_add",t,a)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=S(i(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,a){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const e=this.F.e(t[0],a),i=this.F.e(t[1],a),o=this.F.e(t[2],a),n=new Uint8Array(3*this.F.n8);return n.set(e),n.set(i,this.F.n8),n.set(o,2*this.F.n8),n}throw new Error("invalid F3")}toString(t,a){return`[${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),a)}, ${this.F.toString(t.slice(2*this.F.n8),a)}]`}fromRng(t){const a=this.F.fromRng(t),e=this.F.fromRng(t),i=this.F.fromRng(t),o=new Uint8Array(3*this.F.n8);return o.set(a),o.set(e,this.F.n8),o.set(i,2*this.F.n8),o}random(){return this.fromRng(R())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const a=new Uint8Array(3*this.F.n8),e=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]),o=this.F.fromObject(t[2]);return a.set(e),a.set(i,this.F.n8),a.set(o,2*this.F.n8),a}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class qa{constructor(t,a,e,i,o,n){this.tm=t,this.prefix=a,this.F=e,this.pOp1=t.alloc(3*e.n8),this.pOp2=t.alloc(3*e.n8),this.pOp3=t.alloc(3*e.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*e.n8),this.tm.instance.exports[a+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*e.n8),this.one=this.tm.getBuff(i,3*e.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(i,2*e.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(o,e.n8),n&&(this.cofactor=S(n)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Ua(t,a+"_batchLEMtoC",2*e.n8,e.n8),this.batchLEMtoU=Ua(t,a+"_batchLEMtoU",2*e.n8,2*e.n8),this.batchCtoLEM=Ua(t,a+"_batchCtoLEM",e.n8,2*e.n8),this.batchUtoLEM=Ua(t,a+"_batchUtoLEM",2*e.n8,2*e.n8),this.batchToJacobian=Ua(t,a+"_batchToJacobian",2*e.n8,3*e.n8),this.batchToAffine=Ua(t,a+"_batchToAffine",3*e.n8,2*e.n8)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_add",t,a);if(a.byteLength==2*this.F.n8)return this.op2("_addMixed",t,a);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_addMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2("_addAffine",t,a);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_sub",t,a);if(a.byteLength==2*this.F.n8)return this.op2("_subMixed",t,a);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_subMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2("_subAffine",t,a);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,a){let e;if(a instanceof Uint8Array||(a=S(i(a))),t.byteLength==3*this.F.n8)e=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");e=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[e](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,a){let e;if(t.byteLength==3*this.F.n8)e=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");e=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[e](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eq",t,a);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,a);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,a);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,a,e){if(this.tm.setBuff(this.pOp1,e),e.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(e.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,a)}fromRprUncompressed(t,a){const e=t.slice(a,a+2*this.F.n8);return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,a,e){if(this.tm.setBuff(this.pOp1,e),e.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(e.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,this.F.n8);t.set(i,a)}fromRprCompressed(t,a){const e=t.slice(a,a+this.F.n8);return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const a=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(a,0,t),a}toRprLEM(t,a,e){if(e.byteLength!=2*this.F.n8){if(e.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,a)}}else t.set(e,a)}fromRprLEM(t,a){return a=a||0,t.slice(a,a+2*this.F.n8)}toString(t,a){if(t.byteLength==3*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),a)}, ${this.F.toString(t.slice(2*this.F.n8),a)} ]`}if(t.byteLength==2*this.F.n8){return`[ ${this.F.toString(t.slice(0,this.F.n8),a)}, ${this.F.toString(t.slice(this.F.n8),a)} ]`}throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const a=this.F,e=this.toAffine(t),i=e.slice(0,this.F.n8),o=e.slice(this.F.n8,2*this.F.n8),n=a.add(a.mul(a.square(i),i),this.b),c=a.square(o);return a.eq(n,c)}fromRng(t){const a=this.F;let e,i,o=[];do{o[0]=a.fromRng(t),e=t.nextBool(),i=a.add(a.mul(a.square(o[0]),o[0]),this.b)}while(!a.isSquare(i));o[1]=a.sqrt(i);e^a.isNegative(o[1])&&(o[1]=a.neg(o[1]));let n=new Uint8Array(2*this.F.n8);return n.set(o[0]),n.set(o[1],this.F.n8),this.cofactor&&(n=this.timesScalar(n,this.cofactor)),n}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const a=this.F.toObject(t.slice(0,this.F.n8)),e=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let i;return i=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[a,e,i]}fromObject(t){const a=this.F.fromObject(t[0]),e=this.F.fromObject(t[1]);let i;if(i=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(i,this.F.one))return this.zeroAffine;if(this.F.eq(i,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(a),t.set(e,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(a),t.set(e,this.F.n8),t.set(i,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Ma(t){const a=32767;let e,i;async function o(t){const o=new Uint8Array(t.code),n=await WebAssembly.compile(o);i=new WebAssembly.Memory({initial:t.init,maximum:a}),e=await WebAssembly.instantiate(n,{env:{memory:i}})}function n(t){const e=new Uint32Array(i.buffer,0,1);for(;3&e[0];)e[0]++;const o=e[0];if(e[0]+=t,e[0]+t>i.buffer.byteLength){const o=i.buffer.byteLength/65536;let n=Math.floor((e[0]+t)/65536)+1;n>a&&(n=a),i.grow(n-o)}return o}function c(t){const a=n(t.byteLength);return l(a,t),a}function r(t,a){const e=new Uint8Array(i.buffer);return new Uint8Array(e.buffer,e.byteOffset+t,a)}function l(t,a){new Uint8Array(i.buffer).set(new Uint8Array(a),t)}function s(t){if("INIT"==t[0].cmd)return o(t[0]);const a={vars:[],out:[]},s=new Uint32Array(i.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":a.vars[t[i].var]=c(t[i].buff);break;case"ALLOC":a.vars[t[i].var]=n(t[i].len);break;case"SET":l(a.vars[t[i].var],t[i].buff);break;case"CALL":{const o=[];for(let e=0;e<t[i].params.length;e++){const n=t[i].params[e];void 0!==n.var?o.push(a.vars[n.var]+(n.offset||0)):void 0!==n.val&&o.push(n.val)}e.exports[t[i].fnName](...o);break}case"GET":a.out[t[i].out]=r(a.vars[t[i].var],t[i].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(i.buffer,0,1)[0]=s,a.out}return t&&(t.onmessage=function(a){let e;if(e=a.data?a.data:a,"INIT"==e[0].cmd)o(e[0]).then((function(){t.postMessage(e.result)}));else if("TERMINATE"==e[0].cmd)t.close();else{const a=s(e);t.postMessage(a)}}),s}var Ta={},ka=Worker;class Ra{constructor(){this.promise=new Promise(((t,a)=>{this.reject=a,this.resolve=t}))}}var Da;const Na="data:application/javascript;base64,"+(Da="("+Ma.toString()+")(self)",globalThis.btoa(Da));class Ka{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,a,e,i){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=i||new Ra,this.workers[t].postMessage(a,e),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const a=this.actionQueue.shift();this.postAction(t,a.data,a.transfers,a.deferred)}}queueAction(t,a){const e=new Ra;if(this.singleThread){const a=this.taskManager(t);e.resolve(a)}else this.actionQueue.push({data:t,transfers:a,deferred:e}),this.processWorks();return e.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const a=this.alloc(t.byteLength);return this.setBuff(a,t),a}getBuff(t,a){return this.u8.slice(t,t+a)}setBuff(t,a){this.u8.set(new Uint8Array(a),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const a=this.u32[0];return this.u32[0]+=t,a}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);var t;await(t=200,new Promise((a=>setTimeout(a,t))))}}function Va(t,a){const e=t[a],i=t.Fr,o=t.tm;t[a].batchApplyKey=async function(t,n,c,r,l){let s,d,u,g,_;if(r=r||"affine",l=l||"affine","G1"==a)"jacobian"==r?(u=3*e.F.n8,s="g1m_batchApplyKey"):(u=2*e.F.n8,s="g1m_batchApplyKeyMixed"),g=3*e.F.n8,"jacobian"==l?_=3*e.F.n8:(d="g1m_batchToAffine",_=2*e.F.n8);else if("G2"==a)"jacobian"==r?(u=3*e.F.n8,s="g2m_batchApplyKey"):(u=2*e.F.n8,s="g2m_batchApplyKeyMixed"),g=3*e.F.n8,"jacobian"==l?_=3*e.F.n8:(d="g2m_batchToAffine",_=2*e.F.n8);else{if("Fr"!=a)throw new Error("Invalid group: "+a);s="frm_batchApplyKey",u=e.n8,g=e.n8,_=e.n8}const f=Math.floor(t.byteLength/u),p=Math.floor(f/o.concurrency),h=[];c=i.e(c);let m=i.e(n);for(let a=0;a<o.concurrency;a++){let e;if(e=a<o.concurrency-1?p:f-a*p,0==e)continue;const n=[];n.push({cmd:"ALLOCSET",var:0,buff:t.slice(a*p*u,a*p*u+e*u)}),n.push({cmd:"ALLOCSET",var:1,buff:m}),n.push({cmd:"ALLOCSET",var:2,buff:c}),n.push({cmd:"ALLOC",var:3,len:e*Math.max(g,_)}),n.push({cmd:"CALL",fnName:s,params:[{var:0},{val:e},{var:1},{var:2},{var:3}]}),d&&n.push({cmd:"CALL",fnName:d,params:[{var:3},{val:e},{var:3}]}),n.push({cmd:"GET",out:0,var:3,len:e*_}),h.push(o.queueAction(n)),m=i.mul(m,i.exp(c,e))}const L=await Promise.all(h);let w;w=t instanceof Pa?new Pa(f*_):new Uint8Array(f*_);let A=0;for(let t=0;t<L.length;t++)w.set(L[t][0],A),A+=L[t][0].byteLength;return w}}const ja=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Ha(t,a){const e=t[a],i=e.tm;async function o(t,i,o,n,c){if(!(t instanceof Uint8Array))throw n&&n.error(`${c} _multiExpChunk buffBases is not Uint8Array`),new Error(`${c} _multiExpChunk buffBases is not Uint8Array`);if(!(i instanceof Uint8Array))throw n&&n.error(`${c} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${c} _multiExpChunk buffScalars is not Uint8Array`);let r,l;if(o=o||"affine","G1"==a)"affine"==o?(l="g1m_multiexpAffine_chunk",r=2*e.F.n8):(l="g1m_multiexp_chunk",r=3*e.F.n8);else{if("G2"!=a)throw new Error("Invalid group");"affine"==o?(l="g2m_multiexpAffine_chunk",r=2*e.F.n8):(l="g2m_multiexp_chunk",r=3*e.F.n8)}const s=Math.floor(t.byteLength/r);if(0==s)return e.zero;const d=Math.floor(i.byteLength/s);if(d*s!=i.byteLength)throw new Error("Scalar size does not match");const u=ja[Fa(s)],g=Math.floor((8*d-1)/u)+1,_=[];for(let a=0;a<g;a++){const o=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:i},{cmd:"ALLOC",var:2,len:3*e.F.n8},{cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:d},{val:s},{val:a*u},{val:Math.min(8*d-a*u,u)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*e.F.n8}];_.push(e.tm.queueAction(o))}const f=await Promise.all(_);let p=e.zero;for(let t=f.length-1;t>=0;t--){if(!e.isZero(p))for(let t=0;t<u;t++)p=e.double(p);p=e.add(p,f[t][0])}return p}async function n(t,n,c,r,l){const s=1<<22;let d;if("G1"==a)d="affine"==c?2*e.F.n8:3*e.F.n8;else{if("G2"!=a)throw new Error("Invalid group");d="affine"==c?2*e.F.n8:3*e.F.n8}const u=Math.floor(t.byteLength/d),g=Math.floor(n.byteLength/u);if(g*u!=n.byteLength)throw new Error("Scalar size does not match");const _=ja[Fa(u)],f=Math.floor((8*g-1)/_)+1;let p;p=Math.floor(u/(i.concurrency/f)),p>s&&(p=s),p<1024&&(p=1024);const h=[];for(let a=0;a<u;a+=p){r&&r.debug(`Multiexp start: ${l}: ${a}/${u}`);const e=Math.min(u-a,p),i=t.slice(a*d,(a+e)*d),s=n.slice(a*g,(a+e)*g);h.push(o(i,s,c,r,l).then((t=>(r&&r.debug(`Multiexp end: ${l}: ${a}/${u}`),t))))}const m=await Promise.all(h);let L=e.zero;for(let t=m.length-1;t>=0;t--)L=e.add(L,m[t]);return L}e.multiExp=async function(t,a,e,i){return await n(t,a,"jacobian",e,i)},e.multiExpAffine=async function(t,a,e,i){return await n(t,a,"affine",e,i)}}function $a(t,a){const e=t[a],i=t.Fr,o=e.tm;async function n(t,r,l,s,d,u){l=l||"affine",s=s||"affine";let g,_,f,p,h,m,L,w;"G1"==a?("affine"==l?(g=2*e.F.n8,p="g1m_batchToJacobian"):g=3*e.F.n8,_=3*e.F.n8,r&&(w="g1m_fftFinal"),L="g1m_fftJoin",m="g1m_fftMix","affine"==s?(f=2*e.F.n8,h="g1m_batchToAffine"):f=3*e.F.n8):"G2"==a?("affine"==l?(g=2*e.F.n8,p="g2m_batchToJacobian"):g=3*e.F.n8,_=3*e.F.n8,r&&(w="g2m_fftFinal"),L="g2m_fftJoin",m="g2m_fftMix","affine"==s?(f=2*e.F.n8,h="g2m_batchToAffine"):f=3*e.F.n8):"Fr"==a&&(g=e.n8,_=e.n8,f=e.n8,r&&(w="frm_fftFinal"),m="frm_fftMix",L="frm_fftJoin");let A=!1;Array.isArray(t)?(t=Ba(t,g),A=!0):t=t.slice(0,t.byteLength);const b=t.byteLength/g,y=Fa(b);if(1<<y!=b)throw new Error("fft must be multiple of 2");if(y==i.s+1){let a;return a=r?await async function(t,a,e,o,r){let l,s;l=t.slice(0,t.byteLength/2),s=t.slice(t.byteLength/2,t.byteLength);const d=[];d.push(n(l,!0,a,"jacobian",o,r)),d.push(n(s,!0,a,"jacobian",o,r)),[l,s]=await Promise.all(d);const u=await c(l,s,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",e,o,r);let g;g=u[0].byteLength>1<<28?new Pa(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength);return g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,l,s,d,u):await async function(t,a,e,o,r){let l,s;l=t.slice(0,t.byteLength/2),s=t.slice(t.byteLength/2,t.byteLength);const d=[];[l,s]=await c(l,s,"fftJoinExt",i.one,i.shift,a,"jacobian",o,r),d.push(n(l,!1,"jacobian",e,o,r)),d.push(n(s,!1,"jacobian",e,o,r));const u=await Promise.all(d);let g;g=u[0].byteLength>1<<28?new Pa(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength);return g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,l,s,d,u),A?va(a,f):a}let I,C,x;r&&(I=i.inv(i.e(b))),Ea(t,g);let F=Math.min(16384,b),E=b/F;for(;E<o.concurrency&&F>=16;)E*=2,F/=2;const B=Fa(F),v=[];for(let a=0;a<E;a++){d&&d.debug(`${u}: fft ${y} mix start: ${a}/${E}`);const e=[];e.push({cmd:"ALLOC",var:0,len:_*F});const i=t.slice(F*a*g,F*(a+1)*g);e.push({cmd:"SET",var:0,buff:i}),p&&e.push({cmd:"CALL",fnName:p,params:[{var:0},{val:F},{var:0}]});for(let t=1;t<=B;t++)e.push({cmd:"CALL",fnName:m,params:[{var:0},{val:F},{val:t}]});B==y?(w&&(e.push({cmd:"ALLOCSET",var:1,buff:I}),e.push({cmd:"CALL",fnName:w,params:[{var:0},{val:F},{var:1}]})),h&&e.push({cmd:"CALL",fnName:h,params:[{var:0},{val:F},{var:0}]}),e.push({cmd:"GET",out:0,var:0,len:F*f})):e.push({cmd:"GET",out:0,var:0,len:_*F}),v.push(o.queueAction(e).then((t=>(d&&d.debug(`${u}: fft ${y} mix end: ${a}/${E}`),t))))}x=await Promise.all(v);for(let t=0;t<E;t++)x[t]=x[t][0];for(let t=B+1;t<=y;t++){d&&d.debug(`${u}: fft  ${y}  join: ${t}/${y}`);const a=1<<y-t,e=E/a,n=[];for(let c=0;c<a;c++)for(let r=0;r<e/2;r++){const l=i.exp(i.w[t],r*F),s=i.w[t],g=c*e+r,p=c*e+r+e/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:x[g]}),m.push({cmd:"ALLOCSET",var:1,buff:x[p]}),m.push({cmd:"ALLOCSET",var:2,buff:l}),m.push({cmd:"ALLOCSET",var:3,buff:s}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:F},{var:2},{var:3}]}),t==y?(w&&(m.push({cmd:"ALLOCSET",var:4,buff:I}),m.push({cmd:"CALL",fnName:w,params:[{var:0},{val:F},{var:4}]}),m.push({cmd:"CALL",fnName:w,params:[{var:1},{val:F},{var:4}]})),h&&(m.push({cmd:"CALL",fnName:h,params:[{var:0},{val:F},{var:0}]}),m.push({cmd:"CALL",fnName:h,params:[{var:1},{val:F},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:F*f}),m.push({cmd:"GET",out:1,var:1,len:F*f})):(m.push({cmd:"GET",out:0,var:0,len:F*_}),m.push({cmd:"GET",out:1,var:1,len:F*_})),n.push(o.queueAction(m).then((i=>(d&&d.debug(`${u}: fft ${y} join  ${t}/${y}  ${c+1}/${a} ${r}/${e/2}`),i))))}const c=await Promise.all(n);for(let t=0;t<a;t++)for(let a=0;a<e/2;a++){const i=t*e+a,o=t*e+a+e/2,n=c.shift();x[i]=n[0],x[o]=n[1]}}if(C=t instanceof Pa?new Pa(b*f):new Uint8Array(b*f),r){C.set(x[0].slice((F-1)*f));let t=f;for(let a=E-1;a>0;a--)C.set(x[a],t),t+=F*f,delete x[a];C.set(x[0].slice(0,(F-1)*f),t),delete x[0]}else for(let t=0;t<E;t++)C.set(x[t],F*f*t),delete x[t];return A?va(C,f):C}async function c(t,n,c,r,l,s,d,u,g){let _,f,p,h,m,L;if("G1"==a)"affine"==s?(m=2*e.F.n8,f="g1m_batchToJacobian"):m=3*e.F.n8,L=3*e.F.n8,_="g1m_"+c,"affine"==d?(p="g1m_batchToAffine",h=2*e.F.n8):h=3*e.F.n8;else if("G2"==a)"affine"==s?(m=2*e.F.n8,f="g2m_batchToJacobian"):m=3*e.F.n8,_="g2m_"+c,L=3*e.F.n8,"affine"==d?(p="g2m_batchToAffine",h=2*e.F.n8):h=3*e.F.n8;else{if("Fr"!=a)throw new Error("Invalid group");m=i.n8,h=i.n8,L=i.n8,_="frm_"+c}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const w=Math.floor(t.byteLength/m);if(w!=1<<Fa(w))throw new Error("Invalid number of points");let A=Math.floor(w/o.concurrency);A<16&&(A=16),A>65536&&(A=65536);const b=[];for(let a=0;a<w;a+=A){u&&u.debug(`${g}: fftJoinExt Start: ${a}/${w}`);const e=Math.min(w-a,A),c=i.mul(r,i.exp(l,a)),s=[],d=t.slice(a*m,(a+e)*m),y=n.slice(a*m,(a+e)*m);s.push({cmd:"ALLOC",var:0,len:L*e}),s.push({cmd:"SET",var:0,buff:d}),s.push({cmd:"ALLOC",var:1,len:L*e}),s.push({cmd:"SET",var:1,buff:y}),s.push({cmd:"ALLOCSET",var:2,buff:c}),s.push({cmd:"ALLOCSET",var:3,buff:l}),f&&(s.push({cmd:"CALL",fnName:f,params:[{var:0},{val:e},{var:0}]}),s.push({cmd:"CALL",fnName:f,params:[{var:1},{val:e},{var:1}]})),s.push({cmd:"CALL",fnName:_,params:[{var:0},{var:1},{val:e},{var:2},{var:3},{val:i.s}]}),p&&(s.push({cmd:"CALL",fnName:p,params:[{var:0},{val:e},{var:0}]}),s.push({cmd:"CALL",fnName:p,params:[{var:1},{val:e},{var:1}]})),s.push({cmd:"GET",out:0,var:0,len:e*h}),s.push({cmd:"GET",out:1,var:1,len:e*h}),b.push(o.queueAction(s).then((t=>(u&&u.debug(`${g}: fftJoinExt End: ${a}/${w}`),t))))}const y=await Promise.all(b);let I,C;w*h>1<<28?(I=new Pa(w*h),C=new Pa(w*h)):(I=new Uint8Array(w*h),C=new Uint8Array(w*h));let x=0;for(let t=0;t<y.length;t++)I.set(y[t][0],x),C.set(y[t][1],x),x+=y[t][0].byteLength;return[I,C]}e.fft=async function(t,a,e,i,o){return await n(t,!1,a,e,i,o)},e.ifft=async function(t,a,e,i,o){return await n(t,!0,a,e,i,o)},e.lagrangeEvaluations=async function(t,o,r,l,s){let d;if(o=o||"affine",r=r||"affine","G1"==a)d="affine"==o?2*e.F.n8:3*e.F.n8;else if("G2"==a)d="affine"==o?2*e.F.n8:3*e.F.n8;else{if("Fr"!=a)throw new Error("Invalid group");d=i.n8}const u=t.byteLength/d,g=Fa(u);if(2**g*d!=t.byteLength)throw l&&l.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(g<=i.s)return await e.ifft(t,o,r,l,s);if(g>i.s+1)throw l&&l.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let _=t.slice(0,t.byteLength/2),f=t.slice(t.byteLength/2,t.byteLength);const p=i.exp(i.shift,u/2),h=i.inv(i.sub(i.one,p));[_,f]=await c(_,f,"prepareLagrangeEvaluation",h,i.shiftInv,o,"jacobian",l,s+" prep");const m=[];let L;return m.push(n(_,!0,"jacobian",r,l,s+" t0")),m.push(n(f,!0,"jacobian",r,l,s+" t1")),[_,f]=await Promise.all(m),L=_.byteLength>1<<28?new Pa(2*_.byteLength):new Uint8Array(2*_.byteLength),L.set(_),L.set(f,_.byteLength),L},e.fftMix=async function(t){const n=3*e.F.n8;let c,r;if("G1"==a)c="g1m_fftMix",r="g1m_fftJoin";else if("G2"==a)c="g2m_fftMix",r="g2m_fftJoin";else{if("Fr"!=a)throw new Error("Invalid group");c="frm_fftMix",r="frm_fftJoin"}const l=Math.floor(t.byteLength/n),s=Fa(l);let d=1<<Fa(o.concurrency);l<=2*d&&(d=1);const u=l/d,g=Fa(u),_=[];for(let a=0;a<d;a++){const e=[],i=t.slice(a*u*n,(a+1)*u*n);e.push({cmd:"ALLOCSET",var:0,buff:i});for(let t=1;t<=g;t++)e.push({cmd:"CALL",fnName:c,params:[{var:0},{val:u},{val:t}]});e.push({cmd:"GET",out:0,var:0,len:u*n}),_.push(o.queueAction(e))}const f=await Promise.all(_),p=[];for(let t=0;t<f.length;t++)p[t]=f[t][0];for(let t=g+1;t<=s;t++){const a=1<<s-t,e=d/a,c=[];for(let l=0;l<a;l++)for(let a=0;a<e/2;a++){const s=i.exp(i.w[t],a*u),d=i.w[t],g=l*e+a,_=l*e+a+e/2,f=[];f.push({cmd:"ALLOCSET",var:0,buff:p[g]}),f.push({cmd:"ALLOCSET",var:1,buff:p[_]}),f.push({cmd:"ALLOCSET",var:2,buff:s}),f.push({cmd:"ALLOCSET",var:3,buff:d}),f.push({cmd:"CALL",fnName:r,params:[{var:0},{var:1},{val:u},{var:2},{var:3}]}),f.push({cmd:"GET",out:0,var:0,len:u*n}),f.push({cmd:"GET",out:1,var:1,len:u*n}),c.push(o.queueAction(f))}const l=await Promise.all(c);for(let t=0;t<a;t++)for(let a=0;a<e/2;a++){const i=t*e+a,o=t*e+a+e/2,n=l.shift();p[i]=n[0],p[o]=n[1]}}let h;h=t instanceof Pa?new Pa(l*n):new Uint8Array(l*n);let m=0;for(let t=0;t<d;t++)h.set(p[t],m),m+=p[t].byteLength;return h},e.fftJoin=async function(t,n,c,r){const l=3*e.F.n8;let s;if("G1"==a)s="g1m_fftJoin";else if("G2"==a)s="g2m_fftJoin";else{if("Fr"!=a)throw new Error("Invalid group");s="frm_fftJoin"}if(t.byteLength!=n.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(t.byteLength/l);if(d!=1<<Fa(d))throw new Error("Invalid number of points");let u=1<<Fa(o.concurrency);d<=2*u&&(u=1);const g=d/u,_=[];for(let a=0;a<u;a++){const e=[],d=i.mul(c,i.exp(r,a*g)),u=t.slice(a*g*l,(a+1)*g*l),f=n.slice(a*g*l,(a+1)*g*l);e.push({cmd:"ALLOCSET",var:0,buff:u}),e.push({cmd:"ALLOCSET",var:1,buff:f}),e.push({cmd:"ALLOCSET",var:2,buff:d}),e.push({cmd:"ALLOCSET",var:3,buff:r}),e.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),e.push({cmd:"GET",out:0,var:0,len:g*l}),e.push({cmd:"GET",out:1,var:1,len:g*l}),_.push(o.queueAction(e))}const f=await Promise.all(_);let p,h;t instanceof Pa?(p=new Pa(d*l),h=new Pa(d*l)):(p=new Uint8Array(d*l),h=new Uint8Array(d*l));let m=0;for(let t=0;t<f.length;t++)p.set(f[t][0],m),h.set(f[t][1],m),m+=f[t][0].byteLength;return[p,h]},e.fftFinal=async function(t,i){const n=3*e.F.n8,c=2*e.F.n8;let r,l;if("G1"==a)r="g1m_fftFinal",l="g1m_batchToAffine";else{if("G2"!=a)throw new Error("Invalid group");r="g2m_fftFinal",l="g2m_batchToAffine"}const s=Math.floor(t.byteLength/n);if(s!=1<<Fa(s))throw new Error("Invalid number of points");const d=Math.floor(s/o.concurrency),u=[];for(let a=0;a<o.concurrency;a++){let e;if(e=a<o.concurrency-1?d:s-a*d,0==e)continue;const g=[],_=t.slice(a*d*n,(a*d+e)*n);g.push({cmd:"ALLOCSET",var:0,buff:_}),g.push({cmd:"ALLOCSET",var:1,buff:i}),g.push({cmd:"CALL",fnName:r,params:[{var:0},{val:e},{var:1}]}),g.push({cmd:"CALL",fnName:l,params:[{var:0},{val:e},{var:0}]}),g.push({cmd:"GET",out:0,var:0,len:e*c}),u.push(o.queueAction(g))}const g=await Promise.all(u);let _;_=t instanceof Pa?new Pa(s*c):new Uint8Array(s*c);let f=0;for(let t=g.length-1;t>=0;t--)_.set(g[t][0],f),f+=g[t][0].byteLength;return _}}async function Ya(t){const a=await async function(t,a){const e=new Ka;e.memory=new WebAssembly.Memory({initial:25}),e.u8=new Uint8Array(e.memory.buffer),e.u32=new Uint32Array(e.memory.buffer);const i=await WebAssembly.compile(t.code);if(e.instance=await WebAssembly.instantiate(i,{env:{memory:e.memory}}),e.singleThread=a,e.initalPFree=e.u32[0],e.pq=t.pq,e.pr=t.pr,e.pG1gen=t.pG1gen,e.pG1zero=t.pG1zero,e.pG2gen=t.pG2gen,e.pG2zero=t.pG2zero,e.pOneT=t.pOneT,a)e.code=t.code,e.taskManager=Ma(),await e.taskManager([{cmd:"INIT",init:25,code:e.code.slice()}]),e.concurrency=1;else{let a;e.workers=[],e.pendingDeferreds=[],e.working=[],a="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:Ta.cpus().length,0==a&&(a=2),a>64&&(a=64),e.concurrency=a;for(let t=0;t<a;t++)e.workers[t]=new ka(Na),e.workers[t].addEventListener("message",o(t)),e.working[t]=!1;const i=[];for(let a=0;a<e.workers.length;a++){const o=t.code.slice();i.push(e.postAction(a,[{cmd:"INIT",init:25,code:o}],[o.buffer]))}await Promise.all(i)}return e;function o(t){return function(a){let i;i=a&&a.data?a.data:a,e.working[t]=!1,e.pendingDeferreds[t].resolve(i),e.processWorks()}}}(t.wasm,t.singleThread),e={};return e.q=i(t.wasm.q.toString()),e.r=i(t.wasm.r.toString()),e.name=t.name,e.tm=a,e.prePSize=t.wasm.prePSize,e.preQSize=t.wasm.preQSize,e.Fr=new Oa(a,"frm",t.n8r,t.r),e.F1=new Oa(a,"f1m",t.n8q,t.q),e.F2=new za(a,"f2m",e.F1),e.G1=new qa(a,"g1m",e.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),e.G2=new qa(a,"g2m",e.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),e.F6=new Qa(a,"f6m",e.F2),e.F12=new za(a,"ftm",e.F6),e.Gt=e.F12,Va(e,"G1"),Va(e,"G2"),Va(e,"Fr"),Ha(e,"G1"),Ha(e,"G2"),$a(e,"G1"),$a(e,"G2"),$a(e,"Fr"),function(t){const a=t.tm;t.pairing=function(e,i){a.startSyncOp();const o=a.allocBuff(t.G1.toJacobian(e)),n=a.allocBuff(t.G2.toJacobian(i)),c=a.alloc(t.Gt.n8);a.instance.exports[t.name+"_pairing"](o,n,c);const r=a.getBuff(c,t.Gt.n8);return a.endSyncOp(),r},t.pairingEq=async function(){let e,i;arguments.length%2==1?(e=arguments[arguments.length-1],i=(arguments.length-1)/2):(e=t.Gt.one,i=arguments.length/2);const o=[];for(let e=0;e<i;e++){const i=[],n=t.G1.toJacobian(arguments[2*e]);i.push({cmd:"ALLOCSET",var:0,buff:n}),i.push({cmd:"ALLOC",var:1,len:t.prePSize});const c=t.G2.toJacobian(arguments[2*e+1]);i.push({cmd:"ALLOCSET",var:2,buff:c}),i.push({cmd:"ALLOC",var:3,len:t.preQSize}),i.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),i.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),i.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),i.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),i.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),o.push(a.queueAction(i))}const n=await Promise.all(o);a.startSyncOp();const c=a.alloc(t.Gt.n8);a.instance.exports.ftm_one(c);for(let t=0;t<n.length;t++){const e=a.allocBuff(n[t][0]);a.instance.exports.ftm_mul(c,e,c)}a.instance.exports[t.name+"_finalExponentiation"](c,c);const r=a.allocBuff(e),l=!!a.instance.exports.ftm_eq(c,r);return a.endSyncOp(),l},t.prepareG1=function(t){this.tm.startSyncOp();const a=this.tm.allocBuff(t),e=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](a,e);const i=this.tm.getBuff(e,this.prePSize);return this.tm.endSyncOp(),i},t.prepareG2=function(t){this.tm.startSyncOp();const a=this.tm.allocBuff(t),e=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](a,e);const i=this.tm.getBuff(e,this.preQSize);return this.tm.endSyncOp(),i},t.millerLoop=function(t,a){this.tm.startSyncOp();const e=this.tm.allocBuff(t),i=this.tm.allocBuff(a),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](e,i,o);const n=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),n},t.finalExponentiation=function(t){this.tm.startSyncOp();const a=this.tm.allocBuff(t),e=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](a,e);const i=this.tm.getBuff(e,this.Gt.n8);return this.tm.endSyncOp(),i}}(e),e.array2buffer=function(t,a){const e=new Uint8Array(a*t.length);for(let i=0;i<t.length;i++)e.set(t[i],i*a);return e},e.buffer2array=function(t,a){const e=t.byteLength/a,i=new Array(e);for(let o=0;o<e;o++)i[o]=t.slice(o*a,o*a+a);return i},e}function Wa(t){return BigInt(t)}function Za(t){return t<0n}function Ja(t){return 0n===t}function Xa(t){const a=[],e=Wa(t);return a.push(Number(0xFFn&e)),a.push(Number(e>>8n&0xFFn)),a.push(Number(e>>16n&0xFFn)),a.push(Number(e>>24n&0xFFn)),a}function te(t){const a=function(t){for(var a=[],e=0;e<t.length;e++){var i=t.charCodeAt(e);i<128?a.push(i):i<2048?a.push(192|i>>6,128|63&i):i<55296||i>=57344?a.push(224|i>>12,128|i>>6&63,128|63&i):(e++,i=65536+((1023&i)<<10|1023&t.charCodeAt(e)),a.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return a}(t);return[...ne(a.length),...a]}function ae(t){const a=[];let e=Wa(t);if(Za(e))throw new Error("Number cannot be negative");for(;!Ja(e);)a.push(Number(0x7Fn&e)),e>>=7n;0==a.length&&a.push(0);for(let t=0;t<a.length-1;t++)a[t]=128|a[t];return a}function ee(t){let a,e;const i=function(t){return Za(t)?t.toString(2).length-1:t.toString(2).length}(t);t<0?(e=!0,a=(1n<<BigInt(i))+t):(e=!1,a=Wa(t));const o=7-i%7,n=(1<<7-o)-1|128,c=ae(a+((1n<<BigInt(o))-1n<<BigInt(i)));return e||(c[c.length-1]=c[c.length-1]&n),c}function ie(t){let a=Wa(t);if(a>0xFFFFFFFFn)throw new Error("Number too big");if(a>0x7FFFFFFFn&&(a-=0x100000000n),a<-2147483648n)throw new Error("Number too small");return ee(a)}function oe(t){let a=Wa(t);if(a>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(a>0x7FFFFFFFFFFFFFFFn&&(a-=0x10000000000000000n),a<-9223372036854775808n)throw new Error("Number too small");return ee(a)}function ne(t){let a=Wa(t);if(a>0xFFFFFFFFn)throw new Error("Number too big");return ae(a)}function ce(t){return Array.from(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}class re{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,a){const e=this.func.localIdxByName[t];if(void 0===e)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...a,33,...ne(e)]}teeLocal(t,a){const e=this.func.localIdxByName[t];if(void 0===e)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...a,34,...ne(e)]}getLocal(t){const a=this.func.localIdxByName[t];if(void 0===a)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...ne(a)]}i64_load8_s(t,a,e){return[...t,48,void 0===e?0:e,...ne(a||0)]}i64_load8_u(t,a,e){return[...t,49,void 0===e?0:e,...ne(a||0)]}i64_load16_s(t,a,e){return[...t,50,void 0===e?1:e,...ne(a||0)]}i64_load16_u(t,a,e){return[...t,51,void 0===e?1:e,...ne(a||0)]}i64_load32_s(t,a,e){return[...t,52,void 0===e?2:e,...ne(a||0)]}i64_load32_u(t,a,e){return[...t,53,void 0===e?2:e,...ne(a||0)]}i64_load(t,a,e){return[...t,41,void 0===e?3:e,...ne(a||0)]}i64_store(t,a,e,i){let o,n,c;return Array.isArray(a)?(o=0,n=3,c=a):Array.isArray(e)?(o=a,n=3,c=e):Array.isArray(i)&&(o=a,n=e,c=i),[...t,...c,55,n,...ne(o)]}i64_store32(t,a,e,i){let o,n,c;return Array.isArray(a)?(o=0,n=2,c=a):Array.isArray(e)?(o=a,n=2,c=e):Array.isArray(i)&&(o=a,n=e,c=i),[...t,...c,62,n,...ne(o)]}i64_store16(t,a,e,i){let o,n,c;return Array.isArray(a)?(o=0,n=1,c=a):Array.isArray(e)?(o=a,n=1,c=e):Array.isArray(i)&&(o=a,n=e,c=i),[...t,...c,61,n,...ne(o)]}i64_store8(t,a,e,i){let o,n,c;return Array.isArray(a)?(o=0,n=0,c=a):Array.isArray(e)?(o=a,n=0,c=e):Array.isArray(i)&&(o=a,n=e,c=i),[...t,...c,60,n,...ne(o)]}i32_load8_s(t,a,e){return[...t,44,void 0===e?0:e,...ne(a||0)]}i32_load8_u(t,a,e){return[...t,45,void 0===e?0:e,...ne(a||0)]}i32_load16_s(t,a,e){return[...t,46,void 0===e?1:e,...ne(a||0)]}i32_load16_u(t,a,e){return[...t,47,void 0===e?1:e,...ne(a||0)]}i32_load(t,a,e){return[...t,40,void 0===e?2:e,...ne(a||0)]}i32_store(t,a,e,i){let o,n,c;return Array.isArray(a)?(o=0,n=2,c=a):Array.isArray(e)?(o=a,n=2,c=e):Array.isArray(i)&&(o=a,n=e,c=i),[...t,...c,54,n,...ne(o)]}i32_store16(t,a,e,i){let o,n,c;return Array.isArray(a)?(o=0,n=1,c=a):Array.isArray(e)?(o=a,n=1,c=e):Array.isArray(i)&&(o=a,n=e,c=i),[...t,...c,59,n,...ne(o)]}i32_store8(t,a,e,i){let o,n,c;return Array.isArray(a)?(o=0,n=0,c=a):Array.isArray(e)?(o=a,n=0,c=e):Array.isArray(i)&&(o=a,n=e,c=i),[...t,...c,58,n,...ne(o)]}call(t,...a){const e=this.module.functionIdxByName[t];if(void 0===e)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...a),16,...ne(e)]}call_indirect(t,...a){return[...[].concat(...a),...t,17,0,0]}if(t,a,e){return e?[...t,4,64,...a,5,...e,11]:[...t,4,64,...a,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,a){return[...a,13,...ne(t)]}br(t){return[12,...ne(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...oe(t)]}i32_const(t){return[65,...ie(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,a){return[...t,...a,81]}i64_ne(t,a){return[...t,...a,82]}i64_lt_s(t,a){return[...t,...a,83]}i64_lt_u(t,a){return[...t,...a,84]}i64_gt_s(t,a){return[...t,...a,85]}i64_gt_u(t,a){return[...t,...a,86]}i64_le_s(t,a){return[...t,...a,87]}i64_le_u(t,a){return[...t,...a,88]}i64_ge_s(t,a){return[...t,...a,89]}i64_ge_u(t,a){return[...t,...a,90]}i64_add(t,a){return[...t,...a,124]}i64_sub(t,a){return[...t,...a,125]}i64_mul(t,a){return[...t,...a,126]}i64_div_s(t,a){return[...t,...a,127]}i64_div_u(t,a){return[...t,...a,128]}i64_rem_s(t,a){return[...t,...a,129]}i64_rem_u(t,a){return[...t,...a,130]}i64_and(t,a){return[...t,...a,131]}i64_or(t,a){return[...t,...a,132]}i64_xor(t,a){return[...t,...a,133]}i64_shl(t,a){return[...t,...a,134]}i64_shr_s(t,a){return[...t,...a,135]}i64_shr_u(t,a){return[...t,...a,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,a){return[...t,...a,70]}i32_ne(t,a){return[...t,...a,71]}i32_lt_s(t,a){return[...t,...a,72]}i32_lt_u(t,a){return[...t,...a,73]}i32_gt_s(t,a){return[...t,...a,74]}i32_gt_u(t,a){return[...t,...a,75]}i32_le_s(t,a){return[...t,...a,76]}i32_le_u(t,a){return[...t,...a,77]}i32_ge_s(t,a){return[...t,...a,78]}i32_ge_u(t,a){return[...t,...a,79]}i32_add(t,a){return[...t,...a,106]}i32_sub(t,a){return[...t,...a,107]}i32_mul(t,a){return[...t,...a,108]}i32_div_s(t,a){return[...t,...a,109]}i32_div_u(t,a){return[...t,...a,110]}i32_rem_s(t,a){return[...t,...a,111]}i32_rem_u(t,a){return[...t,...a,112]}i32_and(t,a){return[...t,...a,113]}i32_or(t,a){return[...t,...a,114]}i32_xor(t,a){return[...t,...a,115]}i32_shl(t,a){return[...t,...a,116]}i32_shr_s(t,a){return[...t,...a,117]}i32_shr_u(t,a){return[...t,...a,118]}i32_rotl(t,a){return[...t,...a,119]}i32_rotr(t,a){return[...t,...a,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const le={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class se{constructor(t,a,e,i,o){if("import"==e)this.fnType="import",this.moduleName=i,this.fieldName=o;else{if("internal"!=e)throw new Error("Invalid function fnType: "+e);this.fnType="internal"}this.module=t,this.fnName=a,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,a){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const e=this.nextLocal++;this.localIdxByName[t]=e,this.params.push({type:a})}addLocal(t,a,e){const i=e||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const o=this.nextLocal++;this.localIdxByName[t]=o,this.locals.push({type:a,length:i})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){return[96,...[...ne(this.params.length),...this.params.map((t=>le[t.type]))],...this.returnType?[1,le[this.returnType]]:[0]]}getBody(){const t=this.locals.map((t=>[...ne(t.length),le[t.type]])),a=[...ne(this.locals.length),...[].concat(...t),...this.code,11];return[...ne(a.length),...a]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new re(this)}}class de{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Xa(1836278016),...Xa(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);const a=this.functions.length;return this.functionIdxByName[t]=a,this.functions.push(new se(this,t,"internal")),this.nInternalFunctions++,this.functions[a]}addIimportFunction(t,a,e){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw new Error(`Import functions must be declared before internal: ${t}`);let i=e||t;const o=this.functions.length;return this.functionIdxByName[t]=o,this.functions.push(new se(this,t,"import",a,i)),this.nImportFunctions++,this.functions[o]}setMemory(t,a,e){this.memory={pagesSize:t,moduleName:a||"env",fieldName:e||"memory"}}exportFunction(t,a){const e=a||t;if(void 0===this.functionIdxByName[t])throw new Error(`Function not defined: ${t}`);const i=this.functionIdxByName[t];e!=t&&(this.functionIdxByName[e]=i),this.exports.push({exportName:e,idx:i})}addFunctionToTable(t){const a=this.functionIdxByName[t];this.functionsTable.push(a)}addData(t,a){this.datas.push({offset:t,bytes:a})}alloc(t,a){let e,i;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===a?(e=t.length,i=t):(e=t,i=a),e=1+(e-1>>3)<<3;const o=this.free;return this.free+=e,i&&this.addData(o,i),o}allocString(t){const a=(new globalThis.TextEncoder).encode(t);return this.alloc([...a,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const a=this.functions[this.functionsTable[0]].getSignature();t["s_"+ce(a)]=0,this.signatures.push(a)}for(let a=0;a<this.functions.length;a++){const e=this.functions[a].getSignature(),i="s_"+ce(e);void 0===t[i]&&(t[i]=this.signatures.length,this.signatures.push(e)),this.functions[a].signatureIdx=t[i]}}_buildSection(t,a){return[t,...ne(a.length),...a]}_buildType(){return this._buildSection(1,[...ne(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...te(this.memory.moduleName),...te(this.memory.fieldName),2,0,...ne(this.memory.pagesSize)]);for(let a=0;a<this.nImportFunctions;a++)t.push([...te(this.functions[a].moduleName),...te(this.functions[a].fieldName),0,...ne(this.functions[a].signatureIdx)]);return this._buildSection(2,ne(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let a=this.nImportFunctions;a<this.nImportFunctions+this.nInternalFunctions;a++)t.push(...ne(this.functions[a].signatureIdx));return this._buildSection(3,[...ne(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...ne(1),112,0,...ne(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];const t=[];for(let a=0;a<this.functionsTable.length;a++)t.push(...ne(this.functionsTable[a]));return this._buildSection(9,[...ne(1),...ne(0),65,...ie(0),11,...ne(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let a=0;a<this.exports.length;a++)t.push([...te(this.exports[a].exportName),0,...ne(this.exports[a].idx)]);return this._buildSection(7,ne(t.length).concat(...t))}_buildCode(){const t=[];for(let a=this.nImportFunctions;a<this.nImportFunctions+this.nInternalFunctions;a++)t.push(this.functions[a].getBody());return this._buildSection(10,ne(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Xa(this.free)]);for(let a=0;a<this.datas.length;a++)t.push([0,65,...ie(this.datas[a].offset),11,...ne(this.datas[a].bytes.length),...this.datas[a].bytes]);return this._buildSection(11,ne(t.length).concat(...t))}}async function ue(t,a){const e=new de;e.setMemory(25),Aa(e),a&&a(e);const o={};if(o.code=e.build(),o.pq=e.modules.f1m.pq,o.pr=e.modules.frm.pq,o.pG1gen=e.modules.bn128.pG1gen,o.pG1zero=e.modules.bn128.pG1zero,o.pG1b=e.modules.bn128.pG1b,o.pG2gen=e.modules.bn128.pG2gen,o.pG2zero=e.modules.bn128.pG2zero,o.pG2b=e.modules.bn128.pG2b,o.pOneT=e.modules.bn128.pOneT,o.prePSize=e.modules.bn128.prePSize,o.preQSize=e.modules.bn128.preQSize,o.n8q=32,o.n8r=32,o.q=e.modules.bn128.q,o.r=e.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const n={name:"bn128",wasm:o,q:i("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:i("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:i("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},c=await Ya(n);return c.terminate=async function(){n.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=c),c}async function ge(t,a){const e=new de;e.setMemory(25),ba(e),a&&a(e);const o={};if(o.code=e.build(),o.pq=e.modules.f1m.pq,o.pr=e.modules.frm.pq,o.pG1gen=e.modules.bls12381.pG1gen,o.pG1zero=e.modules.bls12381.pG1zero,o.pG1b=e.modules.bls12381.pG1b,o.pG2gen=e.modules.bls12381.pG2gen,o.pG2zero=e.modules.bls12381.pG2zero,o.pG2b=e.modules.bls12381.pG2b,o.pOneT=e.modules.bls12381.pOneT,o.prePSize=e.modules.bls12381.prePSize,o.preQSize=e.modules.bls12381.preQSize,o.n8q=48,o.n8r=32,o.q=e.modules.bls12381.q,o.r=e.modules.bls12381.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const n={name:"bls12381",wasm:o,q:i("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:i("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:i("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:i("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},c=await Ya(n);return c.terminate=async function(){n.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=c),c}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;const _e=i("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),fe=i("21888242871839275222246405745257275088548364400416034343698204186575808495617");i("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),i("21888242871839275222246405745257275088696311157297823662689037894645226208583");const pe=U,he=Sa;var me={};async function Le(t,a,e,i){if(e=e||262144,"number"!=typeof a&&["w+","wx+","r","ax+","a+"].indexOf(a)<0)throw new Error("Invalid open option");const o=await me.promises.open(t,a),n=await o.stat();return new we(o,n,e,i,t)}class we{constructor(t,a,e,i,o){for(this.fileName=o,this.fd=t,this.pos=0,this.pageSize=i||256;this.pageSize<a.blksize;)this.pageSize*=2;this.totalSize=a.size,this.totalPages=Math.floor((a.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(e/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const a=this,e=new Promise(((e,i)=>{a.pendingLoads.push({page:t,resolve:e,reject:i})}));return a.__statusPage("After Load request: ",t),e}__statusPage(t,a){const e=[],i=this;if(!i.logHistory)return;e.push("=="+t+" "+a);let o="";for(let t=0;t<i.pendingLoads.length;t++)i.pendingLoads[t].page==a&&(o=o+" "+t);if(o&&e.push("Pending loads:"+o),void 0!==i.pages[a]){const t=i.pages[a];e.push("Loaded"),e.push("pendingOps: "+t.pendingOps),t.loading&&e.push("loading: "+t.loading),t.writing&&e.push("writing"),t.dirty&&e.push("dirty")}e.push("=="),i.history[a]||(i.history[a]=[]),i.history[a].push(e)}__printHistory(t){const a=this;a.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let e=0;e<a.history[t].length;e++)for(let i=0;i<a.history[t][e].length;i++)console.log("-> "+a.history[t][e][i])}_triggerLoad(){const t=this;if(t.reading)return;if(0==t.pendingLoads.length)return;const a=Object.keys(t.pages),e=[];for(let i=0;i<a.length;i++){const o=t.pages[parseInt(a[i])];0!=o.dirty||0!=o.pendingOps||o.writing||o.loading||e.push(parseInt(a[i]))}let i=t.maxPagesLoaded-a.length;const o=[];for(;t.pendingLoads.length>0&&(void 0!==t.pages[t.pendingLoads[0].page]||i>0||e.length>0);){const a=t.pendingLoads.shift();if(void 0!==t.pages[a.page]){t.pages[a.page].pendingOps++;const i=e.indexOf(a.page);i>=0&&e.splice(i,1),t.pages[a.page].loading?t.pages[a.page].loading.push(a):a.resolve(),t.__statusPage("After Load (cached): ",a.page)}else{if(i)i--;else{const a=e.shift();t.__statusPage("Before Unload: ",a),t.avBuffs.unshift(t.pages[a]),delete t.pages[a],t.__statusPage("After Unload: ",a)}a.page>=t.totalPages?(t.pages[a.page]=n(),a.resolve(),t.__statusPage("After Load (new): ",a.page)):(t.reading=!0,t.pages[a.page]=n(),t.pages[a.page].loading=[a],o.push(t.fd.read(t.pages[a.page].buff,0,t.pageSize,a.page*t.pageSize).then((e=>{t.pages[a.page].size=e.bytesRead;const i=t.pages[a.page].loading;delete t.pages[a.page].loading;for(let t=0;t<i.length;t++)i[t].resolve();return t.__statusPage("After Load (loaded): ",a.page),e}),(t=>{a.reject(t)}))),t.__statusPage("After Load (loading): ",a.page))}}function n(){if(t.avBuffs.length>0){const a=t.avBuffs.shift();return a.dirty=!1,a.pendingOps=1,a.size=0,a}return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}Promise.all(o).then((()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()}))}_triggerWrite(){const t=this;if(t.writing)return;const a=Object.keys(t.pages),e=[];for(let i=0;i<a.length;i++){const o=t.pages[parseInt(a[i])];o.dirty&&(o.dirty=!1,o.writing=!0,t.writing=!0,e.push(t.fd.write(o.buff,0,o.size,parseInt(a[i])*t.pageSize).then((()=>{o.writing=!1}),(a=>{console.log("ERROR Writing: "+a),t.error=a,t._tryClose()}))))}t.writing&&Promise.all(e).then((()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))}))}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,a){if(0==t.byteLength)return;const e=this;if(void 0===a&&(a=e.pos),e.pos=a+t.byteLength,e.totalSize<a+t.byteLength&&(e.totalSize=a+t.byteLength),e.pendingClose)throw new Error("Writing a closing file");const i=Math.floor(a/e.pageSize),o=Math.floor((a+t.byteLength-1)/e.pageSize),n=[];for(let t=i;t<=o;t++)n.push(e._loadPage(t));e._triggerLoad();let c=i,r=a%e.pageSize,l=t.byteLength;for(;l>0;){await n[c-i];const a=r+l>e.pageSize?e.pageSize-r:l,o=t.slice(t.byteLength-l,t.byteLength-l+a);new Uint8Array(e.pages[c].buff.buffer,r,a).set(o),e.pages[c].dirty=!0,e.pages[c].pendingOps--,e.pages[c].size=Math.max(r+a,e.pages[c].size),c>=e.totalPages&&(e.totalPages=c+1),l-=a,c++,r=0,e.writing||setImmediate(e._triggerWrite.bind(e))}}async read(t,a){let e=new Uint8Array(t);return await this.readToBuffer(e,0,t,a),e}async readToBuffer(t,a,e,i){if(0==e)return;const o=this;if(e>o.pageSize*o.maxPagesLoaded*.8){const t=Math.floor(1.1*e);this.maxPagesLoaded=Math.floor(t/o.pageSize)+1}if(void 0===i&&(i=o.pos),o.pos=i+e,o.pendingClose)throw new Error("Reading a closing file");const n=Math.floor(i/o.pageSize),c=Math.floor((i+e-1)/o.pageSize),r=[];for(let t=n;t<=c;t++)r.push(o._loadPage(t));o._triggerLoad();let l=n,s=i%o.pageSize,d=i+e>o.totalSize?e-(i+e-o.totalSize):e;for(;d>0;){await r[l-n],o.__statusPage("After Await (read): ",l);const i=s+d>o.pageSize?o.pageSize-s:d,c=new Uint8Array(o.pages[l].buff.buffer,o.pages[l].buff.byteOffset+s,i);t.set(c,a+e-d),o.pages[l].pendingOps--,o.__statusPage("After Op done: ",l),d-=i,l++,s=0,o.pendingLoads.length>0&&setImmediate(o._triggerLoad.bind(o))}this.pos=i+e}_tryClose(){const t=this;if(!t.pendingClose)return;t.error&&t.pendingCloseReject(t.error);t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise(((a,e)=>{t.pendingClose=a,t.pendingCloseReject=e,t._tryClose()})).then((()=>{t.fd.close()}),(a=>{throw t.fd.close(),a}))}async discard(){await this.close(),await me.promises.unlink(this.fileName)}async writeULE32(t,a){const e=new Uint8Array(4);new DataView(e.buffer).setUint32(0,t,!0),await this.write(e,a)}async writeUBE32(t,a){const e=new Uint8Array(4);new DataView(e.buffer).setUint32(0,t,!1),await this.write(e,a)}async writeULE64(t,a){const e=new Uint8Array(8),i=new DataView(e.buffer);i.setUint32(0,4294967295&t,!0),i.setUint32(4,Math.floor(t/4294967296),!0),await this.write(e,a)}async readULE32(t){const a=await this.read(4,t);return new Uint32Array(a.buffer)[0]}async readUBE32(t){const a=await this.read(4,t);return new DataView(a.buffer).getUint32(0,!1)}async readULE64(t){const a=await this.read(8,t),e=new Uint32Array(a.buffer);return 4294967296*e[1]+e[0]}async readString(t){const a=this;if(a.pendingClose)throw new Error("Reading a closing file");let e=void 0===t?a.pos:t,i=Math.floor(e/a.pageSize),o=!1,n="";for(;!o;){let t=a._loadPage(i);a._triggerLoad(),await t,a.__statusPage("After Await (read): ",i);let c=e%a.pageSize;const r=new Uint8Array(a.pages[i].buff.buffer,a.pages[i].buff.byteOffset+c,a.pageSize-c);let l=r.findIndex((t=>0===t));o=-1!==l,o?(n+=(new TextDecoder).decode(r.slice(0,l)),a.pos=i*this.pageSize+c+l+1):(n+=(new TextDecoder).decode(r),a.pos=i*this.pageSize+c+r.length),a.pages[i].pendingOps--,a.__statusPage("After Op done: ",i),e=a.pos,i++,a.pendingLoads.length>0&&setImmediate(a._triggerLoad.bind(a))}return n}}const Ae=new Uint8Array(4),be=new DataView(Ae.buffer),ye=new Uint8Array(8),Ie=new DataView(ye.buffer);class Ce{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const a=Math.max(this.allocSize+(1<<20),Math.floor(1.1*this.allocSize),t),e=new Uint8Array(a);e.set(this.o.data),this.o.data=e,this.allocSize=a}}async write(t,a){if(void 0===a&&(a=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(a+t.byteLength),this.o.data.set(t.slice(),a),a+t.byteLength>this.totalSize&&(this.totalSize=a+t.byteLength),this.pos=a+t.byteLength}async readToBuffer(t,a,e,i){if(void 0===i&&(i=this.pos),this.readOnly&&i+e>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+e);const o=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+i,e);t.set(o,a),this.pos=i+e}async read(t,a){const e=new Uint8Array(t);return await this.readToBuffer(e,0,t,a),e}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,a){be.setUint32(0,t,!0),await this.write(Ae,a)}async writeUBE32(t,a){be.setUint32(0,t,!1),await this.write(Ae,a)}async writeULE64(t,a){Ie.setUint32(0,4294967295&t,!0),Ie.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ye,a)}async readULE32(t){const a=await this.read(4,t);return new Uint32Array(a.buffer)[0]}async readUBE32(t){const a=await this.read(4,t);return new DataView(a.buffer).getUint32(0,!1)}async readULE64(t){const a=await this.read(8,t),e=new Uint32Array(a.buffer);return 4294967296*e[1]+e[0]}async readString(t){const a=this;let e=void 0===t?a.pos:t;if(e>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}const i=new Uint8Array(a.o.data.buffer,e,this.totalSize-e);let o=i.findIndex((t=>0===t)),n="";return-1!==o?(n=(new TextDecoder).decode(i.slice(0,o)),a.pos=e+o+1):a.pos=e,n}}const xe=1<<22;const Fe=new Uint8Array(4),Ee=new DataView(Fe.buffer),Be=new Uint8Array(8),ve=new DataView(Be.buffer);class Se{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const a=Math.floor((t-1)/xe)+1;for(let e=Math.max(this.o.data.length-1,0);e<a;e++){const i=new Uint8Array(e<a-1?xe:t-(a-1)*xe);e==this.o.data.length-1&&i.set(this.o.data[e]),this.o.data[e]=i}this.totalSize=t}async write(t,a){const e=this;if(void 0===a&&(a=e.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(a+t.byteLength);let i=Math.floor(a/xe),o=a%xe,n=t.byteLength;for(;n>0;){const a=o+n>xe?xe-o:n,c=t.slice(t.byteLength-n,t.byteLength-n+a);new Uint8Array(e.o.data[i].buffer,o,a).set(c),n-=a,i++,o=0}this.pos=a+t.byteLength}async readToBuffer(t,a,e,i){const o=this;if(void 0===i&&(i=o.pos),this.readOnly&&i+e>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+e);let n=Math.floor(i/xe),c=i%xe,r=e;for(;r>0;){const i=c+r>xe?xe-c:r,l=new Uint8Array(o.o.data[n].buffer,c,i);t.set(l,a+e-r),r-=i,n++,c=0}this.pos=i+e}async read(t,a){const e=new Uint8Array(t);return await this.readToBuffer(e,0,t,a),e}close(){}async discard(){}async writeULE32(t,a){Ee.setUint32(0,t,!0),await this.write(Fe,a)}async writeUBE32(t,a){Ee.setUint32(0,t,!1),await this.write(Fe,a)}async writeULE64(t,a){ve.setUint32(0,4294967295&t,!0),ve.setUint32(4,Math.floor(t/4294967296),!0),await this.write(Be,a)}async readULE32(t){const a=await this.read(4,t);return new Uint32Array(a.buffer)[0]}async readUBE32(t){const a=await this.read(4,t);return new DataView(a.buffer).getUint32(0,!1)}async readULE64(t){const a=await this.read(8,t),e=new Uint32Array(a.buffer);return 4294967296*e[1]+e[0]}async readString(t){const a=this;let e=void 0===t?a.pos:t;if(e>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let i=!1,o="";for(;!i;){let t=Math.floor(e/xe),n=e%xe;if(void 0===a.o.data[t])throw new Error("ERROR");let c=Math.min(2048,a.o.data[t].length-n);const r=new Uint8Array(a.o.data[t].buffer,n,c);let l=r.findIndex((t=>0===t));i=-1!==l,i?(o+=(new TextDecoder).decode(r.slice(0,l)),a.pos=t*xe+n+l+1):(o+=(new TextDecoder).decode(r),a.pos=t*xe+n+r.length),e=a.pos}return o}}async function Ge(t,a,e){if("string"==typeof t&&(t={type:"file",fileName:t,cacheSize:a||65536,pageSize:e||8192}),"file"==t.type)return await Le(t.fileName,578,t.cacheSize,t.pageSize);if("mem"==t.type)return function(t){const a=t.initialSize||1<<20,e=new Ce;return e.o=t,e.o.data=new Uint8Array(a),e.allocSize=a,e.totalSize=0,e.readOnly=!1,e.pos=0,e}(t);if("bigMem"==t.type)return function(t){const a=t.initialSize||0,e=new Se;e.o=t;const i=a?Math.floor((a-1)/xe)+1:0;e.o.data=[];for(let t=0;t<i-1;t++)e.o.data.push(new Uint8Array(xe));return i&&e.o.data.push(new Uint8Array(a-xe*(i-1))),e.totalSize=0,e.readOnly=!1,e.pos=0,e}(t);throw new Error("Invalid FastFile type: "+t.type)}async function Pe(t,a,e){if(t instanceof Uint8Array&&(t={type:"mem",data:t}),"string"==typeof t){t={type:"mem",data:await fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return new Uint8Array(t)}))}}if("file"==t.type)return await Le(t.fileName,0,t.cacheSize,t.pageSize);if("mem"==t.type)return await function(t){const a=new Ce;return a.o=t,a.allocSize=t.data.byteLength,a.totalSize=t.data.byteLength,a.readOnly=!0,a.pos=0,a}(t);if("bigMem"==t.type)return await function(t){const a=new Se;return a.o=t,a.totalSize=(t.data.length-1)*xe+t.data[t.data.length-1].byteLength,a.readOnly=!0,a.pos=0,a}(t);throw new Error("Invalid FastFile type: "+t.type)}async function Ue(t,a,e,i,o){const n=await Pe(t),c=await n.read(4);let r="";for(let t=0;t<4;t++)r+=String.fromCharCode(c[t]);if(r!=a)throw new Error(t+": Invalid File format");if(await n.readULE32()>e)throw new Error("Version not supported");const l=await n.readULE32();let s=[];for(let t=0;t<l;t++){let t=await n.readULE32(),a=await n.readULE64();void 0===s[t]&&(s[t]=[]),s[t].push({p:n.pos,size:a}),n.pos+=a}return{fd:n,sections:s}}async function Oe(t,a,e,i,o,n){const c=await Ge(t,o,n),r=new Uint8Array(4);for(let t=0;t<4;t++)r[t]=a.charCodeAt(t);return await c.write(r,0),await c.writeULE32(e),await c.writeULE32(i),c}async function ze(t,a){if(void 0!==t.writingSection)throw new Error("Already writing a section");await t.writeULE32(a),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function Qe(t){if(void 0===t.writingSection)throw new Error("Not writing a section");const a=t.pos-t.writingSection.pSectionSize-8,e=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(a),t.pos=e,delete t.writingSection}async function qe(t,a,e){if(void 0!==t.readingSection)throw new Error("Already reading a section");if(!a[e])throw new Error(t.fileName+": Missing section "+e);if(a[e].length>1)throw new Error(t.fileName+": Section Duplicated "+e);t.pos=a[e][0].p,t.readingSection=a[e][0]}async function Me(t,a){if(void 0===t.readingSection)throw new Error("Not reading a section");if(!a&&t.pos-t.readingSection.p!=t.readingSection.size)throw new Error("Invalid section size reading");delete t.readingSection}async function Te(t,a,e,i){const o=new Uint8Array(e);pe.toRprLE(o,0,a,e),await t.write(o,i)}async function ke(t,a,e){const i=await t.read(a,e);return pe.fromRprLE(i,0,a)}async function Re(t,a,e,i,o){void 0===o&&(o=a[i][0].size);const n=t.pageSize;await qe(t,a,i),await ze(e,i);for(let a=0;a<o;a+=n){const i=Math.min(o-a,n),c=await t.read(i);await e.write(c)}await Qe(e),await Me(t,o!=a[i][0].size)}async function De(t,a,e,i,o){if((i=void 0===i?0:i)+(o=void 0===o?a[e][0].size-i:o)>a[e][0].size)throw new Error("Reading out of the range of the section");let n;return n=o<1<<30?new Uint8Array(o):new Pa(o),await t.readToBuffer(n,0,o,a[e][0].p+i),n}async function Ne(t,a,e,i,o){const n=16*t.pageSize;if(await qe(t,a,o),await qe(e,i,o),a[o][0].size!=i[o][0].size)return!1;const c=a[o][0].size;for(let a=0;a<c;a+=n){const i=Math.min(c-a,n),o=await t.read(i),r=await e.read(i);for(let t=0;t<i;t++)if(o[t]!=r[t])return!1}return await Me(t),await Me(e),!0}pe.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),pe.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const Ke=pe.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),Ve=pe.e("21888242871839275222246405745257275088696311157297823662689037894645226208583"),je=!0;async function He(t){let a;if(pe.eq(t,Ve))a=await ue(je);else{if(!pe.eq(t,Ke))throw new Error(`Curve not supported: ${pe.toString(t)}`);a=await ge(je)}return a}async function $e(t){let a;const e=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(e)>=0)a=await ue(je);else{if(!(["BLS12381"].indexOf(e)>=0))throw new Error(`Curve not supported: ${t}`);a=await ge(je)}return a}var Ye={exports:{}},We=function t(a,e){if(!a){var i=new Ze(e);throw Error.captureStackTrace&&Error.captureStackTrace(i,t),i}};class Ze extends Error{}function Je(t){return t.length}Ze.prototype.name="AssertionError";var Xe={byteLength:Je,toString:function(t){const a=t.byteLength;let e="";for(let i=0;i<a;i++)e+=String.fromCharCode(t[i]);return e},write:function(t,a,e=0,i=Je(a)){const o=Math.min(i,t.byteLength-e);for(let i=0;i<o;i++)t[e+i]=a.charCodeAt(i);return o}};const ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ai=new Uint8Array(256);for(let t=0;t<ti.length;t++)ai[ti.charCodeAt(t)]=t;function ei(t){let a=t.length;return 61===t.charCodeAt(a-1)&&a--,a>1&&61===t.charCodeAt(a-1)&&a--,3*a>>>2}ai[45]=62,ai[95]=63;var ii={byteLength:ei,toString:function(t){const a=t.byteLength;let e="";for(let i=0;i<a;i+=3)e+=ti[t[i]>>2]+ti[(3&t[i])<<4|t[i+1]>>4]+ti[(15&t[i+1])<<2|t[i+2]>>6]+ti[63&t[i+2]];return a%3==2?e=e.substring(0,e.length-1)+"=":a%3==1&&(e=e.substring(0,e.length-2)+"=="),e},write:function(t,a,e=0,i=ei(a)){const o=Math.min(i,t.byteLength-e);for(let e=0,i=0;e<o;e+=4){const o=ai[a.charCodeAt(e)],n=ai[a.charCodeAt(e+1)],c=ai[a.charCodeAt(e+2)],r=ai[a.charCodeAt(e+3)];t[i++]=o<<2|n>>4,t[i++]=(15&n)<<4|c>>2,t[i++]=(3&c)<<6|63&r}return o}};function oi(t){return t.length>>>1}var ni={byteLength:oi,toString:function(t){const a=t.byteLength;t=new DataView(t.buffer,t.byteOffset,a);let e="",i=0;for(let o=a-a%4;i<o;i+=4)e+=t.getUint32(i).toString(16).padStart(8,"0");for(;i<a;i++)e+=t.getUint8(i).toString(16).padStart(2,"0");return e},write:function(t,a,e=0,i=oi(a)){const o=Math.min(i,t.byteLength-e);for(let i=0;i<o;i++){const o=ci(a.charCodeAt(2*i)),n=ci(a.charCodeAt(2*i+1));if(void 0===o||void 0===n)return t.subarray(0,i);t[e+i]=o<<4|n}return o}};function ci(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:void 0}function ri(t){let a=0;for(let e=0,i=t.length;e<i;e++){const o=t.charCodeAt(e);if(o>=55296&&o<=56319&&e+1<i){const i=t.charCodeAt(e+1);if(i>=56320&&i<=57343){a+=4,e++;continue}}a+=o<=127?1:o<=2047?2:3}return a}let li,si;if("undefined"!=typeof TextDecoder){const t=new TextDecoder;li=function(a){return t.decode(a)}}else li=function(t){const a=t.byteLength;let e="",i=0;for(;i<a;){let o=t[i];if(o<=127){e+=String.fromCharCode(o),i++;continue}let n=0,c=0;if(o<=223?(n=1,c=31&o):o<=239?(n=2,c=15&o):o<=244&&(n=3,c=7&o),a-i-n>0){let a=0;for(;a<n;)o=t[i+a+1],c=c<<6|63&o,a+=1}else c=65533,n=a-i;e+=String.fromCodePoint(c),i+=n+1}return e};if("undefined"!=typeof TextEncoder){const t=new TextEncoder;si=function(a,e,i=0,o=ri(e)){const n=Math.min(o,a.byteLength-i);return t.encodeInto(e,a.subarray(i,i+n)),n}}else si=function(t,a,e=0,i=ri(a)){const o=Math.min(i,t.byteLength-e);t=t.subarray(e,e+o);let n=0,c=0;for(;n<a.length;){const e=a.codePointAt(n);if(e<=127){t[c++]=e,n++;continue}let i=0,o=0;for(e<=2047?(i=6,o=192):e<=65535?(i=12,o=224):e<=2097151&&(i=18,o=240),t[c++]=o|e>>i,i-=6;i>=0;)t[c++]=128|e>>i&63,i-=6;n+=e>=65536?2:1}return o};function di(t){return 2*t.length}var ui={byteLength:di,toString:function(t){const a=t.byteLength;let e="";for(let i=0;i<a-1;i+=2)e+=String.fromCharCode(t[i]+256*t[i+1]);return e},write:function(t,a,e=0,i=di(a)){const o=Math.min(i,t.byteLength-e);let n=o;for(let i=0;i<a.length&&!((n-=2)<0);++i){const o=a.charCodeAt(i),n=o>>8,c=o%256;t[e+2*i]=c,t[e+2*i+1]=n}return o}};const gi=Xe,_i=ii,fi=ni,pi={byteLength:ri,toString:li,write:si},hi=ui;function mi(t){switch(t){case"ascii":return gi;case"base64":return _i;case"hex":return fi;case"utf8":case"utf-8":case void 0:return pi;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return hi;default:throw new Error(`Unknown encoding: ${t}`)}}function Li(t){return t instanceof Uint8Array}function wi(t,a,e){return"string"==typeof t?function(t,a){const e=mi(a),i=new Uint8Array(e.byteLength(t));return e.write(i,t,0,i.byteLength),i}(t,a):Array.isArray(t)?function(t){const a=new Uint8Array(t.length);return a.set(t),a}(t):ArrayBuffer.isView(t)?function(t){const a=new Uint8Array(t.byteLength);return a.set(t),a}(t):function(t,a,e){return new Uint8Array(t,a,e)}(t,a,e)}function Ai(t,a,e){const i=t[a];t[a]=t[e],t[e]=i}var bi,yi,Ii={isBuffer:Li,alloc:function(t,a,e){const i=new Uint8Array(t);return void 0!==a&&a(i,a,0,i.byteLength,e),i},allocUnsafe:function(t){return new Uint8Array(t)},allocUnsafeSlow:function(t){return new Uint8Array(t)},byteLength:function(t,a){return mi(a).byteLength(t)},compare:function(t,a){if(t===a)return 0;const e=Math.min(t.byteLength,a.byteLength);t=new DataView(t.buffer,t.byteOffset,t.byteLength),a=new DataView(a.buffer,a.byteOffset,a.byteLength);let i=0;for(let o=e-e%4;i<o;i+=4){const e=t.getUint32(i),o=a.getUint32(i);if(e<o)return-1;if(e>o)return 1}for(;i<e;i++){const e=t.getUint8(i),o=a.getUint8(i);if(e<o)return-1;if(e>o)return 1}return t.byteLength>a.byteLength?1:t.byteLength<a.byteLength?-1:0},concat:function(t,a){void 0===a&&(a=t.reduce(((t,a)=>t+a.byteLength),0));const e=new Uint8Array(a);return t.reduce(((t,a)=>(e.set(a,t),t+a.byteLength)),0),e},copy:function(t,a,e=0,i=0,o=t.byteLength){if(o>0&&o<i)return 0;if(o===i)return 0;if(0===t.byteLength||0===a.byteLength)return 0;if(e<0)throw new RangeError("targetStart is out of range");if(i<0||i>=t.byteLength)throw new RangeError("sourceStart is out of range");if(o<0)throw new RangeError("sourceEnd is out of range");e>=a.byteLength&&(e=a.byteLength),o>t.byteLength&&(o=t.byteLength),a.byteLength-e<o-i&&(o=a.length-e+i);const n=o-i;return t===a?a.copyWithin(e,i,o):a.set(t.subarray(i,o),e),n},equals:function(t,a){if(t===a)return!0;if(t.byteLength!==a.byteLength)return!1;const e=t.byteLength;t=new DataView(t.buffer,t.byteOffset,t.byteLength),a=new DataView(a.buffer,a.byteOffset,a.byteLength);let i=0;for(let o=e-e%4;i<o;i+=4)if(t.getUint32(i)!==a.getUint32(i))return!1;for(;i<e;i++)if(t.getUint8(i)!==a.getUint8(i))return!1;return!0},fill:function(t,a,e,i,o){if("string"==typeof a?"string"==typeof e?(o=e,e=0,i=t.byteLength):"string"==typeof i&&(o=i,i=t.byteLength):"number"==typeof val?a&=255:"boolean"==typeof val&&(a=+a),e<0||t.byteLength<e||t.byteLength<i)throw new RangeError("Out of range index");if(void 0===e&&(e=0),void 0===i&&(i=t.byteLength),i<=e)return t;if(a||(a=0),"number"==typeof a)for(let o=e;o<i;++o)t[o]=a;else{const n=(a=Li(a)?a:wi(a,o)).byteLength;for(let o=0;o<i-e;++o)t[o+e]=a[o%n]}return t},from:wi,swap16:function(t){const a=t.byteLength;if(a%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<a;e+=2)Ai(t,e,e+1);return t},swap32:function(t){const a=t.byteLength;if(a%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<a;e+=4)Ai(t,e,e+3),Ai(t,e+1,e+2);return t},swap64:function(t){const a=t.byteLength;if(a%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<a;e+=8)Ai(t,e,e+7),Ai(t,e+1,e+6),Ai(t,e+2,e+5),Ai(t,e+3,e+4);return t},toBuffer:function(t){return t},toString:function(t,a,e=0,i=t.byteLength){const o=t.byteLength;return e>=o||i<=e?"":(e<0&&(e=0),i>o&&(i=o),(0!==e||i<o)&&(t=t.subarray(e,i)),mi(a).toString(t))},write:function(t,a,e,i,o){return void 0===e?o="utf8":void 0===i&&"string"==typeof e?(o=e,e=void 0):void 0===o&&"string"==typeof i&&(o=i,i=void 0),mi(o).write(t,a,e,i)}};var Ci=We,xi=Ii,Fi=null,Ei="undefined"!=typeof WebAssembly&&function(){if(yi)return bi;yi=1;var t=(()=>{for(var t=new Uint8Array(128),a=0;a<64;a++)t[a<26?a+65:a<52?a+71:a<62?a-4:4*a-205]=a;return a=>{for(var e=a.length,i=new Uint8Array(3*(e-("="==a[e-1])-("="==a[e-2]))/4|0),o=0,n=0;o<e;){var c=t[a.charCodeAt(o++)],r=t[a.charCodeAt(o++)],l=t[a.charCodeAt(o++)],s=t[a.charCodeAt(o++)];i[n++]=c<<2|r>>4,i[n++]=r<<4|l>>2,i[n++]=l<<6|s}return i}})(),a=((t,a)=>function(){return a||(0,t[Object.keys(t)[0]])((a={exports:{}}).exports,a),a.exports})({"wasm-binary:./blake2b.wat"(a,e){e.exports=t("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),e=a(),i=WebAssembly.compile(e);return bi=async t=>(await WebAssembly.instantiate(await i,t)).exports}()().then((t=>{Fi=t})),Bi=64,vi=[];Ye.exports=Qi;var Si=Ye.exports.BYTES_MIN=16,Gi=Ye.exports.BYTES_MAX=64;Ye.exports.BYTES=32;var Pi=Ye.exports.KEYBYTES_MIN=16,Ui=Ye.exports.KEYBYTES_MAX=64;Ye.exports.KEYBYTES=32;var Oi=Ye.exports.SALTBYTES=16,zi=Ye.exports.PERSONALBYTES=16;function Qi(t,a,e,i,o){if(!(this instanceof Qi))return new Qi(t,a,e,i,o);if(!Fi)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==o&&(Ci(t>=Si,"digestLength must be at least "+Si+", was given "+t),Ci(t<=Gi,"digestLength must be at most "+Gi+", was given "+t),null!=a&&(Ci(a instanceof Uint8Array,"key must be Uint8Array or Buffer"),Ci(a.length>=Pi,"key must be at least "+Pi+", was given "+a.length),Ci(a.length<=Ui,"key must be at least "+Ui+", was given "+a.length)),null!=e&&(Ci(e instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Ci(e.length===Oi,"salt must be exactly "+Oi+", was given "+e.length)),null!=i&&(Ci(i instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Ci(i.length===zi,"personal must be exactly "+zi+", was given "+i.length))),vi.length||(vi.push(Bi),Bi+=216),this.digestLength=t,this.finalized=!1,this.pointer=vi.pop(),this._memory=new Uint8Array(Fi.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=a?a.length:0,this._memory[2]=1,this._memory[3]=1,e&&this._memory.set(e,32),i&&this._memory.set(i,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),Fi.blake2b_init(this.pointer,this.digestLength),a&&(this.update(a),this._memory.fill(0,Bi,Bi+a.length),this._memory[this.pointer+200]=128)}function qi(){}function Mi(t){return(0!=(4294901760&t)?(t&=4294901760,16):0)|(0!=(4278255360&t)?(t&=4278255360,8):0)|(0!=(4042322160&t)?(t&=4042322160,4):0)|(0!=(3435973836&t)?(t&=3435973836,2):0)|0!=(2863311530&t)}function Ti(t,a){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);let i="";for(let t=0;t<4;t++){t>0&&(i+="\n"),i+="\t\t";for(let a=0;a<4;a++)a>0&&(i+=" "),i+=e.getUint32(16*t+4*a).toString(16).padStart(8,"0")}return a&&(i=a+"\n"+i),i}function ki(t,a){if(t.byteLength!=a.byteLength)return!1;for(var e=new Int8Array(t),i=new Int8Array(a),o=0;o!=t.byteLength;o++)if(e[o]!=i[o])return!1;return!0}function Ri(t){const a=t.getPartialHash(),e=Ye.exports(64);return e.setPartialHash(a),e}async function Di(t,a,e,i,o){if(t.G1.isZero(a))return!1;if(t.G1.isZero(e))return!1;if(t.G2.isZero(i))return!1;if(t.G2.isZero(o))return!1;return await t.pairingEq(a,o,t.G1.neg(e),i)}async function Ni(t){for(;!t;)t=await window.prompt("Enter a random text. (Entropy): ","");const a=Ye.exports(64);a.update(M.randomBytes(64));const e=new TextEncoder;a.update(e.encode(t));const i=Buffer.from(a.digest()),o=[];for(let t=0;t<8;t++)o[t]=i.readUInt32BE(4*t);return new q(o)}function Ki(t,a){let e,i;a<32?(e=1<<a>>>0,i=1):(e=4294967296,i=1<<a-32>>>0);let o=t;for(let t=0;t<i;t++)for(let t=0;t<e;t++)o=M.createHash("sha256").update(o).digest();const n=new DataView(o.buffer,o.byteOffset,o.byteLength),c=[];for(let t=0;t<8;t++)c[t]=n.getUint32(4*t,!1);return new q(c)}function Vi(t){return t instanceof Uint8Array?t:("0x"==t.slice(0,2)&&(t=t.slice(2)),new Uint8Array(t.match(/[\da-f]{2}/gi).map((function(t){return parseInt(t,16)}))))}function ji(t){return Array.prototype.map.call(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}function Hi(t,a){if(a instanceof Uint8Array)return t.toString(a);if(Array.isArray(a))return a.map(Hi.bind(null,t));if("object"==typeof a){const e={};return Object.keys(a).forEach((i=>{e[i]=Hi(t,a[i])})),e}return"bigint"==typeof a||void 0!==a.eq?a.toString(10):a}async function $i(t,a){await ze(t,1),await t.writeULE32(1),await Qe(t);const e=await He(a.q);await ze(t,2);const i=e.q,o=8*(Math.floor((pe.bitLength(i)-1)/64)+1),n=e.r,c=8*(Math.floor((pe.bitLength(n)-1)/64)+1);await t.writeULE32(o),await Te(t,i,o),await t.writeULE32(c),await Te(t,n,c),await t.writeULE32(a.nVars),await t.writeULE32(a.nPublic),await t.writeULE32(a.domainSize),await Yi(t,e,a.vk_alpha_1),await Yi(t,e,a.vk_beta_1),await Wi(t,e,a.vk_beta_2),await Wi(t,e,a.vk_gamma_2),await Yi(t,e,a.vk_delta_1),await Wi(t,e,a.vk_delta_2),await Qe(t)}async function Yi(t,a,e){const i=new Uint8Array(2*a.G1.F.n8);a.G1.toRprLEM(i,0,e),await t.write(i)}async function Wi(t,a,e){const i=new Uint8Array(2*a.G2.F.n8);a.G2.toRprLEM(i,0,e),await t.write(i)}async function Zi(t,a,e){const i=await t.read(2*a.G1.F.n8),o=a.G1.fromRprLEM(i,0);return e?a.G1.toObject(o):o}async function Ji(t,a,e){const i=await t.read(2*a.G2.F.n8),o=a.G2.fromRprLEM(i,0);return e?a.G2.toObject(o):o}async function Xi(t,a,e){await qe(t,a,1);const i=await t.readULE32();if(await Me(t),1==i)return await async function(t,a,e){const i={protocol:"groth16"};await qe(t,a,2);const o=await t.readULE32();i.n8q=o,i.q=await ke(t,o);const n=await t.readULE32();return i.n8r=n,i.r=await ke(t,n),i.curve=await He(i.q),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=Mi(i.domainSize),i.vk_alpha_1=await Zi(t,i.curve,e),i.vk_beta_1=await Zi(t,i.curve,e),i.vk_beta_2=await Ji(t,i.curve,e),i.vk_gamma_2=await Ji(t,i.curve,e),i.vk_delta_1=await Zi(t,i.curve,e),i.vk_delta_2=await Ji(t,i.curve,e),await Me(t),i}(t,a,e);if(2==i)return await async function(t,a,e){const i={protocol:"plonk"};await qe(t,a,2);const o=await t.readULE32();i.n8q=o,i.q=await ke(t,o);const n=await t.readULE32();return i.n8r=n,i.r=await ke(t,n),i.curve=await He(i.q),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=Mi(i.domainSize),i.nAdditions=await t.readULE32(),i.nConstrains=await t.readULE32(),i.k1=await t.read(n),i.k2=await t.read(n),i.Qm=await Zi(t,i.curve,e),i.Ql=await Zi(t,i.curve,e),i.Qr=await Zi(t,i.curve,e),i.Qo=await Zi(t,i.curve,e),i.Qc=await Zi(t,i.curve,e),i.S1=await Zi(t,i.curve,e),i.S2=await Zi(t,i.curve,e),i.S3=await Zi(t,i.curve,e),i.X_2=await Ji(t,i.curve,e),await Me(t),i}(t,a,e);throw new Error("Protocol not supported: ")}async function to(t,a,e){const i={delta:{}};i.deltaAfter=await Zi(t,a,e),i.delta.g1_s=await Zi(t,a,e),i.delta.g1_sx=await Zi(t,a,e),i.delta.g2_spx=await Ji(t,a,e),i.transcript=await t.read(64),i.type=await t.readULE32();const o=await t.readULE32(),n=t.pos;let c=0;for(;t.pos-n<o;){const a=await t.read(1);if(a[0]<=c)throw new Error("Parameters in the contribution must be sorted");if(c=a[0],1==a[0]){const a=await t.read(1),e=await t.read(a[0]);i.name=(new TextDecoder).decode(e)}else if(2==a[0]){const a=await t.read(1);i.numIterationsExp=a[0]}else{if(3!=a[0])throw new Error("Parameter not recognized");{const a=await t.read(1);i.beaconHash=await t.read(a[0])}}}if(t.pos!=n+o)throw new Error("Parametes do not match");return i}async function ao(t,a,e){await qe(t,e,10);const i={contributions:[]};i.csHash=await t.read(64);const o=await t.readULE32();for(let e=0;e<o;e++){const e=await to(t,a);i.contributions.push(e)}return await Me(t),i}async function eo(t,a,e){await Yi(t,a,e.deltaAfter),await Yi(t,a,e.delta.g1_s),await Yi(t,a,e.delta.g1_sx),await Wi(t,a,e.delta.g2_spx),await t.write(e.transcript),await t.writeULE32(e.type||0);const i=[];if(e.name){i.push(1);const t=new TextEncoder("utf-8").encode(e.name.substring(0,64));i.push(t.byteLength);for(let a=0;a<t.byteLength;a++)i.push(t[a])}if(1==e.type){i.push(2),i.push(e.numIterationsExp),i.push(3),i.push(e.beaconHash.byteLength);for(let t=0;t<e.beaconHash.byteLength;t++)i.push(e.beaconHash[t])}if(i.length>0){const a=new Uint8Array(i);await t.writeULE32(a.byteLength),await t.write(a)}else await t.writeULE32(0)}async function io(t,a,e){await ze(t,10),await t.write(e.csHash),await t.writeULE32(e.contributions.length);for(let i=0;i<e.contributions.length;i++)await eo(t,a,e.contributions[i]);await Qe(t)}function oo(t,a,e){const i=new Uint8Array(2*a.G1.F.n8);a.G1.toRprUncompressed(i,0,e),t.update(i)}function no(t,a,e){oo(t,a,e.deltaAfter),oo(t,a,e.delta.g1_s),oo(t,a,e.delta.g1_sx),function(t,a,e){const i=new Uint8Array(2*a.G2.F.n8);a.G2.toRprUncompressed(i,0,e),t.update(i)}(t,a,e.delta.g2_spx),t.update(e.transcript)}async function co(t,a){await qe(t,a,1);const e=await t.readULE32(),i=await ke(t,e),o=await t.readULE32();return await Me(t),{n8:e,q:i,nWitness:o}}Qi.prototype._realloc=function(t){Fi.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(Fi.memory.buffer)},Qi.prototype.update=function(t){return Ci(!1===this.finalized,"Hash instance finalized"),Ci(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),Bi+t.length>this._memory.length&&this._realloc(Bi+t.length),this._memory.set(t,Bi),Fi.blake2b_update(this.pointer,Bi,Bi+t.length),this},Qi.prototype.digest=function(t){if(Ci(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,vi.push(this.pointer),Fi.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return xi.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);Ci(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var a=0;a<this.digestLength;a++)t[a]=this._memory[this.pointer+128+a];return t},Qi.prototype.final=Qi.prototype.digest,Qi.WASM=Fi,Qi.SUPPORTED="undefined"!=typeof WebAssembly,Qi.ready=function(t){return t||(t=qi),Ei?Ei.then((()=>t()),t):t(new Error("WebAssembly not supported"))},Qi.prototype.ready=Qi.ready,Qi.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},Qi.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)};const{stringifyBigInts:ro}=he;async function lo(t,a,e){const{fd:i,sections:o}=await Ue(t,"zkey",2),n=await Xi(i,o);e&&e.debug("Reading Coeffs");const c=[await De(i,o,4),await De(i,o,5),await De(i,o,6),await De(i,o,7),await De(i,o,8),await De(i,o,9)];return await i.close(),so(n,c,a,e)}async function so(t,a,e,i){const{fd:o,sections:n}=await Ue(e,"wtns",2),c=await co(o,n),r=a[0];if("groth16"!=t.protocol)throw new Error("zkey file is not groth16");if(!pe.eq(t.r,c.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(c.nWitness!=t.nVars)throw new Error(`Invalid witness length. Circuit: ${t.nVars}, witness: ${c.nWitness}`);const l=t.curve,s=l.Fr,d=l.G1,u=l.G2,g=Mi(t.domainSize);i&&i.debug("Reading Wtns");const _=await De(o,n,2);i&&i.debug("Building ABC");const[f,p,h]=await async function(t,a,e,i,o){const n=t.Fr.n8,c=12+a.n8r,r=(i.byteLength-4)/c,l=new Pa(a.domainSize*n),s=new Pa(a.domainSize*n),d=new Pa(a.domainSize*n),u=[l,s];for(let a=0;a<r;a++){o&&a%1e6==0&&o.debug(`QAP AB: ${a}/${r}`);const l=i.slice(4+a*c,4+a*c+c),s=new DataView(l.buffer),d=s.getUint32(0,!0),g=s.getUint32(4,!0),_=s.getUint32(8,!0),f=l.slice(12,12+n);u[d].set(t.Fr.add(u[d].slice(g*n,g*n+n),t.Fr.mul(f,e.slice(_*n,_*n+n))),g*n)}for(let e=0;e<a.domainSize;e++)o&&e%1e6==0&&o.debug(`QAP C: ${e}/${a.domainSize}`),d.set(t.Fr.mul(l.slice(e*n,e*n+n),s.slice(e*n,e*n+n)),e*n);return[l,s,d]}(l,t,_,r,i),m=g==s.s?l.Fr.shift:l.Fr.w[g+1],L=await s.ifft(f,"","",i,"IFFT_A"),w=await s.batchApplyKey(L,s.e(1),m),A=await s.fft(w,"","",i,"FFT_A"),b=await s.ifft(p,"","",i,"IFFT_B"),y=await s.batchApplyKey(b,s.e(1),m),I=await s.fft(y,"","",i,"FFT_B"),C=await s.ifft(h,"","",i,"IFFT_C"),x=await s.batchApplyKey(C,s.e(1),m),F=await s.fft(x,"","",i,"FFT_C");i&&i.debug("Join ABC");const E=await async function(t,a,e,i,o,n){const c=1<<22,r=t.Fr.n8,l=Math.floor(e.byteLength/t.Fr.n8),s=[];for(let a=0;a<l;a+=c){n&&n.debug(`JoinABC: ${a}/${l}`);const d=Math.min(l-a,c),u=[],g=e.slice(a*r,(a+d)*r),_=i.slice(a*r,(a+d)*r),f=o.slice(a*r,(a+d)*r);u.push({cmd:"ALLOCSET",var:0,buff:g}),u.push({cmd:"ALLOCSET",var:1,buff:_}),u.push({cmd:"ALLOCSET",var:2,buff:f}),u.push({cmd:"ALLOC",var:3,len:d*r}),u.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:d},{var:3}]}),u.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:d},{var:3}]}),u.push({cmd:"GET",out:0,var:3,len:d*r}),s.push(t.tm.queueAction(u))}const d=await Promise.all(s);let u;u=e instanceof Pa?new Pa(e.byteLength):new Uint8Array(e.byteLength);let g=0;for(let t=0;t<d.length;t++)u.set(d[t][0],g),g+=d[t][0].byteLength;return u}(l,0,A,I,F,i);let B={};i&&i.debug("Reading A Points");const v=a[1];B.pi_a=await l.G1.multiExpAffine(v,_,i,"multiexp A"),i&&i.debug("Reading B1 Points");const S=a[2];let G=await l.G1.multiExpAffine(S,_,i,"multiexp B1");i&&i.debug("Reading B2 Points");const P=a[3];B.pi_b=await l.G2.multiExpAffine(P,_,i,"multiexp B2"),i&&i.debug("Reading C Points");const U=a[4];B.pi_c=await l.G1.multiExpAffine(U,_.slice((t.nPublic+1)*l.Fr.n8),i,"multiexp C"),i&&i.debug("Reading H Points");const O=a[5],z=await l.G1.multiExpAffine(O,E,i,"multiexp H"),Q=l.Fr.random(),q=l.Fr.random();B.pi_a=d.add(B.pi_a,t.vk_alpha_1),B.pi_a=d.add(B.pi_a,d.timesFr(t.vk_delta_1,Q)),B.pi_b=u.add(B.pi_b,t.vk_beta_2),B.pi_b=u.add(B.pi_b,u.timesFr(t.vk_delta_2,q)),G=d.add(G,t.vk_beta_1),G=d.add(G,d.timesFr(t.vk_delta_1,q)),B.pi_c=d.add(B.pi_c,z),B.pi_c=d.add(B.pi_c,d.timesFr(B.pi_a,q)),B.pi_c=d.add(B.pi_c,d.timesFr(G,Q)),B.pi_c=d.add(B.pi_c,d.timesFr(t.vk_delta_1,s.neg(s.mul(Q,q))));let M=[];for(let a=1;a<=t.nPublic;a++){const t=_.slice(a*s.n8,a*s.n8+s.n8);M.push(pe.fromRprLE(t))}return B.pi_a=d.toObject(d.toAffine(B.pi_a)),B.pi_b=u.toObject(u.toAffine(B.pi_b)),B.pi_c=d.toObject(d.toAffine(B.pi_c)),B.protocol="groth16",B.curve=l.name,await o.close(),B=ro(B),M=ro(M),{proof:B,publicSignals:M}}function uo(t){var a=[];return function t(a,e){if(Array.isArray(e))for(let i=0;i<e.length;i++)t(a,e[i]);else a.push(e)}(a,t),a}function go(t){const a=BigInt(2)**BigInt(64);let e=BigInt("0xCBF29CE484222325");for(var i=0;i<t.length;i++)e^=BigInt(t[i].charCodeAt()),e*=BigInt(1099511628211),e%=a;let o=e.toString(16),n=16-o.length;return o="0".repeat(n).concat(o),o}function _o(t,a){const e=[];let i=BigInt(t);const o=BigInt(4294967296);for(;i;)e.unshift(Number(i%o)),i/=o;if(a)for(var n=a-e.length;n>0;)e.unshift(0),n--;return e}async function fo(t,a){a=a||{};let e,i=32767,o=!1;for(;!o;)try{e=new WebAssembly.Memory({initial:i}),o=!0}catch(t){if(1===i)throw t;console.warn("Could not allocate "+1024*i*64+" bytes. This may cause severe instability. Trying with "+1024*i*64/2+" bytes"),i=Math.floor(i/2)}const n=await WebAssembly.compile(t);let c,r="",l="",s=1,d=0,u=0;const g=await WebAssembly.instantiate(n,{env:{memory:e},runtime:{exceptionHandler:function(t){let a;throw a=1==t?"Signal not found. ":2==t?"Too many signals set. ":3==t?"Signal already set. ":4==t?"Assert Failed. ":5==t?"Not enough memory. ":6==t?"Input signal array access exceeds the size. ":"Unknown error. ",console.error("ERROR: ",t,r),new Error(a+r)},printErrorMessage:function(){r+=f()+"\n"},writeBufferMessage:function(){const t=f();"\n"===t?(console.log(l),l=""):(""!==l&&(l+=" "),l+=t)},showSharedRWMemory:function(){const t=g.exports.getFieldNumLen32(),a=new Uint32Array(t);for(let e=0;e<t;e++)a[t-1-e]=g.exports.readSharedRWMemory(e);if(s>=2&&(d>=1||u>=7)){""!==l&&(l+=" ");const t=pe.fromArray(a,4294967296).toString();l+=t}else console.log(pe.fromArray(a,4294967296))},error:function(t,e,i,o,n,r){let l;throw l=7==t?p(e)+" "+c.getFr(o).toString()+" != "+c.getFr(n).toString()+" "+p(r):9==t?p(e)+" "+c.getFr(o).toString()+" "+p(n):5==t&&a.sym?p(e)+" "+a.sym.labelIdx2Name[n]:p(e)+" "+i+" "+o+" "+n+" "+r,console.log("ERROR: ",t,l),new Error(l)},log:function(t){console.log(c.getFr(t).toString())},logGetSignal:function(t,e){a.logGetSignal&&a.logGetSignal(t,c.getFr(e))},logSetSignal:function(t,e){a.logSetSignal&&a.logSetSignal(t,c.getFr(e))},logStartComponent:function(t){a.logStartComponent&&a.logStartComponent(t)},logFinishComponent:function(t){a.logFinishComponent&&a.logFinishComponent(t)}}});"function"==typeof g.exports.getVersion&&(s=g.exports.getVersion()),"function"==typeof g.exports.getMinorVersion&&(d=g.exports.getMinorVersion()),"function"==typeof g.exports.getPatchVersion&&(u=g.exports.getPatchVersion());const _=a&&(a.sanityCheck||a.logGetSignal||a.logSetSignal||a.logStartComponent||a.logFinishComponent);return c=2===s?new ho(g,_):new po(e,g,_),c;function f(){for(var t="",a=g.exports.getMessageChar();0!=a;)t+=String.fromCharCode(a),a=g.exports.getMessageChar();return t}function p(t){const a=new Uint8Array(e.buffer),i=[];for(let e=0;a[t+e]>0;e++)i.push(a[t+e]);return String.fromCharCode.apply(null,i)}}class po{constructor(t,a,e){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=a,this.n32=(this.instance.exports.getFrLen()>>2)-2;const i=this.instance.exports.getPRawPrime(),o=new Array(this.n32);for(let t=0;t<this.n32;t++)o[this.n32-1-t]=this.i32[(i>>2)+t];this.prime=pe.fromArray(o,4294967296),this.Fr=new V(this.prime),this.mask32=pe.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(pe.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=e}circom_version(){return 1}async _doCalculateWitness(t,a){this.instance.exports.init(this.sanityCheck||a?1:0);const e=this.allocInt(),i=this.allocFr();Object.keys(t).forEach((a=>{const o=go(a),n=parseInt(o.slice(0,8),16),c=parseInt(o.slice(8,16),16);try{this.instance.exports.getSignalOffset32(e,0,n,c)}catch(t){throw new Error(`Signal ${a} is not an input of the circuit.`)}const r=this.getInt(e),l=uo(t[a]);for(let t=0;t<l.length;t++)this.setFr(i,l[t]),this.instance.exports.setSignal(0,0,r+t,i)}))}async calculateWitness(t,a){const e=this,i=e.i32[0],o=[];await e._doCalculateWitness(t,a);for(let t=0;t<e.NVars;t++){const a=e.instance.exports.getPWitness(t);o.push(e.getFr(a))}return e.i32[0]=i,o}async calculateBinWitness(t,a){const e=this,i=e.i32[0];await e._doCalculateWitness(t,a);const o=e.instance.exports.getWitnessBuffer();e.i32[0]=i;const n=e.memory.buffer.slice(o,o+e.NVars*e.n64*8);return new Uint8Array(n)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,a){this.i32[t>>2]=a}getFr(t){const a=this,e=t>>2;if(2147483648&a.i32[e+1]){const t=new Array(a.n32);for(let i=0;i<a.n32;i++)t[a.n32-1-i]=a.i32[e+2+i];const o=a.Fr.e(pe.fromArray(t,4294967296));return 1073741824&a.i32[e+1]?(i=o,a.Fr.mul(a.RInv,i)):o}return 2147483648&a.i32[e]?a.Fr.e(a.i32[e]-4294967296):a.Fr.e(a.i32[e]);var i}setFr(t,a){const e=this;a=e.Fr.e(a);const i=e.Fr.neg(e.Fr.e("80000000",16)),o=e.Fr.e("7FFFFFFF",16);if(e.Fr.geq(a,i)&&e.Fr.leq(a,o)){let o;return e.Fr.geq(a,e.Fr.zero)?o=pe.toNumber(a):(o=pe.toNumber(e.Fr.sub(a,i)),o-=2147483648,o=4294967296+o),e.i32[t>>2]=o,void(e.i32[1+(t>>2)]=0)}e.i32[t>>2]=0,e.i32[1+(t>>2)]=2147483648;const n=pe.toArray(a,4294967296);for(let a=0;a<e.n32;a++){const i=n.length-1-a;e.i32[2+(t>>2)+a]=i>=0?n[i]:0}}}class ho{constructor(t,a){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const e=new Array(this.n32);for(let t=0;t<this.n32;t++)e[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);this.prime=pe.fromArray(e,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=a}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,a){this.instance.exports.init(this.sanityCheck||a?1:0);const e=Object.keys(t);var i=0;if(e.forEach((a=>{const e=go(a),o=parseInt(e.slice(0,8),16),n=parseInt(e.slice(8,16),16),c=uo(t[a]);for(let t=0;t<c.length;t++){const a=_o(c[t],this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,a[this.n32-1-t]);try{this.instance.exports.setInputSignal(o,n,t),i++}catch(t){throw new Error(t)}}})),i<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${i} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,a){const e=[];await this._doCalculateWitness(t,a);for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);const a=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)a[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);e.push(pe.fromArray(a,4294967296))}return e}async calculateWTNSBin(t,a){const e=new Uint32Array(this.witnessSize*this.n32+this.n32+11),i=new Uint8Array(e.buffer);await this._doCalculateWitness(t,a),i[0]="w".charCodeAt(0),i[1]="t".charCodeAt(0),i[2]="n".charCodeAt(0),i[3]="s".charCodeAt(0),e[1]=2,e[2]=2,e[3]=1;const o=4*this.n32,n=(8+o).toString(16);e[4]=parseInt(n.slice(0,8),16),e[5]=parseInt(n.slice(8,16),16),e[6]=o,this.instance.exports.getRawPrime();var c=7;for(let t=0;t<this.n32;t++)e[c+t]=this.instance.exports.readSharedRWMemory(t);e[c+=this.n32]=this.witnessSize,e[++c]=2,c++;const r=(o*this.witnessSize).toString(16);e[c]=parseInt(r.slice(0,8),16),e[c+1]=parseInt(r.slice(8,16),16),c+=2;for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);for(let t=0;t<this.n32;t++)e[c+t]=this.instance.exports.readSharedRWMemory(t);c+=this.n32}return i}}const{unstringifyBigInts:mo}=he;async function Lo(t,a,e,i){const o=mo(t),n=await Pe(a),c=await n.read(n.totalSize);await n.close();const r=await fo(c);if(1==r.circom_version()){const t=await r.calculateBinWitness(o),a=await Oe(e,"wtns",2,2);await async function(t,a,e){await ze(t,1);const i=8*(Math.floor((pe.bitLength(e)-1)/64)+1);if(await t.writeULE32(i),await Te(t,e,i),a.byteLength%i!=0)throw new Error("Invalid witness length");await t.writeULE32(a.byteLength/i),await Qe(t),await ze(t,2),await t.write(a),await Qe(t)}(a,t,r.prime),await a.close()}else{const t=await Ge(e),a=await r.calculateWTNSBin(o);await t.write(a),await t.close()}}const{unstringifyBigInts:wo}=he;const{unstringifyBigInts:Ao}=he;const{unstringifyBigInts:bo}=he;function yo(t){let a=t.toString(16);for(;a.length<64;)a="0"+a;return a=`"0x${a}"`,a}var Io=Object.freeze({__proto__:null,fullProve:async function(t,a,e,i){const o=wo(t),n={type:"mem"};return await Lo(o,a,n),await lo(e,n,i)},fullProveMemory:async function(t,a,e,i,o){const n={type:"mem"},c=wo(t);return await Lo(c,a,n),await so(e,i,n,o)},prove:lo,verify:async function(t,a,e,i){const o=Ao(t),n=Ao(e),c=Ao(a),r=await $e(o.curve),l=r.G1.fromObject(o.IC[0]),s=new Uint8Array(2*r.G1.F.n8*c.length),d=new Uint8Array(r.Fr.n8*c.length);for(let t=0;t<c.length;t++){const a=r.G1.fromObject(o.IC[t+1]);s.set(a,t*r.G1.F.n8*2),pe.toRprLE(d,r.Fr.n8*t,c[t],r.Fr.n8)}let u=await r.G1.multiExpAffine(s,d);u=r.G1.add(u,l);const g=r.G1.fromObject(n.pi_a),_=r.G2.fromObject(n.pi_b),f=r.G1.fromObject(n.pi_c),p=r.G2.fromObject(o.vk_gamma_2),h=r.G2.fromObject(o.vk_delta_2),m=r.G1.fromObject(o.vk_alpha_1),L=r.G2.fromObject(o.vk_beta_2);return await r.pairingEq(r.G1.neg(g),_,u,p,f,h,m,L)?(i&&i.info("OK!"),!0):(i&&i.error("Invalid proof"),!1)},exportSolidityCallData:async function(t,a){const e=bo(t),i=bo(a);let o,n="";for(let t=0;t<i.length;t++)""!=n&&(n+=","),n+=yo(i[t]);return o=`[${yo(e.pi_a[0])}, ${yo(e.pi_a[1])}],[[${yo(e.pi_b[0][1])}, ${yo(e.pi_b[0][0])}],[${yo(e.pi_b[1][1])}, ${yo(e.pi_b[1][0])}]],[${yo(e.pi_c[0])}, ${yo(e.pi_c[1])}],[${n}]`,o}});function Co(t,a){const e=new DataView(a.buffer,a.byteOffset,a.byteLength),i=[];for(let t=0;t<8;t++)i[t]=e.getUint32(4*t);const o=new q(i);return t.G2.fromRng(o)}function xo(t,a,e,i,o){const n=Ye.exports(64),c=new Uint8Array([a]);n.update(c),n.update(e);const r=t.G1.toUncompressed(i);n.update(r);const l=t.G1.toUncompressed(o);n.update(l);return Co(t,n.digest())}function Fo(t,a,e,i,o){return t.g1_s=a.G1.toAffine(a.G1.fromRng(o)),t.g1_sx=a.G1.toAffine(a.G1.timesFr(t.g1_s,t.prvKey)),t.g2_sp=a.G2.toAffine(xo(a,e,i,t.g1_s,t.g1_sx)),t.g2_spx=a.G2.toAffine(a.G2.timesFr(t.g2_sp,t.prvKey)),t}function Eo(t,a,e){const i={tau:{},alpha:{},beta:{}};return i.tau.prvKey=t.Fr.fromRng(e),i.alpha.prvKey=t.Fr.fromRng(e),i.beta.prvKey=t.Fr.fromRng(e),Fo(i.tau,t,0,a,e),Fo(i.alpha,t,1,a,e),Fo(i.beta,t,2,a,e),i}async function Bo(t,a,e,i){i||(i=e),await t.writeULE32(1);const o=t.pos;await t.writeULE64(0),await t.writeULE32(8*a.F1.n64);const n=new Uint8Array(a.F1.n8);pe.toRprLE(n,0,a.q,a.F1.n8),await t.write(n),await t.writeULE32(e),await t.writeULE32(i);const c=t.pos-o-8,r=t.pos;await t.writeULE64(c,o),t.pos=r}async function vo(t,a){if(!a[1])throw new Error(t.fileName+": File has no  header");if(a[1].length>1)throw new Error(t.fileName+": File has more than one header");t.pos=a[1][0].p;const e=await t.readULE32(),i=await t.read(e),o=pe.fromRprLE(i),n=await He(o);if(8*n.F1.n64!=e)throw new Error(t.fileName+": Invalid size");const c=await t.readULE32(),r=await t.readULE32();if(t.pos-a[1][0].p!=a[1][0].size)throw new Error("Invalid PTau header size");return{curve:n,power:c,ceremonyPower:r}}function So(t,a,e,i){const o={tau:{},alpha:{},beta:{}};return o.tau.g1_s=n(),o.tau.g1_sx=n(),o.alpha.g1_s=n(),o.alpha.g1_sx=n(),o.beta.g1_s=n(),o.beta.g1_sx=n(),o.tau.g2_spx=c(),o.alpha.g2_spx=c(),o.beta.g2_spx=c(),o;function n(){let o;return o=i?e.G1.fromRprLEM(t,a):e.G1.fromRprUncompressed(t,a),a+=2*e.G1.F.n8,o}function c(){let o;return o=i?e.G2.fromRprLEM(t,a):e.G2.fromRprUncompressed(t,a),a+=2*e.G2.F.n8,o}}function Go(t,a,e,i,o){async function n(i){o?e.G1.toRprLEM(t,a,i):e.G1.toRprUncompressed(t,a,i),a+=2*e.F1.n8}async function c(i){o?e.G2.toRprLEM(t,a,i):e.G2.toRprUncompressed(t,a,i),a+=2*e.F2.n8}return n(i.tau.g1_s),n(i.tau.g1_sx),n(i.alpha.g1_s),n(i.alpha.g1_sx),n(i.beta.g1_s),n(i.beta.g1_sx),c(i.tau.g2_spx),c(i.alpha.g2_spx),c(i.beta.g2_spx),t}async function Po(t,a){const e={};e.tauG1=await l(),e.tauG2=await s(),e.alphaG1=await l(),e.betaG1=await l(),e.betaG2=await s(),e.key=await async function(t,a,e){return So(await t.read(2*a.F1.n8*6+2*a.F2.n8*3),0,a,e)}(t,a,!0),e.partialHash=await t.read(216),e.nextChallenge=await t.read(64),e.type=await t.readULE32();const i=new Uint8Array(2*a.G1.F.n8*6+2*a.G2.F.n8*3);Go(i,0,a,e.key,!1);const o=Ye.exports(64);o.setPartialHash(e.partialHash),o.update(i),e.responseHash=o.digest();const n=await t.readULE32(),c=t.pos;let r=0;for(;t.pos-c<n;){const t=await d(1);if(t[0]<=r)throw new Error("Parameters in the contribution must be sorted");if(r=t[0],1==t[0]){const t=await d(1),a=await d(t[0]);e.name=(new TextDecoder).decode(a)}else if(2==t[0]){const t=await d(1);e.numIterationsExp=t[0]}else{if(3!=t[0])throw new Error("Parameter not recognized");{const t=await d(1);e.beaconHash=await d(t[0])}}}if(t.pos!=c+n)throw new Error("Parametes do not match");return e;async function l(){const e=await t.read(2*a.G1.F.n8);return a.G1.fromRprLEM(e)}async function s(){const e=await t.read(2*a.G2.F.n8);return a.G2.fromRprLEM(e)}async function d(a){const e=await t.read(a);return new Uint8Array(e)}}async function Uo(t,a,e){if(!e[7])throw new Error(t.fileName+": File has no  contributions");if(e[7][0].length>1)throw new Error(t.fileName+": File has more than one contributions section");t.pos=e[7][0].p;const i=await t.readULE32(),o=[];for(let e=0;e<i;e++){const i=await Po(t,a);i.id=e+1,o.push(i)}if(t.pos-e[7][0].p!=e[7][0].size)throw new Error("Invalid contribution section size");return o}async function Oo(t,a,e){const i=new Uint8Array(2*a.F1.n8),o=new Uint8Array(2*a.F2.n8);await c(e.tauG1),await r(e.tauG2),await c(e.alphaG1),await c(e.betaG1),await r(e.betaG2),await async function(t,a,e,i){const o=new Uint8Array(2*a.F1.n8*6+2*a.F2.n8*3);Go(o,0,a,e,i),await t.write(o)}(t,a,e.key,!0),await t.write(e.partialHash),await t.write(e.nextChallenge),await t.writeULE32(e.type||0);const n=[];if(e.name){n.push(1);const t=new TextEncoder("utf-8").encode(e.name.substring(0,64));n.push(t.byteLength);for(let a=0;a<t.byteLength;a++)n.push(t[a])}if(1==e.type){n.push(2),n.push(e.numIterationsExp),n.push(3),n.push(e.beaconHash.byteLength);for(let t=0;t<e.beaconHash.byteLength;t++)n.push(e.beaconHash[t])}if(n.length>0){const a=new Uint8Array(n);await t.writeULE32(a.byteLength),await t.write(a)}else await t.writeULE32(0);async function c(e){a.G1.toRprLEM(i,0,e),await t.write(i)}async function r(e){a.G2.toRprLEM(o,0,e),await t.write(o)}}async function zo(t,a,e){await t.writeULE32(7);const i=t.pos;await t.writeULE64(0),await t.writeULE32(e.length);for(let i=0;i<e.length;i++)await Oo(t,a,e[i]);const o=t.pos-i-8,n=t.pos;await t.writeULE64(o,i),t.pos=n}function Qo(t,a,e){e&&e.debug("Calculating First Challenge Hash");const i=new Ye.exports(64),o=new Uint8Array(2*t.G1.F.n8),n=new Uint8Array(2*t.G2.F.n8);let c;return t.G1.toRprUncompressed(o,0,t.G1.g),t.G2.toRprUncompressed(n,0,t.G2.g),i.update(Ye.exports(64).digest()),c=2**a*2-1,e&&e.debug("Calculate Initial Hash: tauG1"),r(o,c),c=2**a,e&&e.debug("Calculate Initial Hash: tauG2"),r(n,c),e&&e.debug("Calculate Initial Hash: alphaTauG1"),r(o,c),e&&e.debug("Calculate Initial Hash: betaTauG1"),r(o,c),i.update(n),i.digest();function r(t,a){const o=341e3,n=Math.floor(a/o),c=a%o,r=new Uint8Array(o*t.byteLength);for(let a=0;a<o;a++)r.set(t,a*t.byteLength);for(let t=0;t<n;t++)i.update(r),e&&e.debug("Initial hash: "+t*o);for(let a=0;a<c;a++)i.update(t)}}function qo(t,a,e,i){return Eo(t,a,Ki(e,i))}const Mo=Di;async function To(t,a,e,i){let o;if(1==a.type){const o=qo(t,e.nextChallenge,a.beaconHash,a.numIterationsExp);if(!t.G1.eq(a.key.tau.g1_s,o.tau.g1_s))return i&&i.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G1.eq(a.key.tau.g1_sx,o.tau.g1_sx))return i&&i.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G2.eq(a.key.tau.g2_spx,o.tau.g2_spx))return i&&i.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G1.eq(a.key.alpha.g1_s,o.alpha.g1_s))return i&&i.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G1.eq(a.key.alpha.g1_sx,o.alpha.g1_sx))return i&&i.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G2.eq(a.key.alpha.g2_spx,o.alpha.g2_spx))return i&&i.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G1.eq(a.key.beta.g1_s,o.beta.g1_s))return i&&i.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G1.eq(a.key.beta.g1_sx,o.beta.g1_sx))return i&&i.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1;if(!t.G2.eq(a.key.beta.g2_spx,o.beta.g2_spx))return i&&i.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${a.id}  ${a.name||""}`),!1}return a.key.tau.g2_sp=t.G2.toAffine(xo(t,0,e.nextChallenge,a.key.tau.g1_s,a.key.tau.g1_sx)),a.key.alpha.g2_sp=t.G2.toAffine(xo(t,1,e.nextChallenge,a.key.alpha.g1_s,a.key.alpha.g1_sx)),a.key.beta.g2_sp=t.G2.toAffine(xo(t,2,e.nextChallenge,a.key.beta.g1_s,a.key.beta.g1_sx)),o=await Mo(t,a.key.tau.g1_s,a.key.tau.g1_sx,a.key.tau.g2_sp,a.key.tau.g2_spx),!0!==o?(i&&i.error("INVALID key (tau) in challenge #"+a.id),!1):(o=await Mo(t,a.key.alpha.g1_s,a.key.alpha.g1_sx,a.key.alpha.g2_sp,a.key.alpha.g2_spx),!0!==o?(i&&i.error("INVALID key (alpha) in challenge #"+a.id),!1):(o=await Mo(t,a.key.beta.g1_s,a.key.beta.g1_sx,a.key.beta.g2_sp,a.key.beta.g2_spx),!0!==o?(i&&i.error("INVALID key (beta) in challenge #"+a.id),!1):(o=await Mo(t,e.tauG1,a.tauG1,a.key.tau.g2_sp,a.key.tau.g2_spx),!0!==o?(i&&i.error("INVALID tau*G1. challenge #"+a.id+" It does not follow the previous contribution"),!1):(o=await Mo(t,a.key.tau.g1_s,a.key.tau.g1_sx,e.tauG2,a.tauG2),!0!==o?(i&&i.error("INVALID tau*G2. challenge #"+a.id+" It does not follow the previous contribution"),!1):(o=await Mo(t,e.alphaG1,a.alphaG1,a.key.alpha.g2_sp,a.key.alpha.g2_spx),!0!==o?(i&&i.error("INVALID alpha*G1. challenge #"+a.id+" It does not follow the previous contribution"),!1):(o=await Mo(t,e.betaG1,a.betaG1,a.key.beta.g2_sp,a.key.beta.g2_spx),!0!==o?(i&&i.error("INVALID beta*G1. challenge #"+a.id+" It does not follow the previous contribution"),!1):(o=await Mo(t,a.key.beta.g1_s,a.key.beta.g1_sx,e.betaG2,a.betaG2),!0!==o?(i&&i.error("INVALID beta*G2. challenge #"+a.id+"It does not follow the previous contribution"),!1):(i&&i.info("Powers Of tau file OK!"),!0))))))))}async function ko(t,a,e,i,o,n,c,r,l,s){const d=o[n],u=2*d.F.n8,g=a[i][0].size/u;await qe(t,a,i),await ze(e,i);let _=c;for(let a=0;a<g;a+=65536){s&&s.debug(`Applying key: ${l}: ${a}/${g}`);const i=Math.min(g-a,65536);let n;n=await t.read(i*u),n=await d.batchApplyKey(n,_,r),await e.write(n),_=o.Fr.mul(_,o.Fr.exp(r,i))}await Qe(e),await Me(t)}async function Ro(t,a,e,i,o,n,c,r,l,s,d){const u=i[o],g=2*u.F.n8,_=Math.floor((1<<20)/g);let f=c;for(let o=0;o<n;o+=_){d&&d.debug(`Applying key ${s}: ${o}/${n}`);const c=Math.min(n-o,_),p=await t.read(c*g),h=await u.batchUtoLEM(p),m=await u.batchApplyKey(h,f,r);let L;L="COMPRESSED"==l?await u.batchLEMtoC(m):await u.batchLEMtoU(m),e&&e.update(L),await a.write(L),f=i.Fr.mul(f,i.Fr.exp(r,c))}}var Do=Object.freeze({__proto__:null,newAccumulator:async function(t,a,e,i){await Ye.exports.ready();const o=await Oe(e,"ptau",1,7);await Bo(o,t,a,0);const n=t.G1.oneAffine,c=t.G2.oneAffine;await ze(o,2);const r=2**a*2-1;for(let t=0;t<r;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("tauG1: "+t);await Qe(o),await ze(o,3);const l=2**a;for(let t=0;t<l;t++)await o.write(c),i&&t%1e5==0&&t&&i.log("tauG2: "+t);await Qe(o),await ze(o,4);const s=2**a;for(let t=0;t<s;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("alphaTauG1: "+t);await Qe(o),await ze(o,5);const d=2**a;for(let t=0;t<d;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("betaTauG1: "+t);await Qe(o),await ze(o,6),await o.write(c),await Qe(o),await ze(o,7),await o.writeULE32(0),await Qe(o),await o.close();const u=Qo(t,a,i);return i&&i.debug(Ti(Ye.exports(64).digest(),"Blank Contribution Hash:")),i&&i.info(Ti(u,"First Contribution Hash:")),u},exportChallenge:async function(t,a,e){await Ye.exports.ready();const{fd:i,sections:o}=await Ue(t,"ptau",1),{curve:n,power:c}=await vo(i,o),r=await Uo(i,n,o);let l,s;0==r.length?(l=Ye.exports(64).digest(),s=Qo(n,c)):(l=r[r.length-1].responseHash,s=r[r.length-1].nextChallenge),e&&e.info(Ti(l,"Last Response Hash: ")),e&&e.info(Ti(s,"New Challenge Hash: "));const d=await Ge(a),u=Ye.exports(64);await d.write(l),u.update(l),await _(2,"G1",2**c*2-1,"tauG1"),await _(3,"G2",2**c,"tauG2"),await _(4,"G1",2**c,"alphaTauG1"),await _(5,"G1",2**c,"betaTauG1"),await _(6,"G2",1,"betaG2"),await i.close(),await d.close();const g=u.digest();if(!ki(s,g))throw e&&e.info(Ti(g,"Calc Curret Challenge Hash: ")),e&&e.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),new Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return s;async function _(t,a,c,r){const l=n[a],s=2*l.F.n8,g=Math.floor((1<<24)/s);await qe(i,o,t);for(let t=0;t<c;t+=g){e&&e.debug(`Exporting ${r}: ${t}/${c}`);const a=Math.min(c-t,g);let o;o=await i.read(a*s),o=await l.batchLEMtoU(o),await d.write(o),u.update(o)}await Me(i)}},importResponse:async function(t,a,e,i,o,n){await Ye.exports.ready();const c=new Uint8Array(64);for(let t=0;t<64;t++)c[t]=255;const{fd:r,sections:l}=await Ue(t,"ptau",1),{curve:s,power:d}=await vo(r,l),u=await Uo(r,s,l),g={};i&&(g.name=i);const _=2*s.F1.n8,f=s.F1.n8,p=2*s.F2.n8,h=s.F2.n8,m=await Pe(a);if(m.totalSize!=64+(2**d*2-1)*f+2**d*h+2**d*f+2**d*f+h+6*_+3*p)throw new Error("Size of the contribution is invalid");let L;L=u.length>0?u[u.length-1].nextChallenge:Qo(s,d,n);const w=await Oe(e,"ptau",1,o?7:2);await Bo(w,s,d);const A=await m.read(64);if(ki(c,L)&&(L=A,u[u.length-1].nextChallenge=L),!ki(A,L))throw new Error("Wrong contribution. this contribution is not based on the previus hash");const b=new Ye.exports(64);b.update(A);const y=[];let I;I=await F(m,w,"G1",2,2**d*2-1,[1],"tauG1"),g.tauG1=I[0],I=await F(m,w,"G2",3,2**d,[1],"tauG2"),g.tauG2=I[0],I=await F(m,w,"G1",4,2**d,[0],"alphaG1"),g.alphaG1=I[0],I=await F(m,w,"G1",5,2**d,[0],"betaG1"),g.betaG1=I[0],I=await F(m,w,"G2",6,1,[0],"betaG2"),g.betaG2=I[0],g.partialHash=b.getPartialHash();const C=await m.read(2*s.F1.n8*6+2*s.F2.n8*3);g.key=So(C,0,s,!1),b.update(new Uint8Array(C));const x=b.digest();if(n&&n.info(Ti(x,"Contribution Response Hash imported: ")),o){const t=new Ye.exports(64);t.update(x),await E(t,w,"G1",2,2**d*2-1,"tauG1",n),await E(t,w,"G2",3,2**d,"tauG2",n),await E(t,w,"G1",4,2**d,"alphaTauG1",n),await E(t,w,"G1",5,2**d,"betaTauG1",n),await E(t,w,"G2",6,1,"betaG2",n),g.nextChallenge=t.digest(),n&&n.info(Ti(g.nextChallenge,"Next Challenge Hash: "))}else g.nextChallenge=c;return u.push(g),await zo(w,s,u),await m.close(),await w.close(),await r.close(),g.nextChallenge;async function F(t,a,e,i,c,r,l){return o?await async function(t,a,e,i,o,c,r){const l=s[e],d=l.F.n8,u=2*l.F.n8,g=[];await ze(a,i);const _=Math.floor((1<<24)/u);y[i]=a.pos;for(let e=0;e<o;e+=_){n&&n.debug(`Importing ${r}: ${e}/${o}`);const i=Math.min(o-e,_),s=await t.read(i*d);b.update(s);const f=await l.batchCtoLEM(s);await a.write(f);for(let t=0;t<c.length;t++){const a=c[t];if(a>=e&&a<e+i){const t=l.fromRprLEM(f,(a-e)*u);g.push(t)}}}return await Qe(a),g}(t,a,e,i,c,r,l):await async function(t,a,e,i,o,c,r){const l=s[e],d=l.F.n8,u=[],g=Math.floor((1<<24)/d);for(let a=0;a<o;a+=g){n&&n.debug(`Importing ${r}: ${a}/${o}`);const e=Math.min(o-a,g),i=await t.read(e*d);b.update(i);for(let t=0;t<c.length;t++){const o=c[t];if(o>=a&&o<a+e){const t=l.fromRprCompressed(i,(o-a)*d);u.push(t)}}}return u}(t,0,e,0,c,r,l)}async function E(t,a,e,i,o,n,c){const r=s[e],l=2*r.F.n8,d=Math.floor((1<<24)/l),u=a.pos;a.pos=y[i];for(let e=0;e<o;e+=d){c&&c.debug(`Hashing ${n}: ${e}/${o}`);const i=Math.min(o-e,d),s=await a.read(i*l),u=await r.batchLEMtoU(s);t.update(u)}a.pos=u}},verify:async function(t,a){let e;await Ye.exports.ready();const{fd:i,sections:o}=await Ue(t,"ptau",1),{curve:n,power:c,ceremonyPower:r}=await vo(i,o),l=await Uo(i,n,o);a&&a.debug("power: 2**"+c),a&&a.debug("Computing initial contribution hash");const s={tauG1:n.G1.g,tauG2:n.G2.g,alphaG1:n.G1.g,betaG1:n.G1.g,betaG2:n.G2.g,nextChallenge:Qo(n,r,a),responseHash:Ye.exports(64).digest()};if(0==l.length)return a&&a.error("This file has no contribution! It cannot be used in production"),!1;let d;d=l.length>1?l[l.length-2]:s;const u=l[l.length-1];if(a&&a.debug("Validating contribution #"+l[l.length-1].id),!await To(n,u,d,a))return!1;const g=Ye.exports(64);g.update(u.responseHash),a&&a.debug("Verifying powers in tau*G1 section");const _=await A(2,"G1","tauG1",2**c*2-1,[0,1],a);if(e=await Mo(n,_.R1,_.R2,n.G2.g,u.tauG2),!0!==e)return a&&a.error("tauG1 section. Powers do not match"),!1;if(!n.G1.eq(n.G1.g,_.singularPoints[0]))return a&&a.error("First element of tau*G1 section must be the generator"),!1;if(!n.G1.eq(u.tauG1,_.singularPoints[1]))return a&&a.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;a&&a.debug("Verifying powers in tau*G2 section");const f=await A(3,"G2","tauG2",2**c,[0,1],a);if(e=await Mo(n,n.G1.g,u.tauG1,f.R1,f.R2),!0!==e)return a&&a.error("tauG2 section. Powers do not match"),!1;if(!n.G2.eq(n.G2.g,f.singularPoints[0]))return a&&a.error("First element of tau*G2 section must be the generator"),!1;if(!n.G2.eq(u.tauG2,f.singularPoints[1]))return a&&a.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;a&&a.debug("Verifying powers in alpha*tau*G1 section");const p=await A(4,"G1","alphatauG1",2**c,[0],a);if(e=await Mo(n,p.R1,p.R2,n.G2.g,u.tauG2),!0!==e)return a&&a.error("alphaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(u.alphaG1,p.singularPoints[0]))return a&&a.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;a&&a.debug("Verifying powers in beta*tau*G1 section");const h=await A(5,"G1","betatauG1",2**c,[0],a);if(e=await Mo(n,h.R1,h.R2,n.G2.g,u.tauG2),!0!==e)return a&&a.error("betaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(u.betaG1,h.singularPoints[0]))return a&&a.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;const m=await async function(t){const a=n.G2,e=2*a.F.n8,c=new Uint8Array(e);if(!o[6])throw t.error("File has no BetaG2 section"),new Error("File has no BetaG2 section");if(o[6].length>1)throw t.error("File has no BetaG2 section"),new Error("File has more than one GetaG2 section");i.pos=o[6][0].p;const r=await i.read(e),l=a.fromRprLEM(r);return a.toRprUncompressed(c,0,l),g.update(c),l}(a);if(!n.G2.eq(u.betaG2,m))return a&&a.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;const L=g.digest();if(c==r&&!ki(L,u.nextChallenge))return a&&a.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;a&&a.info(Ti(L,"Next challenge hash: ")),w(u,d);for(let t=l.length-2;t>=0;t--){const e=l[t],i=t>0?l[t-1]:s;if(!await To(n,e,i,a))return!1;w(e,i)}if(a&&a.info("-----------------------------------------------------"),o[12]&&o[13]&&o[14]&&o[15]){let t;if(t=await b("G1",2,12,"tauG1",a),!t)return!1;if(t=await b("G2",3,13,"tauG2",a),!t)return!1;if(t=await b("G1",4,14,"alphaTauG1",a),!t)return!1;if(t=await b("G1",5,15,"betaTauG1",a),!t)return!1}else a&&a.warn('this file does not contain phase2 precalculated values. Please run: \n   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.');return await i.close(),a&&a.info("Powers of Tau Ok!"),!0;function w(t,e){if(!a)return;a.info("-----------------------------------------------------"),a.info(`Contribution #${t.id}: ${t.name||""}`),a.info(Ti(t.nextChallenge,"Next Challenge: "));const i=new Uint8Array(2*n.G1.F.n8*6+2*n.G2.F.n8*3);Go(i,0,n,t.key,!1);const o=Ye.exports(64);o.setPartialHash(t.partialHash),o.update(i);const c=o.digest();a.info(Ti(c,"Response Hash:")),a.info(Ti(e.nextChallenge,"Response Hash:")),1==t.type&&(a.info(`Beacon generator: ${ji(t.beaconHash)}`),a.info(`Beacon iterations Exp: ${t.numIterationsExp}`))}async function A(t,a,e,c,r,l){const s=n[a],d=2*s.F.n8;await qe(i,o,t);const u=[];let _=s.zero,f=s.zero,p=s.zero;for(let t=0;t<c;t+=65536){l&&l.debug(`points relations: ${e}: ${t}/${c} `);const a=Math.min(c-t,65536),o=await i.read(a*d),n=await s.batchLEMtoU(o);g.update(n);const h=new Uint8Array(4*(a-1));if(M.randomFillSync(h),t>0){const t=s.fromRprLEM(o,0),a=M.randomBytes(4).readUInt32BE(0,!0);_=s.add(_,s.timesScalar(p,a)),f=s.add(f,s.timesScalar(t,a))}const m=await s.multiExpAffine(o.slice(0,(a-1)*d),h),L=await s.multiExpAffine(o.slice(d),h);_=s.add(_,m),f=s.add(f,L),p=s.fromRprLEM(o,(a-1)*d);for(let e=0;e<r.length;e++){const i=r[e];if(i>=t&&i<t+a){const a=s.fromRprLEM(o,(i-t)*d);u.push(a)}}}return await Me(i),{R1:_,R2:f,singularPoints:u}}async function b(t,a,e,r,l){l&&l.debug(`Verifying phase2 calculated values ${r}...`);const s=n[t],d=2*s.F.n8,u=new Array(8);for(let t=0;t<8;t++)u[t]=M.randomBytes(4).readUInt32BE(0,!0);for(let t=0;t<=c;t++){if(!await g(t))return!1}if(2==a){if(!await g(c+1))return!1}return!0;async function g(t){l&&l.debug(`Power ${t}...`);const g=n.Fr.n8,_=2**t;let f,p=new Uint32Array(_),h=new q(u);l&&l.debug(`Creating random numbers Powers${t}...`);for(let a=0;a<_;a++)p[a]=t==c+1&&a==_-1?0:h.nextU32();p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength),l&&l.debug(`reading points Powers${t}...`),await qe(i,o,a),f=new Pa(_*d),t==c+1?(await i.readToBuffer(f,0,(_-1)*d),f.set(n.G1.zeroAffine,(_-1)*d)):await i.readToBuffer(f,0,_*d),await Me(i,!0);const m=await s.multiExpAffine(f,p,l,r+"_"+t);p=new Pa(_*g),h=new q(u);const L=new Uint8Array(4),w=new DataView(L.buffer);l&&l.debug(`Creating random numbers Powers${t}...`);for(let a=0;a<_;a++)a==_-1&&t==c+1||(w.setUint32(0,h.nextU32(),!0),p.set(L,a*g));l&&l.debug(`batchToMontgomery ${t}...`),p=await n.Fr.batchToMontgomery(p),l&&l.debug(`fft ${t}...`),p=await n.Fr.fft(p),l&&l.debug(`batchFromMontgomery ${t}...`),p=await n.Fr.batchFromMontgomery(p),l&&l.debug(`reading points Lagrange${t}...`),await qe(i,o,e),i.pos+=d*(2**t-1),await i.readToBuffer(f,0,_*d),await Me(i,!0);const A=await s.multiExpAffine(f,p,l,r+"_"+t+"_transformed");return!!s.eq(m,A)||(l&&l.error("Phase2 caclutation does not match with powers of tau"),!1)}}},challengeContribute:async function(t,a,e,i,o){await Ye.exports.ready();const n=await Pe(a),c=8*t.F1.n64*2,r=8*t.F2.n64*2,l=(n.totalSize+c-64-r)/(4*c+r);let s=l,d=0;for(;s>1;)s/=2,d+=1;if(2**d!=l)throw new Error("Invalid file size");o&&o.debug("Power to tau size: "+d);const u=await Ni(i),g=await Ge(e),_=Ye.exports(64);for(let t=0;t<n.totalSize;t+=n.pageSize){o&&o.debug(`Hashing challenge ${t}/${n.totalSize}`);const a=Math.min(n.totalSize-t,n.pageSize),e=await n.read(a);_.update(e)}const f=await n.read(64,0);o&&o.info(Ti(f,"Claimed Previous Response Hash: "));const p=_.digest();o&&o.info(Ti(p,"Current Challenge Hash: "));const h=Eo(t,p,u);o&&["tau","alpha","beta"].forEach((a=>{o.debug(a+".g1_s: "+t.G1.toString(h[a].g1_s,16)),o.debug(a+".g1_sx: "+t.G1.toString(h[a].g1_sx,16)),o.debug(a+".g2_sp: "+t.G2.toString(h[a].g2_sp,16)),o.debug(a+".g2_spx: "+t.G2.toString(h[a].g2_spx,16)),o.debug("")}));const m=Ye.exports(64);await g.write(p),m.update(p),await Ro(n,g,m,t,"G1",2**d*2-1,t.Fr.one,h.tau.prvKey,"COMPRESSED","tauG1",o),await Ro(n,g,m,t,"G2",2**d,t.Fr.one,h.tau.prvKey,"COMPRESSED","tauG2",o),await Ro(n,g,m,t,"G1",2**d,h.alpha.prvKey,h.tau.prvKey,"COMPRESSED","alphaTauG1",o),await Ro(n,g,m,t,"G1",2**d,h.beta.prvKey,h.tau.prvKey,"COMPRESSED","betaTauG1",o),await Ro(n,g,m,t,"G2",1,h.beta.prvKey,h.tau.prvKey,"COMPRESSED","betaTauG2",o);const L=new Uint8Array(2*t.F1.n8*6+2*t.F2.n8*3);Go(L,0,t,h,!1),await g.write(L),m.update(L);const w=m.digest();o&&o.info(Ti(w,"Contribution Response Hash: ")),await g.close(),await n.close()},beacon:async function(t,a,e,i,o,n){const c=Vi(i);if(0==c.byteLength||2*c.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(c.length>=256)return n&&n.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;await Ye.exports.ready();const{fd:r,sections:l}=await Ue(t,"ptau",1),{curve:s,power:d,ceremonyPower:u}=await vo(r,l);if(d!=u)return n&&n.error("This file has been reduced. You cannot contribute into a reduced file."),!1;l[12]&&n&&n.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const g=await Uo(r,s,l),_={name:e,type:1,numIterationsExp:o,beaconHash:c};let f;f=g.length>0?g[g.length-1].nextChallenge:Qo(s,d,n),_.key=qo(s,f,c,o);const p=new Ye.exports(64);p.update(f);const h=await Oe(a,"ptau",1,7);await Bo(h,s,d);const m=[];let L;L=await y(2,"G1",2**d*2-1,s.Fr.e(1),_.key.tau.prvKey,"tauG1",n),_.tauG1=L[1],L=await y(3,"G2",2**d,s.Fr.e(1),_.key.tau.prvKey,"tauG2",n),_.tauG2=L[1],L=await y(4,"G1",2**d,_.key.alpha.prvKey,_.key.tau.prvKey,"alphaTauG1",n),_.alphaG1=L[0],L=await y(5,"G1",2**d,_.key.beta.prvKey,_.key.tau.prvKey,"betaTauG1",n),_.betaG1=L[0],L=await y(6,"G2",1,_.key.beta.prvKey,_.key.tau.prvKey,"betaTauG2",n),_.betaG2=L[0],_.partialHash=p.getPartialHash();const w=new Uint8Array(2*s.F1.n8*6+2*s.F2.n8*3);Go(w,0,s,_.key,!1),p.update(new Uint8Array(w));const A=p.digest();n&&n.info(Ti(A,"Contribution Response Hash imported: "));const b=new Ye.exports(64);return b.update(A),await I(h,"G1",2,2**d*2-1,"tauG1",n),await I(h,"G2",3,2**d,"tauG2",n),await I(h,"G1",4,2**d,"alphaTauG1",n),await I(h,"G1",5,2**d,"betaTauG1",n),await I(h,"G2",6,1,"betaG2",n),_.nextChallenge=b.digest(),n&&n.info(Ti(_.nextChallenge,"Next Challenge Hash: ")),g.push(_),await zo(h,s,g),await r.close(),await h.close(),A;async function y(t,a,e,i,o,n,c){const d=[];r.pos=l[t][0].p,await ze(h,t),m[t]=h.pos;const u=s[a],g=2*u.F.n8,_=Math.floor((1<<20)/g);let f=i;for(let t=0;t<e;t+=_){c&&c.debug(`applying key${n}: ${t}/${e}`);const a=Math.min(e-t,_),i=await r.read(a*g),l=await u.batchApplyKey(i,f,o),m=h.write(l),L=await u.batchLEMtoC(l);if(p.update(L),await m,0==t)for(let t=0;t<Math.min(2,e);t++)d.push(u.fromRprLEM(l,t*g));f=s.Fr.mul(f,s.Fr.exp(o,a))}return await Qe(h),d}async function I(t,a,e,i,o,n){const c=s[a],r=2*c.F.n8,l=Math.floor((1<<24)/r),d=t.pos;t.pos=m[e];for(let a=0;a<i;a+=l){n&&n.debug(`Hashing ${o}: ${a}/${i}`);const e=Math.min(i-a,l),s=await t.read(e*r),d=await c.batchLEMtoU(s);b.update(d)}t.pos=d}},contribute:async function(t,a,e,i,o){await Ye.exports.ready();const{fd:n,sections:c}=await Ue(t,"ptau",1),{curve:r,power:l,ceremonyPower:s}=await vo(n,c);if(l!=s)throw o&&o.error("This file has been reduced. You cannot contribute into a reduced file."),new Error("This file has been reduced. You cannot contribute into a reduced file.");c[12]&&o&&o.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const d=await Uo(n,r,c),u={name:e,type:0};let g;const _=await Ni(i);g=d.length>0?d[d.length-1].nextChallenge:Qo(r,l,o),u.key=Eo(r,g,_);const f=new Ye.exports(64);f.update(g);const p=await Oe(a,"ptau",1,7);await Bo(p,r,l);const h=[];let m;m=await b(2,"G1",2**l*2-1,r.Fr.e(1),u.key.tau.prvKey,"tauG1"),u.tauG1=m[1],m=await b(3,"G2",2**l,r.Fr.e(1),u.key.tau.prvKey,"tauG2"),u.tauG2=m[1],m=await b(4,"G1",2**l,u.key.alpha.prvKey,u.key.tau.prvKey,"alphaTauG1"),u.alphaG1=m[0],m=await b(5,"G1",2**l,u.key.beta.prvKey,u.key.tau.prvKey,"betaTauG1"),u.betaG1=m[0],m=await b(6,"G2",1,u.key.beta.prvKey,u.key.tau.prvKey,"betaTauG2"),u.betaG2=m[0],u.partialHash=f.getPartialHash();const L=new Uint8Array(2*r.F1.n8*6+2*r.F2.n8*3);Go(L,0,r,u.key,!1),f.update(new Uint8Array(L));const w=f.digest();o&&o.info(Ti(w,"Contribution Response Hash imported: "));const A=new Ye.exports(64);return A.update(w),await y(p,"G1",2,2**l*2-1,"tauG1"),await y(p,"G2",3,2**l,"tauG2"),await y(p,"G1",4,2**l,"alphaTauG1"),await y(p,"G1",5,2**l,"betaTauG1"),await y(p,"G2",6,1,"betaG2"),u.nextChallenge=A.digest(),o&&o.info(Ti(u.nextChallenge,"Next Challenge Hash: ")),d.push(u),await zo(p,r,d),await n.close(),await p.close(),w;async function b(t,a,e,i,l,s){const d=[];n.pos=c[t][0].p,await ze(p,t),h[t]=p.pos;const u=r[a],g=2*u.F.n8,_=Math.floor((1<<20)/g);let m=i;for(let t=0;t<e;t+=_){o&&o.debug(`processing: ${s}: ${t}/${e}`);const a=Math.min(e-t,_),i=await n.read(a*g),c=await u.batchApplyKey(i,m,l),h=p.write(c),L=await u.batchLEMtoC(c);if(f.update(L),await h,0==t)for(let t=0;t<Math.min(2,e);t++)d.push(u.fromRprLEM(c,t*g));m=r.Fr.mul(m,r.Fr.exp(l,a))}return await Qe(p),d}async function y(t,a,e,i,n){const c=r[a],l=2*c.F.n8,s=Math.floor((1<<24)/l),d=t.pos;t.pos=h[e];for(let a=0;a<i;a+=s){o&&a&&o.debug(`Hashing ${n}: `+a);const e=Math.min(i-a,s),r=await t.read(e*l),d=await c.batchLEMtoU(r);A.update(d)}t.pos=d}},preparePhase2:async function(t,a,e){const{fd:i,sections:o}=await Ue(t,"ptau",1),{curve:n,power:c}=await vo(i,o),r=await Oe(a,"ptau",1,11);return await Bo(r,n,c),await Re(i,o,r,2),await Re(i,o,r,3),await Re(i,o,r,4),await Re(i,o,r,5),await Re(i,o,r,6),await Re(i,o,r,7),await l(2,12,"G1","tauG1"),await l(3,13,"G2","tauG2"),await l(4,14,"G1","alphaTauG1"),await l(5,15,"G1","betaTauG1"),await i.close(),void await r.close();async function l(t,a,l,s){e&&e.debug("Starting section: "+s),await ze(r,a);for(let t=0;t<=c;t++)await d(t);async function d(a){const d=2**a,u=n[l];n.Fr;const g=2*u.F.n8;let _;u.F.n8,_=new Pa(d*g),await qe(i,o,t),2==t&&a==c+1?(await i.readToBuffer(_,0,(d-1)*g),_.set(n.G1.zeroAffine,(d-1)*g)):await i.readToBuffer(_,0,d*g),await Me(i,!0),_=await u.lagrangeEvaluations(_,"affine","affine",e,s),await r.write(_)}2==t&&await d(c+1),await Qe(r)}},truncate:async function(t,a,e){const{fd:i,sections:o}=await Ue(t,"ptau",1),{curve:n,power:c,ceremonyPower:r}=await vo(i,o),l=2*n.G1.F.n8,s=2*n.G2.F.n8;for(let t=1;t<c;t++)await d(t);return await i.close(),!0;async function d(t){let c=t.toString();for(;c.length<2;)c="0"+c;e&&e.debug("Writing Power: "+c);const d=await Oe(a+c+".ptau","ptau",1,11);await Bo(d,n,t,r),await Re(i,o,d,2,(2**t*2-1)*l),await Re(i,o,d,3,2**t*s),await Re(i,o,d,4,2**t*l),await Re(i,o,d,5,2**t*l),await Re(i,o,d,6,s),await Re(i,o,d,7),await Re(i,o,d,12,(2**(t+1)*2-1)*l),await Re(i,o,d,13,(2**t*2-1)*s),await Re(i,o,d,14,(2**t*2-1)*l),await Re(i,o,d,15,(2**t*2-1)*l),await d.close()}},convert:async function(t,a,e){const{fd:i,sections:o}=await Ue(t,"ptau",1),{curve:n,power:c}=await vo(i,o),r=await Oe(a,"ptau",1,11);return await Bo(r,n,c),await Re(i,o,r,2),await Re(i,o,r,3),await Re(i,o,r,4),await Re(i,o,r,5),await Re(i,o,r,6),await Re(i,o,r,7),await async function(t,a,l,s){e&&e.debug("Starting section: "+s);await ze(r,a);const d=o[a][0].size,u=i.pageSize;await qe(i,o,a);for(let t=0;t<d;t+=u){const a=Math.min(d-t,u),e=await i.read(a);await r.write(e)}await Me(i),2==t&&await async function(a){const d=2**a,u=n[l],g=2*u.F.n8;let _;_=new Pa(d*g),await qe(i,o,t),2==t&&a==c+1?(await i.readToBuffer(_,0,(d-1)*g),_.set(n.G1.zeroAffine,(d-1)*g)):await i.readToBuffer(_,0,d*g);await Me(i,!0),_=await u.lagrangeEvaluations(_,"affine","affine",e,s),await r.write(_)}(c+1);await Qe(r)}(2,12,"G1","tauG1"),await Re(i,o,r,13),await Re(i,o,r,14),await Re(i,o,r,15),await i.close(),void await r.close()},exportJson:async function(t,a){const{fd:e,sections:i}=await Ue(t,"ptau",1),{curve:o,power:n}=await vo(e,i),c={};return c.q=o.q,c.power=n,c.contributions=await Uo(e,o,i),c.tauG1=await r(2,"G1",2**n*2-1,"tauG1"),c.tauG2=await r(3,"G2",2**n,"tauG2"),c.alphaTauG1=await r(4,"G1",2**n,"alphaTauG1"),c.betaTauG1=await r(5,"G1",2**n,"betaTauG1"),c.betaG2=await r(6,"G2",1,"betaG2"),c.lTauG1=await l(12,"G1","lTauG1"),c.lTauG2=await l(13,"G2","lTauG2"),c.lAlphaTauG1=await l(14,"G1","lAlphaTauG2"),c.lBetaTauG1=await l(15,"G1","lBetaTauG2"),await e.close(),Hi(o.Fr,c);async function r(t,n,c,r){const l=o[n],s=2*l.F.n8,d=[];await qe(e,i,t);for(let t=0;t<c;t++){a&&t&&t%1e4==0&&console.log(`${r}: `+t);const i=await e.read(s);d.push(l.fromRprLEM(i,0))}return await Me(e),d}async function l(t,c,r){const l=o[c],s=2*l.F.n8,d=[];await qe(e,i,t);for(let t=0;t<=n;t++){a&&console.log(`${r}: Power: ${t}`),d[t]=[];const i=2**t;for(let o=0;o<i;o++){a&&o&&o%1e4==0&&console.log(`${r}: ${o}/${i}`);const n=await e.read(s);d[t].push(l.fromRprLEM(n,0))}}return await Me(e,!0),d}}});const No=262144,Ko={get:function(t,a){return isNaN(a)?t[a]:t.getElement(a)},set:function(t,a,e){return isNaN(a)?(t[a]=e,!0):t.setElement(a,e)}};class Vo{constructor(t){this.length=t||0,this.arr=new Array(No);for(let a=0;a<t;a+=No)this.arr[a/No]=new Array(Math.min(No,t-a));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,a){const e=new Array(a-t);for(let i=t;i<a;i++)e[i-t]=this.getElement(i);return e}getElement(t){t=parseInt(t);const a=Math.floor(t/No),e=t%No;return this.arr[a]?this.arr[a][e]:void 0}setElement(t,a){t=parseInt(t);const e=Math.floor(t/No);this.arr[e]||(this.arr[e]=new Array(No));const i=t%No;return this.arr[e][i]=a,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new jo;for(let a=0;a<this.arr.length;a++)if(this.arr[a])for(let e=0;e<this.arr[a].length;e++)void 0!==this.arr[a][e]&&t.push(a*No+e);return t}}class jo{constructor(t){const a=new Vo(t);return new Proxy(a,Ko)}}async function Ho(t,a,e){let i;i="object"==typeof e?e:void 0===e?{singleThread:!1}:{singleThread:e};const o={};if(await qe(t,a,1),o.n8=await t.readULE32(),o.prime=await ke(t,o.n8),i.F){if(i.F.p!=o.prime)throw new Error("Different Prime");o.F=i.F}else if(i.getFieldFromPrime)o.F=await i.getFieldFromPrime(o.prime,i.singleThread);else if(i.getCurveFromPrime)o.curve=await i.getCurveFromPrime(o.prime,i.singleThread),o.F=o.curve.Fr;else try{o.curve=await async function(t,a,e){let i;if(b(t,fe))i=await ue(a,e);else{if(!b(t,_e))throw new Error(`Curve not supported: ${v(t)}`);i=await ge(a,e)}return i}(o.prime,i.singleThread),o.F=o.curve.Fr}catch(t){o.F=new V(o.prime)}return o.nVars=await t.readULE32(),o.nOutputs=await t.readULE32(),o.nPubInputs=await t.readULE32(),o.nPrvInputs=await t.readULE32(),o.nLabels=await t.readULE64(),o.nConstraints=await t.readULE32(),o.useCustomGates=void 0!==a[4]&&null!==a[4]&&void 0!==a[5]&&null!==a[5],await Me(t),o}async function $o(t,a,e){if("object"!=typeof e)throw new Error("readR1csFd: options must be an object");e.loadConstraints=e.loadConstraints||!0,e.loadMap=e.loadMap||!1,e.loadCustomGates=e.loadCustomGates||!0;const i=await Ho(t,a,e);return e.loadConstraints&&(i.constraints=await async function(t,a,e,i,o){let n;n="object"==typeof i?i:void 0===i?{}:{logger:i,loggerCtx:o};const c=await De(t,a,2);let r,l=0;r=e.nConstraints>1<<20?new jo:[];for(let t=0;t<e.nConstraints;t++){n.logger&&t%1e5==0&&n.logger.info(`${n.loggerCtx}: Loading constraints: ${t}/${e.nConstraints}`);const a=s();r.push(a)}return r;function s(){const t=[];return t[0]=d(),t[1]=d(),t[2]=d(),t}function d(){const t={},a=c.slice(l,l+4);l+=4;const i=new DataView(a.buffer).getUint32(0,!0),o=c.slice(l,l+(4+e.n8)*i);l+=(4+e.n8)*i;const n=new DataView(o.buffer);for(let a=0;a<i;a++){const i=n.getUint32(a*(4+e.n8),!0),c=e.F.fromRprLE(o,a*(4+e.n8)+4);t[i]=c}return t}}(t,a,i,e)),e.loadMap&&(i.map=await async function(t,a,e,i,o){let n;n="object"==typeof i?i:void 0===i?{}:{logger:i,loggerCtx:o};const c=await De(t,a,3);let r,l=0;r=e.nVars>1<<20?new jo:[];for(let t=0;t<e.nVars;t++){n.logger&&t%1e4==0&&n.logger.info(`${n.loggerCtx}: Loading map: ${t}/${e.nVars}`);const a=s();r.push(a)}return r;function s(){const t=c.slice(l,l+8);l+=8;const a=new DataView(t.buffer),e=a.getUint32(0,!0);return 4294967296*a.getUint32(4,!0)+e}}(t,a,i,e)),e.loadCustomGates&&(i.useCustomGates?(i.customGates=await async function(t,a,e){await qe(t,a,4);let i=await t.readULE32(),o=[];for(let a=0;a<i;a++){let a={};a.templateName=await t.readString();let i=await t.readULE32();a.parameters=Array(i);let n=await t.read(e*i);for(let t=0;t<i;t++)a.parameters[t]=n.slice(t*e,t*e+e);o.push(a)}return await Me(t),o}(t,a,i.F.n8),i.customGatesUses=await async function(t,a,e){const i=await De(t,a,5),o=new Uint32Array(i.buffer,i.byteOffset,i.byteLength/4),n=o[0];let c,r=1;c=n>1<<20?new jo:[];for(let t=0;t<n;t++){e.logger&&t%1e5==0&&e.logger.info(`${e.loggerCtx}: Loading custom gate uses: ${t}/${n}`);let a={};a.id=o[r++];let i=o[r++];a.signals=[];for(let t=0;t<i;t++){const t=o[r++],e=o[r++];a.signals.push(4294967296*e+t)}c.push(a)}return c}(t,a,e)):(i.customGates=[],i.customGatesUses=[])),i}async function Yo(t,a,e,i,o,n){let c;c="object"==typeof a?a:void 0===a?{loadConstraints:!0,loadMap:!1,loadCustomGates:!0}:{loadConstraints:a,loadMap:e,singleThread:i,logger:o,loggerCtx:n};const{fd:r,sections:l}=await Ue(t,"r1cs",1),s=await $o(r,l,c);return await r.close(),s}const Wo=pe.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Zo=pe.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");var Jo=Object.freeze({__proto__:null,print:function(t,a,e){for(let a=0;a<t.constraints.length;a++)i(t.constraints[a]);function i(i){const o=e=>{let i="";return Object.keys(e).forEach((o=>{let n=a.varIdx2Name[o];"one"==n&&(n="");let c=t.curve.Fr.toString(e[o]);"1"==c&&(c=""),"-1"==c&&(c="-"),""!=i&&"-"!=c[0]&&(c="+"+c),""!=i&&(c=" "+c),i=i+c+n})),i},n=`[ ${o(i[0])} ] * [ ${o(i[1])} ] - [ ${o(i[2])} ] = 0`;e&&e.info(n)}},info:async function(t,a){const e=await Yo(t);return pe.eq(e.prime,Zo)?a&&a.info("Curve: bn-128"):pe.eq(e.prime,Wo)?a&&a.info("Curve: bls12-381"):a&&a.info(`Unknown Curve. Prime: ${pe.toString(e.prime)}`),a&&a.info(`# of Wires: ${e.nVars}`),a&&a.info(`# of Constraints: ${e.nConstraints}`),a&&a.info(`# of Private Inputs: ${e.nPrvInputs}`),a&&a.info(`# of Public Inputs: ${e.nPubInputs}`),a&&a.info(`# of Labels: ${e.nLabels}`),a&&a.info(`# of Outputs: ${e.nOutputs}`),e},exportJson:async function(t,a){const e=await Yo(t,!0,!0,!0,a),i=e.curve.Fr;return delete e.curve,delete e.F,Hi(i,e)}});async function Xo(t){const a={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},e=await Pe(t),i=await e.read(e.totalSize),o=new TextDecoder("utf-8").decode(i).split("\n");for(let t=0;t<o.length;t++){const e=o[t].split(",");4==e.length&&(a.varIdx2Name[e[1]]?a.varIdx2Name[e[1]]+="|"+e[3]:a.varIdx2Name[e[1]]=e[3],a.labelIdx2Name[e[0]]=e[3],a.componentIdx2Name[e[2]]||(a.componentIdx2Name[e[2]]=n(e[3])))}return await e.close(),a;function n(t){const a=t.split(".");return a.pop(),a.join(".")}}const{unstringifyBigInts:tn}=he;var an=Object.freeze({__proto__:null,calculate:Lo,debug:async function(t,a,e,i,o,n){const c=tn(t),r=await Pe(a),l=await r.read(r.totalSize);await r.close();let s={sanityCheck:!0},d=await Xo(i);o.set&&(d||(d=await Xo(i)),s.logSetSignal=function(t,a){n&&n.info("SET "+d.labelIdx2Name[t]+" <-- "+a.toString())}),o.get&&(d||(d=await Xo(i)),s.logGetSignal=function(t,a){n&&n.info("GET "+d.labelIdx2Name[t]+" --\x3e "+a.toString())}),o.trigger&&(d||(d=await Xo(i)),s.logStartComponent=function(t){n&&n.info("START: "+d.componentIdx2Name[t])},s.logFinishComponent=function(t){n&&n.info("FINISH: "+d.componentIdx2Name[t])}),s.sym=d;const u=await fo(l,s),g=await u.calculateWitness(c),_=await Oe(e,"wtns",2,2);await async function(t,a,e){await ze(t,1);const i=8*(Math.floor((pe.bitLength(e)-1)/64)+1);await t.writeULE32(i),await Te(t,e,i),await t.writeULE32(a.length),await Qe(t),await ze(t,2);for(let e=0;e<a.length;e++)await Te(t,a[e],i);await Qe(t)}(_,g,u.prime),await _.close()},exportJson:async function(t){return await async function(t){const{fd:a,sections:e}=await Ue(t,"wtns",2),{n8:i,nWitness:o}=await co(a,e);await qe(a,e,2);const n=[];for(let t=0;t<o;t++){const t=await ke(a,i);n.push(t)}return await Me(a),await a.close(),n}(t)}});const en=262144,on={get:function(t,a){return isNaN(a)?t[a]:t.getElement(a)},set:function(t,a,e){return isNaN(a)?(t[a]=e,!0):t.setElement(a,e)}};class nn{constructor(t){this.length=t||0,this.arr=new Array(en);for(let a=0;a<t;a+=en)this.arr[a/en]=new Array(Math.min(en,t-a));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,a){const e=new Array(a-t);for(let i=t;i<a;i++)e[i-t]=this.getElement(i);return e}getElement(t){t=parseInt(t);const a=Math.floor(t/en),e=t%en;return this.arr[a]?this.arr[a][e]:void 0}setElement(t,a){t=parseInt(t);const e=Math.floor(t/en);this.arr[e]||(this.arr[e]=new Array(en));const i=t%en;return this.arr[e][i]=a,t>=this.length&&(this.length=t+1),!0}getKeys(){const t=new cn;for(let a=0;a<this.arr.length;a++)if(this.arr[a])for(let e=0;e<this.arr[a].length;e++)void 0!==this.arr[a][e]&&t.push(a*en+e);return t}}class cn{constructor(t){const a=new nn(t);return new Proxy(a,on)}}async function rn(t,a,e,i){await Ye.exports.ready();const o=Ye.exports(64),{fd:n,sections:c}=await Ue(a,"ptau",1),{curve:r,power:l}=await vo(n,c),{fd:s,sections:d}=await Ue(t,"r1cs",1),u=await Ho(s,d,!1),g=await Oe(e,"zkey",1,10,1<<22,1<<24),_=2*r.G1.F.n8,f=2*r.G2.F.n8;if(u.prime!=r.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;const p=Mi(u.nConstraints+u.nPubInputs+u.nOutputs+1-1)+1;if(p>l)return i&&i.error(`circuit too big for this power of tau ceremony. ${u.nConstraints}*2 > 2**${l}`),-1;if(!c[12])return i&&i.error("Powers of tau is not prepared."),-1;const h=u.nOutputs+u.nPubInputs,m=2**p;await ze(g,1),await g.writeULE32(1),await Qe(g),await ze(g,2);const L=r.q,w=8*(Math.floor((pe.bitLength(L)-1)/64)+1),A=r.r,b=8*(Math.floor((pe.bitLength(A)-1)/64)+1),y=pe.mod(pe.shl(1,8*b),A),I=r.Fr.e(pe.mod(pe.mul(y,y),A));let C,x,F;await g.writeULE32(w),await Te(g,L,w),await g.writeULE32(b),await Te(g,A,b),await g.writeULE32(u.nVars),await g.writeULE32(h),await g.writeULE32(m),C=await n.read(_,c[4][0].p),await g.write(C),C=await r.G1.batchLEMtoU(C),o.update(C),x=await n.read(_,c[5][0].p),await g.write(x),x=await r.G1.batchLEMtoU(x),o.update(x),F=await n.read(f,c[6][0].p),await g.write(F),F=await r.G2.batchLEMtoU(F),o.update(F);const E=new Uint8Array(_);r.G1.toRprLEM(E,0,r.G1.g);const B=new Uint8Array(f);r.G2.toRprLEM(B,0,r.G2.g);const v=new Uint8Array(_);r.G1.toRprUncompressed(v,0,r.G1.g);const S=new Uint8Array(f);r.G2.toRprUncompressed(S,0,r.G2.g),await g.write(B),await g.write(E),await g.write(B),o.update(S),o.update(v),o.update(S),await Qe(g),i&&i.info("Reading r1cs");let G=await De(s,d,2);const P=new cn(u.nVars),U=new cn(u.nVars),O=new cn(u.nVars),z=new cn(u.nVars-h-1),Q=new Array(h+1);i&&i.info("Reading tauG1");let q=await De(n,c,12,(m-1)*_,m*_);i&&i.info("Reading tauG2");let M=await De(n,c,13,(m-1)*f,m*f);i&&i.info("Reading alphatauG1");let T=await De(n,c,14,(m-1)*_,m*_);i&&i.info("Reading betatauG1");let k=await De(n,c,15,(m-1)*_,m*_);await async function(){const t=new Uint8Array(12+r.Fr.n8),a=new DataView(t.buffer),e=new Uint8Array(r.Fr.n8);r.Fr.toRprLE(e,0,r.Fr.e(1));let o=0;function n(){const t=G.slice(o,o+4);o+=4;return new DataView(t.buffer).getUint32(0,!0)}const c=new cn;for(let t=0;t<u.nConstraints;t++){i&&t%1e4==0&&i.debug(`processing constraints: ${t}/${u.nConstraints}`);const a=n();for(let e=0;e<a;e++){const a=n(),e=o;o+=r.Fr.n8;const i=0,l=_*t,s=3,d=_*t;void 0===P[a]&&(P[a]=[]),P[a].push([i,l,e]),a<=h?(void 0===Q[a]&&(Q[a]=[]),Q[a].push([s,d,e])):(void 0===z[a-h-1]&&(z[a-h-1]=[]),z[a-h-1].push([s,d,e])),c.push([0,t,a,e])}const e=n();for(let a=0;a<e;a++){const a=n(),e=o;o+=r.Fr.n8;const i=0,l=_*t,s=1,d=f*t,u=2,g=_*t;void 0===U[a]&&(U[a]=[]),U[a].push([i,l,e]),void 0===O[a]&&(O[a]=[]),O[a].push([s,d,e]),a<=h?(void 0===Q[a]&&(Q[a]=[]),Q[a].push([u,g,e])):(void 0===z[a-h-1]&&(z[a-h-1]=[]),z[a-h-1].push([u,g,e])),c.push([1,t,a,e])}const l=n();for(let a=0;a<l;a++){const a=n(),e=o;o+=r.Fr.n8;const i=0,c=_*t;a<=h?(void 0===Q[a]&&(Q[a]=[]),Q[a].push([i,c,e])):(void 0===z[a-h-1]&&(z[a-h-1]=[]),z[a-h-1].push([i,c,e]))}}for(let t=0;t<=h;t++){const a=0,e=_*(u.nConstraints+t),i=3,o=_*(u.nConstraints+t);void 0===P[t]&&(P[t]=[]),P[t].push([a,e,-1]),void 0===Q[t]&&(Q[t]=[]),Q[t].push([i,o,-1]),c.push([0,u.nConstraints+t,t,-1])}await ze(g,4);const l=new Pa(c.length*(12+r.Fr.n8)+4),s=new Uint8Array(4);new DataView(s.buffer).setUint32(0,c.length,!0),l.set(s);let d=4;for(let t=0;t<c.length;t++)i&&t%1e5==0&&i.debug(`writing coeffs: ${t}/${c.length}`),p(c[t]);function p(i){let o;a.setUint32(0,i[0],!0),a.setUint32(4,i[1],!0),a.setUint32(8,i[2],!0),o=i[3]>=0?r.Fr.fromRprLE(G.slice(i[3],i[3]+r.Fr.n8),0):r.Fr.fromRprLE(e,0);const n=r.Fr.mul(o,I);r.Fr.toRprLE(t,12,n),l.set(t,d),d+=t.length}await g.write(l),await Qe(g)}(),await D(3,"G1",Q,"IC"),await async function(){await ze(g,9);const t=new Pa(m*_);if(p<r.Fr.s){let a=await De(n,c,12,(2*m-1)*_,2*m*_);for(let e=0;e<m;e++){i&&e%1e4==0&&i.debug(`spliting buffer: ${e}/${m}`);const o=a.slice((2*e+1)*_,(2*e+1)*_+_);t.set(o,e*_)}}else{if(p!=r.Fr.s)throw i&&i.error("Circuit too big"),new Error("Circuit too big for this curve");{const a=c[12][0].p+(2**(p+1)-1)*_;await n.readToBuffer(t,0,m*_,a+m*_)}}await g.write(t),await Qe(g)}(),await async function(){j(m-1);for(let t=0;t<m-1;t+=16384){i&&i.debug(`HashingHPoints: ${t}/${m}`);const a=Math.min(m-1,16384);await K(t,a)}}(),await D(8,"G1",z,"C"),await D(5,"G1",P,"A"),await D(6,"G1",U,"B1"),await D(7,"G2",O,"B2");const R=o.digest();return await ze(g,10),await g.write(R),await g.writeULE32(0),await Qe(g),i&&i.info(Ti(R,"Circuit hash: ")),await g.close(),await s.close(),await n.close(),R;async function D(t,a,e,n){const c=r[a];j(e.length),await ze(g,t);let l=[],s=0;for(;s<e.length;){let t=0;for(;s<e.length&&t<r.tm.concurrency;){i&&i.debug(`Writing points start ${n}: ${s}/${e.length}`);let o=1,c=e[s]?e[s].length:0;for(;s+o<e.length&&c+(e[s+o]?e[s+o].length:0)<32768&&o<32768;)c+=e[s+o]?e[s+o].length:0,o++;const r=e.slice(s,s+o),d=s;l.push(N(a,r,i,n).then((t=>(i&&i.debug(`Writing points end ${n}: ${d}/${e.length}`),t)))),s+=o,t++}const d=await Promise.all(l);for(let t=0;t<d.length;t++){await g.write(d[t][0]);const a=await c.batchLEMtoU(d[t][0]);o.update(a)}l=[]}await Qe(g)}async function N(t,a,e,i){const o=r[t],n=2*o.F.n8,c=3*o.F.n8,l=2*o.F.n8;let s,d,u,g;if("G1"==t)s="g1m_timesScalarAffine",d="g1m_multiexpAffine",u="g1m_batchToAffine",g="g1m_zero";else{if("G2"!=t)throw new Error("Invalid group");s="g2m_timesScalarAffine",d="g2m_multiexpAffine",u="g2m_batchToAffine",g="g2m_zero"}let _,f,p=0;for(let t=0;t<a.length;t++)p+=a[t]?a[t].length:0;p>32768?(_=new Pa(p*n),f=new Pa(p*r.Fr.n8)):(_=new Uint8Array(p*n),f=new Uint8Array(p*r.Fr.n8));let h=0,m=0;const L=[q,M,T,k],w=new Uint8Array(r.Fr.n8);r.Fr.toRprLE(w,0,r.Fr.e(1));let A=0;for(let t=0;t<a.length;t++)if(a[t])for(let o=0;o<a[t].length;o++)e&&o&&o%1e4==0&&e.debug(`Configuring big array ${i}: ${o}/${a[t].length}`),_.set(L[a[t][o][0]].slice(a[t][o][1],a[t][o][1]+n),A*n),a[t][o][2]>=0?f.set(G.slice(a[t][o][2],a[t][o][2]+r.Fr.n8),A*r.Fr.n8):f.set(w,A*r.Fr.n8),A++;if(a.length>1){const t=[];t.push({cmd:"ALLOCSET",var:0,buff:_}),t.push({cmd:"ALLOCSET",var:1,buff:f}),t.push({cmd:"ALLOC",var:2,len:a.length*c}),h=0,m=0;let e=0;for(let i=0;i<a.length;i++)a[i]?(1==a[i].length?t.push({cmd:"CALL",fnName:s,params:[{var:0,offset:h},{var:1,offset:m},{val:r.Fr.n8},{var:2,offset:e}]}):t.push({cmd:"CALL",fnName:d,params:[{var:0,offset:h},{var:1,offset:m},{val:r.Fr.n8},{val:a[i].length},{var:2,offset:e}]}),h+=n*a[i].length,m+=r.Fr.n8*a[i].length,e+=c):(t.push({cmd:"CALL",fnName:g,params:[{var:2,offset:e}]}),e+=c);t.push({cmd:"CALL",fnName:u,params:[{var:2},{val:a.length},{var:2}]}),t.push({cmd:"GET",out:0,var:2,len:a.length*l});return await r.tm.queueAction(t)}{let t=await o.multiExpAffine(_,f,e,i);return t=[o.toAffine(t)],t}}async function K(t,a){const e=await n.read(a*_,c[2][0].p+(t+m)*_),i=await n.read(a*_,c[2][0].p+t*_),l=r.tm.concurrency,s=Math.floor(a/l),d=[];for(let t=0;t<l;t++){let o;if(o=t<l-1?s:a-t*s,0==o)continue;const n=e.slice(t*s*_,(t*s+o)*_),c=i.slice(t*s*_,(t*s+o)*_);d.push(V(n,c))}const u=await Promise.all(d);for(let t=0;t<u.length;t++)o.update(u[t][0])}async function V(t,a){const e=t.byteLength/_,i=3*r.G1.F.n8,o=[];o.push({cmd:"ALLOCSET",var:0,buff:t}),o.push({cmd:"ALLOCSET",var:1,buff:a}),o.push({cmd:"ALLOC",var:2,len:e*i});for(let t=0;t<e;t++)o.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*_},{var:1,offset:t*_},{var:2,offset:t*i}]});o.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:e},{var:2}]}),o.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:e},{var:2}]}),o.push({cmd:"GET",out:0,var:2,len:e*_});return await r.tm.queueAction(o)}function j(t){const a=new Uint8Array(4);new DataView(a.buffer,a.byteOffset,a.byteLength).setUint32(0,t,!1),o.update(a)}}const ln=Di;async function sn(t,a,e,i){let o;await Ye.exports.ready();const{fd:n,sections:c}=await Ue(e,"zkey",2),r=await Xi(n,c,!1);if("groth16"!=r.protocol)throw new Error("zkey file is not groth16");const l=await He(r.q),s=2*l.G1.F.n8,d=await ao(n,l,c),u=Ye.exports(64);u.update(d.csHash);let g=l.G1.g;for(let t=0;t<d.contributions.length;t++){const a=d.contributions[t],e=Ri(u);if(oo(e,l,a.delta.g1_s),oo(e,l,a.delta.g1_sx),!ki(e.digest(),a.transcript))return console.log(`INVALID(${t}): Inconsistent transcript `),!1;const i=Co(l,a.transcript);if(o=await ln(l,a.delta.g1_s,a.delta.g1_sx,i,a.delta.g2_spx),!0!==o)return console.log(`INVALID(${t}): public key G1 and G2 do not have the same ration `),!1;if(o=await ln(l,g,a.deltaAfter,i,a.delta.g2_spx),!0!==o)return console.log(`INVALID(${t}): deltaAfter does not fillow the public key `),!1;if(1==a.type){const e=Ki(a.beaconHash,a.numIterationsExp),i=l.Fr.fromRng(e),o=l.G1.toAffine(l.G1.fromRng(e)),n=l.G1.toAffine(l.G1.timesFr(o,i));if(!0!==l.G1.eq(o,a.delta.g1_s))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_s `),!1;if(!0!==l.G1.eq(n,a.delta.g1_sx))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_sx `),!1}no(u,l,a);const n=Ye.exports(64);no(n,l,a),a.contributionHash=n.digest(),g=a.deltaAfter}const{fd:_,sections:f}=await Ue(t,"zkey",2),p=await Xi(_,f,!1);if("groth16"!=p.protocol)throw new Error("zkeyinit file is not groth16");if(!pe.eq(p.q,r.q)||!pe.eq(p.r,r.r)||p.n8q!=r.n8q||p.n8r!=r.n8r)return i&&i.error("INVALID:  Different curves"),!1;if(p.nVars!=r.nVars||p.nPublic!=r.nPublic||p.domainSize!=r.domainSize)return i&&i.error("INVALID:  Different circuit parameters"),!1;if(!l.G1.eq(r.vk_alpha_1,p.vk_alpha_1))return i&&i.error("INVALID:  Invalid alpha1"),!1;if(!l.G1.eq(r.vk_beta_1,p.vk_beta_1))return i&&i.error("INVALID:  Invalid beta1"),!1;if(!l.G2.eq(r.vk_beta_2,p.vk_beta_2))return i&&i.error("INVALID:  Invalid beta2"),!1;if(!l.G2.eq(r.vk_gamma_2,p.vk_gamma_2))return i&&i.error("INVALID:  Invalid gamma2"),!1;if(!l.G1.eq(r.vk_delta_1,g))return i&&i.error("INVALID:  Invalid delta1"),!1;if(o=await ln(l,l.G1.g,g,l.G2.g,r.vk_delta_2),!0!==o)return i&&i.error("INVALID:  Invalid delta2"),!1;const h=await ao(_,l,f);if(!ki(d.csHash,h.csHash))return i&&i.error("INVALID:  Circuit does not match"),!1;if(c[8][0].size!=s*(r.nVars-r.nPublic-1))return i&&i.error("INVALID:  Invalid L section size"),!1;if(c[9][0].size!=s*r.domainSize)return i&&i.error("INVALID:  Invalid H section size"),!1;let m;if(m=await Ne(n,c,_,f,3),!m)return i&&i.error("INVALID:  IC section is not identical"),!1;if(m=await Ne(n,c,_,f,4),!m)return i&&i.error("Coeffs section is not identical"),!1;if(m=await Ne(n,c,_,f,5),!m)return i&&i.error("A section is not identical"),!1;if(m=await Ne(n,c,_,f,6),!m)return i&&i.error("B1 section is not identical"),!1;if(m=await Ne(n,c,_,f,7),!m)return i&&i.error("B2 section is not identical"),!1;if(o=await async function(t,a,e,n,c,r,s,d,u){const g=1<<20,_=l[t],f=2*_.F.n8;await qe(a,e,r),await qe(n,c,r);let p=_.zero,h=_.zero;const m=e[r][0].size/f;for(let t=0;t<m;t+=g){i&&i.debug(`Same ratio check ${u}:  ${t}/${m}`);const e=Math.min(m-t,g),o=await a.read(e*f),c=await n.read(e*f),r=new Uint8Array(4*e);M.randomFillSync(r);const l=await _.multiExpAffine(o,r),s=await _.multiExpAffine(c,r);p=_.add(p,l),h=_.add(h,s)}return await Me(a),await Me(n),0==m||(o=await ln(l,p,h,s,d),!0===o)}("G1",_,f,n,c,8,r.vk_delta_2,p.vk_delta_2,"L section"),!0!==o)return i&&i.error("L section does not match"),!1;if(o=await async function(){const t=1<<20,e=l.G1,s=l.Fr,d=2*e.F.n8,{fd:u,sections:g}=await Ue(a,"ptau",1);let _=new Pa(r.domainSize*r.n8r);const f=new Array(8);for(let t=0;t<8;t++)f[t]=M.randomBytes(4).readUInt32BE(0,!0);const h=new q(f);for(let t=0;t<r.domainSize-1;t++){const a=s.fromRng(h);s.toRprLE(_,t*r.n8r,a)}s.toRprLE(_,(r.domainSize-1)*r.n8r,s.zero);let m,w=e.zero;for(let a=0;a<r.domainSize;a+=t){i&&i.debug(`H Verificaition(tau):  ${a}/${r.domainSize}`);const o=Math.min(r.domainSize-a,t),n=await u.read(d*o,g[2][0].p+r.domainSize*d+a*d),c=await u.read(d*o,g[2][0].p+a*d),l=await L(n,c),s=_.slice(a*r.n8r,(a+o)*r.n8r),f=await e.multiExpAffine(l,s);w=e.add(w,f)}if(_=await s.batchToMontgomery(_),r.power<s.s)m=s.neg(s.e(2));else{const t=2**s.s,a=s.exp(s.shift,t);m=s.sub(a,s.one)}const A=r.power<s.s?s.w[r.power+1]:s.shift;_=await s.batchApplyKey(_,m,A),_=await s.fft(_),_=await s.batchFromMontgomery(_),await qe(n,c,9);let b=e.zero;for(let a=0;a<r.domainSize;a+=t){i&&i.debug(`H Verificaition(lagrange):  ${a}/${r.domainSize}`);const o=Math.min(r.domainSize-a,t),c=await n.read(d*o),l=_.slice(a*r.n8r,(a+o)*r.n8r),s=await e.multiExpAffine(c,l);b=e.add(b,s)}return await Me(n),o=await ln(l,w,b,r.vk_delta_2,p.vk_delta_2),!0===o}(),!0!==o)return i&&i.error("H section does not match"),!1;i&&i.info(Ti(d.csHash,"Circuit Hash: ")),await n.close(),await _.close();for(let t=d.contributions.length-1;t>=0;t--){const a=d.contributions[t];i&&i.info("-------------------------"),i&&i.info(Ti(a.contributionHash,`contribution #${t+1} ${a.name?a.name:""}:`)),1==a.type&&(i&&i.info(`Beacon generator: ${ji(a.beaconHash)}`),i&&i.info(`Beacon iterations Exp: ${a.numIterationsExp}`))}return i&&i.info("-------------------------"),i&&i.info("ZKey Ok!"),!0;async function L(t,a){const e=2*l.G1.F.n8,i=t.byteLength/e,o=l.tm.concurrency,n=Math.floor(i/o),c=[];for(let e=0;e<o;e++){let r;if(r=e<o-1?n:i-e*n,0==r)continue;const l=t.slice(e*n*s,(e*n+r)*s),d=a.slice(e*n*s,(e*n+r)*s);c.push(w(l,d))}const r=await Promise.all(c),d=new Uint8Array(i*e);let u=0;for(let t=0;t<r.length;t++)d.set(r[t][0],u),u+=r[t][0].byteLength;return d}async function w(t,a){const e=2*l.G1.F.n8,i=3*l.G1.F.n8,o=t.byteLength/e,n=[];n.push({cmd:"ALLOCSET",var:0,buff:t}),n.push({cmd:"ALLOCSET",var:1,buff:a}),n.push({cmd:"ALLOC",var:2,len:o*i});for(let t=0;t<o;t++)n.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*e},{var:1,offset:t*e},{var:2,offset:t*i}]});n.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:o},{var:2}]}),n.push({cmd:"GET",out:0,var:2,len:o*e});return await l.tm.queueAction(n)}}const{stringifyBigInts:dn}=he;async function un(t){const{fd:a,sections:e}=await Ue(t,"zkey",2),i=await Xi(a,e);let o;if("groth16"==i.protocol)o=await async function(t,a,e){const i=await He(t.q),o=2*i.G1.F.n8,n=await i.pairing(t.vk_alpha_1,t.vk_beta_2);let c={protocol:t.protocol,curve:i.name,nPublic:t.nPublic,vk_alpha_1:i.G1.toObject(t.vk_alpha_1),vk_beta_2:i.G2.toObject(t.vk_beta_2),vk_gamma_2:i.G2.toObject(t.vk_gamma_2),vk_delta_2:i.G2.toObject(t.vk_delta_2),vk_alphabeta_12:i.Gt.toObject(n)};await qe(a,e,3),c.IC=[];for(let e=0;e<=t.nPublic;e++){const t=await a.read(o),e=i.G1.toObject(t);c.IC.push(e)}return await Me(a),c=dn(c),c}(i,a,e);else{if("plonk"!=i.protocol)throw new Error("zkey file is not groth16");o=await async function(t){const a=await He(t.q);let e={protocol:t.protocol,curve:a.name,nPublic:t.nPublic,power:t.power,k1:a.Fr.toObject(t.k1),k2:a.Fr.toObject(t.k2),Qm:a.G1.toObject(t.Qm),Ql:a.G1.toObject(t.Ql),Qr:a.G1.toObject(t.Qr),Qo:a.G1.toObject(t.Qo),Qc:a.G1.toObject(t.Qc),S1:a.G1.toObject(t.S1),S2:a.G1.toObject(t.S2),S3:a.G1.toObject(t.S3),X_2:a.G2.toObject(t.X_2),w:a.Fr.toObject(a.Fr.w[t.power])};return e=dn(e),e}(i)}return await a.close(),o}var gn={};var _n=Object.freeze({__proto__:null,newZKey:rn,exportBellman:async function(t,a,e){const{fd:i,sections:o}=await Ue(t,"zkey",2),n=await Xi(i,o);if("groth16"!=n.protocol)throw new Error("zkey file is not groth16");const c=await He(n.q),r=2*c.G1.F.n8,l=2*c.G2.F.n8,s=await ao(i,c,o),d=await Ge(a);let u;await L(n.vk_alpha_1),await L(n.vk_beta_1),await w(n.vk_beta_2),await w(n.vk_gamma_2),await L(n.vk_delta_1),await w(n.vk_delta_2),u=await De(i,o,3),u=await c.G1.batchLEMtoU(u),await A("G1",u);const g=await De(i,o,9);let _,f,p,h,m;_=await c.G1.fft(g,"affine","jacobian",e),_=await c.G1.batchApplyKey(_,c.Fr.neg(c.Fr.e(2)),c.Fr.w[n.power+1],"jacobian","affine",e),_=_.slice(0,_.byteLength-r),_=await c.G1.batchLEMtoU(_),await A("G1",_),f=await De(i,o,8),f=await c.G1.batchLEMtoU(f),await A("G1",f),p=await De(i,o,5),p=await c.G1.batchLEMtoU(p),await A("G1",p),h=await De(i,o,6),h=await c.G1.batchLEMtoU(h),await A("G1",h),m=await De(i,o,7),m=await c.G2.batchLEMtoU(m),await A("G2",m),await d.write(s.csHash),await async function(t){const a=new Uint8Array(4);new DataView(a.buffer,a.byteOffset,a.byteLength).setUint32(0,t,!1),await d.write(a)}(s.contributions.length);for(let t=0;t<s.contributions.length;t++){const a=s.contributions[t];await L(a.deltaAfter),await L(a.delta.g1_s),await L(a.delta.g1_sx),await w(a.delta.g2_spx),await d.write(a.transcript)}async function L(t){const a=new Uint8Array(r);c.G1.toRprUncompressed(a,0,t),await d.write(a)}async function w(t){const a=new Uint8Array(l);c.G2.toRprUncompressed(a,0,t),await d.write(a)}async function A(t,a){let e;e="G1"==t?r:l;const i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,a.byteLength/e,!1),await d.write(i),await d.write(a)}await i.close(),await d.close()},importBellman:async function(t,a,e,i,o){const{fd:n,sections:c}=await Ue(t,"zkey",2),r=await Xi(n,c,!1);if("groth16"!=r.protocol)throw new Error("zkey file is not groth16");const l=await He(r.q),s=2*l.G1.F.n8,d=2*l.G2.F.n8,u=await ao(n,l,c),g={},_=await Pe(a);_.pos=3*s+3*d+8+s*r.nVars+4+s*(r.domainSize-1)+4+s*r.nVars+4+s*r.nVars+4+d*r.nVars,g.csHash=await _.read(64);const f=await _.readUBE32();g.contributions=[];for(let t=0;t<f;t++){const a={delta:{}};a.deltaAfter=await y(_),a.delta.g1_s=await y(_),a.delta.g1_sx=await y(_),a.delta.g2_spx=await I(_),a.transcript=await _.read(64),t<u.contributions.length&&(a.type=u.contributions[t].type,1==a.type&&(a.beaconHash=u.contributions[t].beaconHash,a.numIterationsExp=u.contributions[t].numIterationsExp),u.contributions[t].name&&(a.name=u.contributions[t].name)),g.contributions.push(a)}if(!ki(g.csHash,u.csHash))return o&&o.error("Hash of the original circuit does not match with the MPC one"),!1;if(u.contributions.length>g.contributions.length)return o&&o.error("The impoerted file does not include new contributions"),!1;for(let t=0;t<u.contributions.length;t++)if(!C(u.contributions[t],g.contributions[t]))return o&&o.error(`Previos contribution ${t} does not match`),!1;if(i)for(let t=u.contributions.length;t<g.contributions.length;t++)g.contributions[t].name=i;const p=await Oe(e,"zkey",1,10);if(_.pos=0,_.pos+=s,_.pos+=s,_.pos+=d,_.pos+=d,r.vk_delta_1=await y(_),r.vk_delta_2=await I(_),await $i(p,r),await _.readUBE32()!=r.nPublic+1)return o&&o.error("Invalid number of points in IC"),await p.discard(),!1;if(_.pos+=s*(r.nPublic+1),await Re(n,c,p,3),await Re(n,c,p,4),await _.readUBE32()!=r.domainSize-1)return o&&o.error("Invalid number of points in H"),await p.discard(),!1;let h;const m=await _.read(s*(r.domainSize-1)),L=await l.G1.batchUtoLEM(m);h=new Uint8Array(r.domainSize*s),h.set(L),l.G1.toRprLEM(h,s*(r.domainSize-1),l.G1.zeroAffine);const w=l.Fr.neg(l.Fr.inv(l.Fr.e(2))),A=l.Fr.inv(l.Fr.w[r.power+1]);if(h=await l.G1.batchApplyKey(h,w,A,"affine","jacobian",o),h=await l.G1.ifft(h,"jacobian","affine",o),await ze(p,9),await p.write(h),await Qe(p),await _.readUBE32()!=r.nVars-r.nPublic-1)return o&&o.error("Invalid number of points in L"),await p.discard(),!1;let b;return b=await _.read(s*(r.nVars-r.nPublic-1)),b=await l.G1.batchUtoLEM(b),await ze(p,8),await p.write(b),await Qe(p),await _.readUBE32()!=r.nVars?(o&&o.error("Invalid number of points in A"),await p.discard(),!1):(_.pos+=s*r.nVars,await Re(n,c,p,5),await _.readUBE32()!=r.nVars?(o&&o.error("Invalid number of points in B1"),await p.discard(),!1):(_.pos+=s*r.nVars,await Re(n,c,p,6),await _.readUBE32()!=r.nVars?(o&&o.error("Invalid number of points in B2"),await p.discard(),!1):(_.pos+=d*r.nVars,await Re(n,c,p,7),await io(p,l,g),await _.close(),await p.close(),await n.close(),!0)));async function y(t){const a=await t.read(2*l.G1.F.n8);return l.G1.fromRprUncompressed(a,0)}async function I(t){const a=await t.read(2*l.G2.F.n8);return l.G2.fromRprUncompressed(a,0)}function C(t,a){return!!l.G1.eq(t.deltaAfter,a.deltaAfter)&&(!!l.G1.eq(t.delta.g1_s,a.delta.g1_s)&&(!!l.G1.eq(t.delta.g1_sx,a.delta.g1_sx)&&(!!l.G2.eq(t.delta.g2_spx,a.delta.g2_spx)&&!!ki(t.transcript,a.transcript))))}},verifyFromR1cs:async function(t,a,e,i){const o={type:"bigMem"};return await rn(t,a,o,i),await sn(o,a,e,i)},verifyFromInit:sn,contribute:async function(t,a,e,i,o){await Ye.exports.ready();const{fd:n,sections:c}=await Ue(t,"zkey",2),r=await Xi(n,c);if("groth16"!=r.protocol)throw new Error("zkey file is not groth16");const l=await He(r.q),s=await ao(n,l,c),d=await Oe(a,"zkey",1,10),u=await Ni(i),g=Ye.exports(64);g.update(s.csHash);for(let t=0;t<s.contributions.length;t++)no(g,l,s.contributions[t]);const _={delta:{}};_.delta.prvKey=l.Fr.fromRng(u),_.delta.g1_s=l.G1.toAffine(l.G1.fromRng(u)),_.delta.g1_sx=l.G1.toAffine(l.G1.timesFr(_.delta.g1_s,_.delta.prvKey)),oo(g,l,_.delta.g1_s),oo(g,l,_.delta.g1_sx),_.transcript=g.digest(),_.delta.g2_sp=Co(l,_.transcript),_.delta.g2_spx=l.G2.toAffine(l.G2.timesFr(_.delta.g2_sp,_.delta.prvKey)),r.vk_delta_1=l.G1.timesFr(r.vk_delta_1,_.delta.prvKey),r.vk_delta_2=l.G2.timesFr(r.vk_delta_2,_.delta.prvKey),_.deltaAfter=r.vk_delta_1,_.type=0,e&&(_.name=e),s.contributions.push(_),await $i(d,r),await Re(n,c,d,3),await Re(n,c,d,4),await Re(n,c,d,5),await Re(n,c,d,6),await Re(n,c,d,7);const f=l.Fr.inv(_.delta.prvKey);await ko(n,c,d,8,l,"G1",f,l.Fr.e(1),"L Section",o),await ko(n,c,d,9,l,"G1",f,l.Fr.e(1),"H Section",o),await io(d,l,s),await n.close(),await d.close();const p=Ye.exports(64);no(p,l,_);const h=p.digest();return o&&o.info(Ti(s.csHash,"Circuit Hash: ")),o&&o.info(Ti(h,"Contribution Hash: ")),h},beacon:async function(t,a,e,i,o,n){await Ye.exports.ready();const c=Vi(i);if(0==c.byteLength||2*c.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(c.length>=256)return n&&n.error("Maximum lenght of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;const{fd:r,sections:l}=await Ue(t,"zkey",2),s=await Xi(r,l);if("groth16"!=s.protocol)throw new Error("zkey file is not groth16");const d=await He(s.q),u=await ao(r,d,l),g=await Oe(a,"zkey",1,10),_=await Ki(c,o),f=Ye.exports(64);f.update(u.csHash);for(let t=0;t<u.contributions.length;t++)no(f,d,u.contributions[t]);const p={delta:{}};p.delta.prvKey=d.Fr.fromRng(_),p.delta.g1_s=d.G1.toAffine(d.G1.fromRng(_)),p.delta.g1_sx=d.G1.toAffine(d.G1.timesFr(p.delta.g1_s,p.delta.prvKey)),oo(f,d,p.delta.g1_s),oo(f,d,p.delta.g1_sx),p.transcript=f.digest(),p.delta.g2_sp=Co(d,p.transcript),p.delta.g2_spx=d.G2.toAffine(d.G2.timesFr(p.delta.g2_sp,p.delta.prvKey)),s.vk_delta_1=d.G1.timesFr(s.vk_delta_1,p.delta.prvKey),s.vk_delta_2=d.G2.timesFr(s.vk_delta_2,p.delta.prvKey),p.deltaAfter=s.vk_delta_1,p.type=1,p.numIterationsExp=o,p.beaconHash=c,e&&(p.name=e),u.contributions.push(p),await $i(g,s),await Re(r,l,g,3),await Re(r,l,g,4),await Re(r,l,g,5),await Re(r,l,g,6),await Re(r,l,g,7);const h=d.Fr.inv(p.delta.prvKey);await ko(r,l,g,8,d,"G1",h,d.Fr.e(1),"L Section",n),await ko(r,l,g,9,d,"G1",h,d.Fr.e(1),"H Section",n),await io(g,d,u),await r.close(),await g.close();const m=Ye.exports(64);no(m,d,p);const L=m.digest();return n&&n.info(Ti(L,"Contribution Hash: ")),L},exportJson:async function(t){const a=await async function(t,a){const{fd:e,sections:i}=await Ue(t,"zkey",1),o=await Xi(e,i,a),n=new V(o.r),c=pe.mod(pe.shl(1,8*o.n8r),o.r),r=n.inv(c),l=n.mul(r,r);let s=await He(o.q);await qe(e,i,3),o.IC=[];for(let t=0;t<=o.nPublic;t++){const t=await Zi(e,s,a);o.IC.push(t)}await Me(e),await qe(e,i,4);const d=await e.readULE32();o.ccoefs=[];for(let t=0;t<d;t++){const t=await e.readULE32(),a=await e.readULE32(),i=await e.readULE32(),n=await u();o.ccoefs.push({matrix:t,constraint:a,signal:i,value:n})}await Me(e),await qe(e,i,5),o.A=[];for(let t=0;t<o.nVars;t++){const i=await Zi(e,s,a);o.A[t]=i}await Me(e),await qe(e,i,6),o.B1=[];for(let t=0;t<o.nVars;t++){const i=await Zi(e,s,a);o.B1[t]=i}await Me(e),await qe(e,i,7),o.B2=[];for(let t=0;t<o.nVars;t++){const i=await Ji(e,s,a);o.B2[t]=i}await Me(e),await qe(e,i,8),o.C=[];for(let t=o.nPublic+1;t<o.nVars;t++){const i=await Zi(e,s,a);o.C[t]=i}await Me(e),await qe(e,i,9),o.hExps=[];for(let t=0;t<o.domainSize;t++){const t=await Zi(e,s,a);o.hExps.push(t)}return await Me(e),await e.close(),o;async function u(){const t=await ke(e,o.n8r);return n.mul(t,l)}}(t,!0);return delete a.curve,delete a.F,he.stringifyBigInts(a)},bellmanContribute:async function(t,a,e,i,o){await Ye.exports.ready();const n=await Ni(i),c=t.Fr.fromRng(n),r=t.Fr.inv(c),l=2*t.G1.F.n8,s=2*t.G2.F.n8,d=await Pe(a),u=await Ge(e);await B(l),await B(l),await B(s),await B(s);const g=await v(),_=t.G1.timesFr(g,c);await G(_);const f=await S(),p=t.G2.timesFr(f,c);await P(p);const h=await d.readUBE32();await u.writeUBE32(h),await B(h*l);const m=await d.readUBE32();await u.writeUBE32(m),await Ro(d,u,null,t,"G1",m,r,t.Fr.e(1),"UNCOMPRESSED","H",o);const L=await d.readUBE32();await u.writeUBE32(L),await Ro(d,u,null,t,"G1",L,r,t.Fr.e(1),"UNCOMPRESSED","L",o);const w=await d.readUBE32();await u.writeUBE32(w),await B(w*l);const A=await d.readUBE32();await u.writeUBE32(A),await B(A*l);const b=await d.readUBE32();await u.writeUBE32(b),await B(b*s);const y=Ye.exports(64),I={};I.csHash=await d.read(64),y.update(I.csHash);const C=await d.readUBE32();I.contributions=[];for(let a=0;a<C;a++){const a={delta:{}};a.deltaAfter=await v(),a.delta.g1_s=await v(),a.delta.g1_sx=await v(),a.delta.g2_spx=await S(),a.transcript=await d.read(64),I.contributions.push(a),no(y,t,a)}const x={delta:{}};x.delta.prvKey=c,x.delta.g1_s=t.G1.toAffine(t.G1.fromRng(n)),x.delta.g1_sx=t.G1.toAffine(t.G1.timesFr(x.delta.g1_s,c)),oo(y,t,x.delta.g1_s),oo(y,t,x.delta.g1_sx),x.transcript=y.digest(),x.delta.g2_sp=Co(t,x.transcript),x.delta.g2_spx=t.G2.toAffine(t.G2.timesFr(x.delta.g2_sp,c)),x.deltaAfter=_,x.type=0,I.contributions.push(x),await u.write(I.csHash),await u.writeUBE32(I.contributions.length);for(let t=0;t<I.contributions.length;t++){const a=I.contributions[t];await G(a.deltaAfter),await G(a.delta.g1_s),await G(a.delta.g1_sx),await P(a.delta.g2_spx),await u.write(a.transcript)}const F=Ye.exports(64);no(F,t,x);const E=F.digest();return o&&o.info(Ti(E,"Contribution Hash: ")),await u.close(),await d.close(),E;async function B(t){const a=2*d.pageSize;for(let e=0;e<t;e+=a){const i=Math.min(t-e,a),o=await d.read(i);await u.write(o)}}async function v(){const a=await d.read(2*t.G1.F.n8);return t.G1.fromRprUncompressed(a,0)}async function S(){const a=await d.read(2*t.G2.F.n8);return t.G2.fromRprUncompressed(a,0)}async function G(a){const e=new Uint8Array(l);t.G1.toRprUncompressed(e,0,a),await u.write(e)}async function P(a){const e=new Uint8Array(s);t.G2.toRprUncompressed(e,0,a),await u.write(e)}},exportVerificationKey:un,exportSolidityVerifier:async function(t,a,e){const i=await un(t);let o=a[i.protocol];return gn.render(o,i)},readHeader:Xi});var fn,pn={exports:{}};
/**
     * [js-sha3]{@link https://github.com/emn178/js-sha3}
     *
     * @version 0.8.0
     * @author Chen, Yi-Cyuan [emn178@gmail.com]
     * @copyright Chen, Yi-Cyuan 2015-2018
     * @license MIT
     */fn=pn,function(){var t="input is invalid type",a="object"==typeof window,e=a?window:{};e.JS_SHA3_NO_WINDOW&&(a=!1);var i=!a&&"object"==typeof self;!e.JS_SHA3_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?e=j:i&&(e=self);var o=!e.JS_SHA3_NO_COMMON_JS&&fn.exports,n=!e.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,c="0123456789abcdef".split(""),r=[4,1024,262144,67108864],l=[0,8,16,24],s=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],d=[224,256,384,512],u=[128,256],g=["hex","buffer","arrayBuffer","array","digest"],_={128:168,256:136};!e.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!n||!e.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var f=function(t,a,e){return function(i){return new v(t,a,t).update(i)[e]()}},p=function(t,a,e){return function(i,o){return new v(t,a,o).update(i)[e]()}},h=function(t,a,e){return function(a,i,o,n){return b["cshake"+t].update(a,i,o,n)[e]()}},m=function(t,a,e){return function(a,i,o,n){return b["kmac"+t].update(a,i,o,n)[e]()}},L=function(t,a,e,i){for(var o=0;o<g.length;++o){var n=g[o];t[n]=a(e,i,n)}return t},w=function(t,a){var e=f(t,a,"hex");return e.create=function(){return new v(t,a,t)},e.update=function(t){return e.create().update(t)},L(e,f,t,a)},A=[{name:"keccak",padding:[1,256,65536,16777216],bits:d,createMethod:w},{name:"sha3",padding:[6,1536,393216,100663296],bits:d,createMethod:w},{name:"shake",padding:[31,7936,2031616,520093696],bits:u,createMethod:function(t,a){var e=p(t,a,"hex");return e.create=function(e){return new v(t,a,e)},e.update=function(t,a){return e.create(a).update(t)},L(e,p,t,a)}},{name:"cshake",padding:r,bits:u,createMethod:function(t,a){var e=_[t],i=h(t,0,"hex");return i.create=function(i,o,n){return o||n?new v(t,a,i).bytepad([o,n],e):b["shake"+t].create(i)},i.update=function(t,a,e,o){return i.create(a,e,o).update(t)},L(i,h,t,a)}},{name:"kmac",padding:r,bits:u,createMethod:function(t,a){var e=_[t],i=m(t,0,"hex");return i.create=function(i,o,n){return new S(t,a,o).bytepad(["KMAC",n],e).bytepad([i],e)},i.update=function(t,a,e,o){return i.create(t,e,o).update(a)},L(i,m,t,a)}}],b={},y=[],I=0;I<A.length;++I)for(var C=A[I],x=C.bits,F=0;F<x.length;++F){var E=C.name+"_"+x[F];if(y.push(E),b[E]=C.createMethod(x[F],C.padding),"sha3"!==C.name){var B=C.name+x[F];y.push(B),b[B]=b[E]}}function v(t,a,e){this.blocks=[],this.s=[],this.padding=a,this.outputBits=e,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=e>>5,this.extraBytes=(31&e)>>3;for(var i=0;i<50;++i)this.s[i]=0}function S(t,a,e){v.call(this,t,a,e)}v.prototype.update=function(a){if(this.finalized)throw new Error("finalize already called");var e,i=typeof a;if("string"!==i){if("object"!==i)throw new Error(t);if(null===a)throw new Error(t);if(n&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!(Array.isArray(a)||n&&ArrayBuffer.isView(a)))throw new Error(t);e=!0}for(var o,c,r=this.blocks,s=this.byteCount,d=a.length,u=this.blockCount,g=0,_=this.s;g<d;){if(this.reset)for(this.reset=!1,r[0]=this.block,o=1;o<u+1;++o)r[o]=0;if(e)for(o=this.start;g<d&&o<s;++g)r[o>>2]|=a[g]<<l[3&o++];else for(o=this.start;g<d&&o<s;++g)(c=a.charCodeAt(g))<128?r[o>>2]|=c<<l[3&o++]:c<2048?(r[o>>2]|=(192|c>>6)<<l[3&o++],r[o>>2]|=(128|63&c)<<l[3&o++]):c<55296||c>=57344?(r[o>>2]|=(224|c>>12)<<l[3&o++],r[o>>2]|=(128|c>>6&63)<<l[3&o++],r[o>>2]|=(128|63&c)<<l[3&o++]):(c=65536+((1023&c)<<10|1023&a.charCodeAt(++g)),r[o>>2]|=(240|c>>18)<<l[3&o++],r[o>>2]|=(128|c>>12&63)<<l[3&o++],r[o>>2]|=(128|c>>6&63)<<l[3&o++],r[o>>2]|=(128|63&c)<<l[3&o++]);if(this.lastByteIndex=o,o>=s){for(this.start=o-s,this.block=r[u],o=0;o<u;++o)_[o]^=r[o];G(_),this.reset=!0}else this.start=o}return this},v.prototype.encode=function(t,a){var e=255&t,i=1,o=[e];for(e=255&(t>>=8);e>0;)o.unshift(e),e=255&(t>>=8),++i;return a?o.push(i):o.unshift(i),this.update(o),o.length},v.prototype.encodeString=function(a){var e,i=typeof a;if("string"!==i){if("object"!==i)throw new Error(t);if(null===a)throw new Error(t);if(n&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!(Array.isArray(a)||n&&ArrayBuffer.isView(a)))throw new Error(t);e=!0}var o=0,c=a.length;if(e)o=c;else for(var r=0;r<a.length;++r){var l=a.charCodeAt(r);l<128?o+=1:l<2048?o+=2:l<55296||l>=57344?o+=3:(l=65536+((1023&l)<<10|1023&a.charCodeAt(++r)),o+=4)}return o+=this.encode(8*o),this.update(a),o},v.prototype.bytepad=function(t,a){for(var e=this.encode(a),i=0;i<t.length;++i)e+=this.encodeString(t[i]);var o=a-e%a,n=[];return n.length=o,this.update(n),this},v.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,a=this.lastByteIndex,e=this.blockCount,i=this.s;if(t[a>>2]|=this.padding[3&a],this.lastByteIndex===this.byteCount)for(t[0]=t[e],a=1;a<e+1;++a)t[a]=0;for(t[e-1]|=2147483648,a=0;a<e;++a)i[a]^=t[a];G(i)}},v.prototype.toString=v.prototype.hex=function(){this.finalize();for(var t,a=this.blockCount,e=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,r=0,l="";r<i;){for(n=0;n<a&&r<i;++n,++r)t=e[n],l+=c[t>>4&15]+c[15&t]+c[t>>12&15]+c[t>>8&15]+c[t>>20&15]+c[t>>16&15]+c[t>>28&15]+c[t>>24&15];r%a==0&&(G(e),n=0)}return o&&(t=e[n],l+=c[t>>4&15]+c[15&t],o>1&&(l+=c[t>>12&15]+c[t>>8&15]),o>2&&(l+=c[t>>20&15]+c[t>>16&15])),l},v.prototype.arrayBuffer=function(){this.finalize();var t,a=this.blockCount,e=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,c=0,r=this.outputBits>>3;t=o?new ArrayBuffer(i+1<<2):new ArrayBuffer(r);for(var l=new Uint32Array(t);c<i;){for(n=0;n<a&&c<i;++n,++c)l[c]=e[n];c%a==0&&G(e)}return o&&(l[n]=e[n],t=t.slice(0,r)),t},v.prototype.buffer=v.prototype.arrayBuffer,v.prototype.digest=v.prototype.array=function(){this.finalize();for(var t,a,e=this.blockCount,i=this.s,o=this.outputBlocks,n=this.extraBytes,c=0,r=0,l=[];r<o;){for(c=0;c<e&&r<o;++c,++r)t=r<<2,a=i[c],l[t]=255&a,l[t+1]=a>>8&255,l[t+2]=a>>16&255,l[t+3]=a>>24&255;r%e==0&&G(i)}return n&&(t=r<<2,a=i[c],l[t]=255&a,n>1&&(l[t+1]=a>>8&255),n>2&&(l[t+2]=a>>16&255)),l},S.prototype=new v,S.prototype.finalize=function(){return this.encode(this.outputBits,!0),v.prototype.finalize.call(this)};var G=function(t){var a,e,i,o,n,c,r,l,d,u,g,_,f,p,h,m,L,w,A,b,y,I,C,x,F,E,B,v,S,G,P,U,O,z,Q,q,M,T,k,R,D,N,K,V,j,H,$,Y,W,Z,J,X,tt,at,et,it,ot,nt,ct,rt,lt,st,dt;for(i=0;i<48;i+=2)o=t[0]^t[10]^t[20]^t[30]^t[40],n=t[1]^t[11]^t[21]^t[31]^t[41],c=t[2]^t[12]^t[22]^t[32]^t[42],r=t[3]^t[13]^t[23]^t[33]^t[43],l=t[4]^t[14]^t[24]^t[34]^t[44],d=t[5]^t[15]^t[25]^t[35]^t[45],u=t[6]^t[16]^t[26]^t[36]^t[46],g=t[7]^t[17]^t[27]^t[37]^t[47],a=(_=t[8]^t[18]^t[28]^t[38]^t[48])^(c<<1|r>>>31),e=(f=t[9]^t[19]^t[29]^t[39]^t[49])^(r<<1|c>>>31),t[0]^=a,t[1]^=e,t[10]^=a,t[11]^=e,t[20]^=a,t[21]^=e,t[30]^=a,t[31]^=e,t[40]^=a,t[41]^=e,a=o^(l<<1|d>>>31),e=n^(d<<1|l>>>31),t[2]^=a,t[3]^=e,t[12]^=a,t[13]^=e,t[22]^=a,t[23]^=e,t[32]^=a,t[33]^=e,t[42]^=a,t[43]^=e,a=c^(u<<1|g>>>31),e=r^(g<<1|u>>>31),t[4]^=a,t[5]^=e,t[14]^=a,t[15]^=e,t[24]^=a,t[25]^=e,t[34]^=a,t[35]^=e,t[44]^=a,t[45]^=e,a=l^(_<<1|f>>>31),e=d^(f<<1|_>>>31),t[6]^=a,t[7]^=e,t[16]^=a,t[17]^=e,t[26]^=a,t[27]^=e,t[36]^=a,t[37]^=e,t[46]^=a,t[47]^=e,a=u^(o<<1|n>>>31),e=g^(n<<1|o>>>31),t[8]^=a,t[9]^=e,t[18]^=a,t[19]^=e,t[28]^=a,t[29]^=e,t[38]^=a,t[39]^=e,t[48]^=a,t[49]^=e,p=t[0],h=t[1],H=t[11]<<4|t[10]>>>28,$=t[10]<<4|t[11]>>>28,v=t[20]<<3|t[21]>>>29,S=t[21]<<3|t[20]>>>29,rt=t[31]<<9|t[30]>>>23,lt=t[30]<<9|t[31]>>>23,N=t[40]<<18|t[41]>>>14,K=t[41]<<18|t[40]>>>14,z=t[2]<<1|t[3]>>>31,Q=t[3]<<1|t[2]>>>31,m=t[13]<<12|t[12]>>>20,L=t[12]<<12|t[13]>>>20,Y=t[22]<<10|t[23]>>>22,W=t[23]<<10|t[22]>>>22,G=t[33]<<13|t[32]>>>19,P=t[32]<<13|t[33]>>>19,st=t[42]<<2|t[43]>>>30,dt=t[43]<<2|t[42]>>>30,at=t[5]<<30|t[4]>>>2,et=t[4]<<30|t[5]>>>2,q=t[14]<<6|t[15]>>>26,M=t[15]<<6|t[14]>>>26,w=t[25]<<11|t[24]>>>21,A=t[24]<<11|t[25]>>>21,Z=t[34]<<15|t[35]>>>17,J=t[35]<<15|t[34]>>>17,U=t[45]<<29|t[44]>>>3,O=t[44]<<29|t[45]>>>3,x=t[6]<<28|t[7]>>>4,F=t[7]<<28|t[6]>>>4,it=t[17]<<23|t[16]>>>9,ot=t[16]<<23|t[17]>>>9,T=t[26]<<25|t[27]>>>7,k=t[27]<<25|t[26]>>>7,b=t[36]<<21|t[37]>>>11,y=t[37]<<21|t[36]>>>11,X=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,V=t[8]<<27|t[9]>>>5,j=t[9]<<27|t[8]>>>5,E=t[18]<<20|t[19]>>>12,B=t[19]<<20|t[18]>>>12,nt=t[29]<<7|t[28]>>>25,ct=t[28]<<7|t[29]>>>25,R=t[38]<<8|t[39]>>>24,D=t[39]<<8|t[38]>>>24,I=t[48]<<14|t[49]>>>18,C=t[49]<<14|t[48]>>>18,t[0]=p^~m&w,t[1]=h^~L&A,t[10]=x^~E&v,t[11]=F^~B&S,t[20]=z^~q&T,t[21]=Q^~M&k,t[30]=V^~H&Y,t[31]=j^~$&W,t[40]=at^~it&nt,t[41]=et^~ot&ct,t[2]=m^~w&b,t[3]=L^~A&y,t[12]=E^~v&G,t[13]=B^~S&P,t[22]=q^~T&R,t[23]=M^~k&D,t[32]=H^~Y&Z,t[33]=$^~W&J,t[42]=it^~nt&rt,t[43]=ot^~ct&lt,t[4]=w^~b&I,t[5]=A^~y&C,t[14]=v^~G&U,t[15]=S^~P&O,t[24]=T^~R&N,t[25]=k^~D&K,t[34]=Y^~Z&X,t[35]=W^~J&tt,t[44]=nt^~rt&st,t[45]=ct^~lt&dt,t[6]=b^~I&p,t[7]=y^~C&h,t[16]=G^~U&x,t[17]=P^~O&F,t[26]=R^~N&z,t[27]=D^~K&Q,t[36]=Z^~X&V,t[37]=J^~tt&j,t[46]=rt^~st&at,t[47]=lt^~dt&et,t[8]=I^~p&m,t[9]=C^~h&L,t[18]=U^~x&E,t[19]=O^~F&B,t[28]=N^~z&q,t[29]=K^~Q&M,t[38]=X^~V&H,t[39]=tt^~j&$,t[48]=st^~at&it,t[49]=dt^~et&ot,t[0]^=s[i],t[1]^=s[i+1]};if(o)fn.exports=b;else for(I=0;I<y.length;++I)e[y[I]]=b[y[I]]}();var hn=pn.exports;const{stringifyBigInts:mn}=he,{keccak256:Ln}=hn;async function wn(t,a,e){const{fd:i,sections:o}=await Ue(a,"wtns",2),n=await co(i,o),{fd:c,sections:r}=await Ue(t,"zkey",2),l=await Xi(c,r);if("plonk"!=l.protocol)throw new Error("zkey file is not plonk");if(!pe.eq(l.r,n.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(n.nWitness!=l.nVars-l.nAdditions)throw new Error(`Invalid witness length. Circuit: ${l.nVars}, witness: ${n.nWitness}, ${l.nAdditions}`);const s=l.curve,d=s.Fr,u=s.G1,g=s.Fr.n8;e&&e.debug("Reading Wtns");const _=await De(i,o,2);_.set(d.zero,0);const f=new Pa(g*l.nAdditions);let p,h,m,L,w,A,b,y,I,C,x,F,E,B;await async function(){const t=await De(c,r,3),a=8+2*s.Fr.n8;for(let e=0;e<l.nAdditions;e++){const i=q(t,e*a),o=q(t,e*a+4),n=t.slice(e*a+8,e*a+8+g),c=t.slice(e*a+8+g,e*a+8+2*g),r=M(i),l=M(o),d=s.Fr.add(s.Fr.mul(n,r),s.Fr.mul(c,l));f.set(d,g*e)}}();let v={};const S=new Pa(l.domainSize*g*4*3);let G=r[12][0].p+l.domainSize*g;await c.readToBuffer(S,0,l.domainSize*g*4,G),G+=l.domainSize*g*5,await c.readToBuffer(S,l.domainSize*g*4,l.domainSize*g*4,G),G+=l.domainSize*g*5,await c.readToBuffer(S,l.domainSize*g*8,l.domainSize*g*4,G);const P=new Pa(l.domainSize*g);await c.readToBuffer(P,0,l.domainSize*g,r[12][0].p);const U=new Pa(l.domainSize*g);await c.readToBuffer(U,0,l.domainSize*g,r[12][0].p+5*l.domainSize*g);const O=await De(c,r,14),z={};await async function(){z.b=[];for(let t=1;t<=11;t++)z.b[t]=s.Fr.random();[p,h,m]=await async function(){let t=new Pa(l.domainSize*g),a=new Pa(l.domainSize*g),e=new Pa(l.domainSize*g);const i=await De(c,r,4),o=await De(c,r,5),n=await De(c,r,6);for(let c=0;c<l.nConstrains;c++){const r=q(i,4*c);t.set(M(r),c*g);const l=q(o,4*c);a.set(M(l),c*g);const s=q(n,4*c);e.set(M(s),c*g)}return t=await d.batchToMontgomery(t),a=await d.batchToMontgomery(a),e=await d.batchToMontgomery(e),[t,a,e]}(),[I,w]=await N(p,[z.b[2],z.b[1]]),[C,A]=await N(h,[z.b[4],z.b[3]]),[x,b]=await N(m,[z.b[6],z.b[5]]),v.A=await D(I,"multiexp A"),v.B=await D(C,"multiexp B"),v.C=await D(x,"multiexp C")}(),await async function(){const t=new Uint8Array(l.nPublic*g+2*u.F.n8*3);for(let a=0;a<l.nPublic;a++)d.toRprBE(t,a*g,p.slice(a*g,(a+1)*g));u.toRprUncompressed(t,l.nPublic*g+0,v.A),u.toRprUncompressed(t,l.nPublic*g+2*u.F.n8,v.B),u.toRprUncompressed(t,l.nPublic*g+4*u.F.n8,v.C),z.beta=T(t),e&&e.debug("beta: "+d.toString(z.beta));const a=new Uint8Array(g);d.toRprBE(a,0,z.beta),z.gamma=T(a),e&&e.debug("gamma: "+d.toString(z.gamma));let i=new Pa(d.n8*l.domainSize),o=new Pa(d.n8*l.domainSize);i.set(d.one,0),o.set(d.one,0);let n=d.one;for(let t=0;t<l.domainSize;t++){let a=p.slice(t*g,(t+1)*g);a=d.add(a,d.mul(z.beta,n)),a=d.add(a,z.gamma);let e=h.slice(t*g,(t+1)*g);e=d.add(e,d.mul(l.k1,d.mul(z.beta,n))),e=d.add(e,z.gamma);let c=m.slice(t*g,(t+1)*g);c=d.add(c,d.mul(l.k2,d.mul(z.beta,n))),c=d.add(c,z.gamma);const r=d.mul(a,d.mul(e,c));let s=p.slice(t*g,(t+1)*g);s=d.add(s,d.mul(S.slice(t*g*4,t*g*4+g),z.beta)),s=d.add(s,z.gamma);let u=h.slice(t*g,(t+1)*g);u=d.add(u,d.mul(S.slice(4*(l.domainSize+t)*g,4*(l.domainSize+t)*g+g),z.beta)),u=d.add(u,z.gamma);let _=m.slice(t*g,(t+1)*g);_=d.add(_,d.mul(S.slice(4*(2*l.domainSize+t)*g,4*(2*l.domainSize+t)*g+g),z.beta)),_=d.add(_,z.gamma);const f=d.mul(s,d.mul(u,_));i.set(d.mul(i.slice(t*g,(t+1)*g),r),(t+1)%l.domainSize*g),o.set(d.mul(o.slice(t*g,(t+1)*g),f),(t+1)%l.domainSize*g),n=d.mul(n,d.w[l.power])}o=await d.batchInverse(o);for(let t=0;t<l.domainSize;t++)i.set(d.mul(i.slice(t*g,(t+1)*g),o.slice(t*g,(t+1)*g)),t*g);if(!d.eq(i.slice(0,g),d.one))throw new Error("Copy constraints does not match");L=i,[F,y]=await N(L,[z.b[9],z.b[8],z.b[7]]),v.Z=await D(F,"multiexp Z")}(),await async function(){e&&e.debug("phse3: Reading QM4");const t=new Pa(4*l.domainSize*g);await c.readToBuffer(t,0,l.domainSize*g*4,r[7][0].p+l.domainSize*g),e&&e.debug("phse3: Reading QL4");const a=new Pa(4*l.domainSize*g);await c.readToBuffer(a,0,l.domainSize*g*4,r[8][0].p+l.domainSize*g),e&&e.debug("phse3: Reading QR4");const i=new Pa(4*l.domainSize*g);await c.readToBuffer(i,0,l.domainSize*g*4,r[9][0].p+l.domainSize*g),e&&e.debug("phse3: Reading QO4");const o=new Pa(4*l.domainSize*g);await c.readToBuffer(o,0,l.domainSize*g*4,r[10][0].p+l.domainSize*g),e&&e.debug("phse3: Reading QC4");const n=new Pa(4*l.domainSize*g);await c.readToBuffer(n,0,l.domainSize*g*4,r[11][0].p+l.domainSize*g);const s=await De(c,r,13),_=new Uint8Array(2*u.F.n8);u.toRprUncompressed(_,0,v.Z),z.alpha=T(_),e&&e.debug("alpha: "+d.toString(z.alpha));const f=[d.zero,d.add(d.e(-1),d.w[2]),d.e(-2),d.sub(d.e(-1),d.w[2])],h=[d.zero,d.add(d.zero,d.mul(d.e(-2),d.w[2])),d.e(4),d.sub(d.zero,d.mul(d.e(-2),d.w[2]))],m=[d.zero,d.add(d.e(2),d.mul(d.e(2),d.w[2])),d.e(-8),d.sub(d.e(2),d.mul(d.e(2),d.w[2]))],L=new Pa(4*l.domainSize*g),I=new Pa(4*l.domainSize*g);let C=d.one;for(let c=0;c<4*l.domainSize;c++){c%4096==0&&e&&e.debug(`calculating t ${c}/${4*l.domainSize}`);const r=w.slice(c*g,c*g+g),u=A.slice(c*g,c*g+g),_=b.slice(c*g,c*g+g),f=y.slice(c*g,c*g+g),h=y.slice((c+4*l.domainSize+4)%(4*l.domainSize)*g,(c+4*l.domainSize+4)%(4*l.domainSize)*g+g),m=t.slice(c*g,c*g+g),x=a.slice(c*g,c*g+g),F=i.slice(c*g,c*g+g),E=o.slice(c*g,c*g+g),B=n.slice(c*g,c*g+g),v=S.slice(c*g,c*g+g),G=S.slice((c+4*l.domainSize)*g,(c+4*l.domainSize)*g+g),P=S.slice((c+8*l.domainSize)*g,(c+8*l.domainSize)*g+g),U=d.add(z.b[2],d.mul(z.b[1],C)),O=d.add(z.b[4],d.mul(z.b[3],C)),M=d.add(z.b[6],d.mul(z.b[5],C)),T=d.square(C),k=d.add(d.add(d.mul(z.b[7],T),d.mul(z.b[8],C)),z.b[9]),R=d.mul(C,d.w[l.power]),D=d.square(R),N=d.add(d.add(d.mul(z.b[7],D),d.mul(z.b[8],R)),z.b[9]);let K=d.zero;for(let t=0;t<l.nPublic;t++)K=d.sub(K,d.mul(s.slice((5*t*l.domainSize+l.domainSize+c)*g,(5*t*l.domainSize+l.domainSize+c+1)*g),p.slice(t*g,(t+1)*g)));let[V,j]=Q(r,u,U,O,c%4);V=d.mul(V,m),j=d.mul(j,m),V=d.add(V,d.mul(r,x)),j=d.add(j,d.mul(U,x)),V=d.add(V,d.mul(u,F)),j=d.add(j,d.mul(O,F)),V=d.add(V,d.mul(_,E)),j=d.add(j,d.mul(M,E)),V=d.add(V,K),V=d.add(V,B);const H=d.mul(z.beta,C);let $=r;$=d.add($,H),$=d.add($,z.gamma);let Y=u;Y=d.add(Y,d.mul(H,l.k1)),Y=d.add(Y,z.gamma);let W=_;W=d.add(W,d.mul(H,l.k2)),W=d.add(W,z.gamma);let Z=f,[J,X]=q($,Y,W,Z,U,O,M,k,c%4);J=d.mul(J,z.alpha),X=d.mul(X,z.alpha);let tt=r;tt=d.add(tt,d.mul(z.beta,v)),tt=d.add(tt,z.gamma);let at=u;at=d.add(at,d.mul(z.beta,G)),at=d.add(at,z.gamma);let et=_;et=d.add(et,d.mul(z.beta,P)),et=d.add(et,z.gamma);let it=h,[ot,nt]=q(tt,at,et,it,U,O,M,N,c%4);ot=d.mul(ot,z.alpha),nt=d.mul(nt,z.alpha);let ct=d.sub(f,d.one);ct=d.mul(ct,s.slice((l.domainSize+c)*g,(l.domainSize+c+1)*g)),ct=d.mul(ct,d.mul(z.alpha,z.alpha));let rt=d.mul(k,s.slice((l.domainSize+c)*g,(l.domainSize+c+1)*g));rt=d.mul(rt,d.mul(z.alpha,z.alpha));let lt=d.add(d.sub(d.add(V,J),ot),ct),st=d.add(d.sub(d.add(j,X),nt),rt);L.set(lt,c*g),I.set(st,c*g),C=d.mul(C,d.w[l.power+2])}e&&e.debug("ifft T");let x=await d.ifft(L);e&&e.debug("dividing T/Z");for(let t=0;t<l.domainSize;t++)x.set(d.neg(x.slice(t*g,t*g+g)),t*g);for(let t=l.domainSize;t<4*l.domainSize;t++){const a=d.sub(x.slice((t-l.domainSize)*g,(t-l.domainSize)*g+g),x.slice(t*g,t*g+g));if(x.set(a,t*g),t>3*l.domainSize-4&&!d.isZero(a))throw new Error("T Polynomial is not divisible")}e&&e.debug("ifft Tz");const F=await d.ifft(I);for(let t=0;t<4*l.domainSize;t++){const a=F.slice(t*g,(t+1)*g);if(t>3*l.domainSize+5){if(!d.isZero(a))throw new Error("Tz Polynomial is not well calculated")}else x.set(d.add(x.slice(t*g,(t+1)*g),a),t*g)}E=x.slice(0,(3*l.domainSize+6)*g);let B=new Pa((l.domainSize+1)*g);B.set(x.slice(0,l.domainSize*g),0),B.set(z.b[10],l.domainSize*g);let G=new Pa((l.domainSize+1)*g);G.set(x.slice(l.domainSize*g,2*l.domainSize*g),0);const P=d.sub(G.slice(0,g),z.b[10]);G.set(P,0),G.set(z.b[11],l.domainSize*g);let U=new Pa((l.domainSize+6)*g);U.set(x.slice(2*l.domainSize*g,(3*l.domainSize+6)*g),0);const O=d.sub(U.slice(0,g),z.b[11]);function Q(t,a,e,i,o){let n,c;const r=d.mul(t,a),l=d.mul(t,i),s=d.mul(e,a);n=r;let u=d.mul(e,i);return c=d.add(l,s),o&&(c=d.add(c,d.mul(f[o],u))),[n,c]}function q(t,a,e,i,o,n,c,r,l){let s,u;const g=d.mul(t,a),_=d.mul(t,n),p=d.mul(o,a),L=d.mul(o,n),w=d.mul(e,i),A=d.mul(e,r),b=d.mul(c,i),y=d.mul(c,r);s=d.mul(g,w);let I=d.mul(p,w);I=d.add(I,d.mul(_,w)),I=d.add(I,d.mul(g,b)),I=d.add(I,d.mul(g,A));let C=d.mul(L,w);C=d.add(C,d.mul(p,b)),C=d.add(C,d.mul(p,A)),C=d.add(C,d.mul(_,b)),C=d.add(C,d.mul(_,A)),C=d.add(C,d.mul(g,y));let x=d.mul(_,y);x=d.add(x,d.mul(p,y)),x=d.add(x,d.mul(L,A)),x=d.add(x,d.mul(L,b));let F=d.mul(L,y);return u=I,l&&(u=d.add(u,d.mul(f[l],C)),u=d.add(u,d.mul(h[l],x)),u=d.add(u,d.mul(m[l],F))),[s,u]}U.set(O,0),v.T1=await D(B,"multiexp T1"),v.T2=await D(G,"multiexp T2"),v.T3=await D(U,"multiexp T3")}(),await async function(){const t=new Pa(l.domainSize*g);await c.readToBuffer(t,0,l.domainSize*g,r[7][0].p);const a=new Pa(l.domainSize*g);await c.readToBuffer(a,0,l.domainSize*g,r[8][0].p);const i=new Pa(l.domainSize*g);await c.readToBuffer(i,0,l.domainSize*g,r[9][0].p);const o=new Pa(l.domainSize*g);await c.readToBuffer(o,0,l.domainSize*g,r[10][0].p);const n=new Pa(l.domainSize*g);await c.readToBuffer(n,0,l.domainSize*g,r[11][0].p);const s=new Pa(l.domainSize*g);await c.readToBuffer(s,0,l.domainSize*g,r[12][0].p+10*l.domainSize*g);const _=new Uint8Array(2*u.F.n8*3);u.toRprUncompressed(_,0,v.T1),u.toRprUncompressed(_,2*u.F.n8,v.T2),u.toRprUncompressed(_,4*u.F.n8,v.T3),z.xi=T(_),e&&e.debug("xi: "+d.toString(z.xi));v.eval_a=k(I,z.xi),v.eval_b=k(C,z.xi),v.eval_c=k(x,z.xi),v.eval_s1=k(P,z.xi),v.eval_s2=k(U,z.xi),v.eval_t=k(E,z.xi),v.eval_zw=k(F,d.mul(z.xi,d.w[l.power]));const f=d.mul(v.eval_a,v.eval_b);let p=v.eval_a;const h=d.mul(z.beta,z.xi);p=d.add(p,h),p=d.add(p,z.gamma);let m=v.eval_b;m=d.add(m,d.mul(h,l.k1)),m=d.add(m,z.gamma);let L=v.eval_c;L=d.add(L,d.mul(h,l.k2)),L=d.add(L,z.gamma);const w=d.mul(d.mul(d.mul(p,m),L),z.alpha);let A=v.eval_a;A=d.add(A,d.mul(z.beta,v.eval_s1)),A=d.add(A,z.gamma);let b=v.eval_b;b=d.add(b,d.mul(z.beta,v.eval_s2)),b=d.add(b,z.gamma);let y=d.mul(A,b);y=d.mul(y,z.beta),y=d.mul(y,v.eval_zw),y=d.mul(y,z.alpha),z.xim=z.xi;for(let t=0;t<l.power;t++)z.xim=d.mul(z.xim,z.xim);const S=d.div(d.sub(z.xim,d.one),d.mul(d.sub(z.xi,d.one),d.e(l.domainSize))),G=d.mul(S,d.mul(z.alpha,z.alpha)),O=y,Q=d.add(w,G);B=new Pa((l.domainSize+3)*g);for(let e=0;e<l.domainSize+3;e++){let c=d.mul(Q,F.slice(e*g,(e+1)*g));e<l.domainSize&&(c=d.add(c,d.mul(f,t.slice(e*g,(e+1)*g))),c=d.add(c,d.mul(v.eval_a,a.slice(e*g,(e+1)*g))),c=d.add(c,d.mul(v.eval_b,i.slice(e*g,(e+1)*g))),c=d.add(c,d.mul(v.eval_c,o.slice(e*g,(e+1)*g))),c=d.add(c,n.slice(e*g,(e+1)*g)),c=d.sub(c,d.mul(O,s.slice(e*g,(e+1)*g)))),B.set(c,e*g)}v.eval_r=k(B,z.xi)}(),await async function(){const t=new Uint8Array(7*g);d.toRprBE(t,0,v.eval_a),d.toRprBE(t,g,v.eval_b),d.toRprBE(t,2*g,v.eval_c),d.toRprBE(t,3*g,v.eval_s1),d.toRprBE(t,4*g,v.eval_s2),d.toRprBE(t,5*g,v.eval_zw),d.toRprBE(t,6*g,v.eval_r),z.v=[],z.v[1]=T(t),e&&e.debug("v: "+d.toString(z.v[1]));for(let t=2;t<=6;t++)z.v[t]=d.mul(z.v[t-1],z.v[1]);let a=new Pa((l.domainSize+6)*g);const i=d.mul(z.xim,z.xim);for(let t=0;t<l.domainSize+6;t++){let e=d.zero;const o=E.slice((2*l.domainSize+t)*g,(2*l.domainSize+t+1)*g);if(e=d.add(e,d.mul(i,o)),t<l.domainSize+3&&(e=d.add(e,d.mul(z.v[1],B.slice(t*g,(t+1)*g)))),t<l.domainSize+2&&(e=d.add(e,d.mul(z.v[2],I.slice(t*g,(t+1)*g))),e=d.add(e,d.mul(z.v[3],C.slice(t*g,(t+1)*g))),e=d.add(e,d.mul(z.v[4],x.slice(t*g,(t+1)*g)))),t<l.domainSize){const a=E.slice(t*g,(t+1)*g);e=d.add(e,a);const i=E.slice((l.domainSize+t)*g,(l.domainSize+t+1)*g);e=d.add(e,d.mul(z.xim,i)),e=d.add(e,d.mul(z.v[5],P.slice(t*g,(t+1)*g))),e=d.add(e,d.mul(z.v[6],U.slice(t*g,(t+1)*g)))}0===t&&(e=d.sub(e,d.mul(i,z.b[11])),e=d.sub(e,d.mul(z.xim,z.b[10]))),t===l.domainSize&&(e=d.add(e,z.b[10]),e=d.add(e,d.mul(z.xim,z.b[11]))),a.set(e,t*g)}let o=a.slice(0,g);o=d.sub(o,v.eval_t),o=d.sub(o,d.mul(z.v[1],v.eval_r)),o=d.sub(o,d.mul(z.v[2],v.eval_a)),o=d.sub(o,d.mul(z.v[3],v.eval_b)),o=d.sub(o,d.mul(z.v[4],v.eval_c)),o=d.sub(o,d.mul(z.v[5],v.eval_s1)),o=d.sub(o,d.mul(z.v[6],v.eval_s2)),a.set(o,0),a=R(a,z.xi),v.Wxi=await D(a,"multiexp Wxi");let n=new Pa((l.domainSize+3)*g);for(let t=0;t<l.domainSize+3;t++){const a=F.slice(t*g,(t+1)*g);n.set(a,t*g)}o=n.slice(0,g),o=d.sub(o,v.eval_zw),n.set(o,0),n=R(n,d.mul(z.xi,d.w[l.power])),v.Wxiw=await D(n,"multiexp Wxiw")}(),v.protocol="plonk",v.curve=s.name,await c.close(),await i.close();let Q=[];for(let t=1;t<=l.nPublic;t++){const a=_.slice(t*d.n8,t*d.n8+d.n8);Q.push(pe.fromRprLE(a))}return v.A=u.toObject(v.A),v.B=u.toObject(v.B),v.C=u.toObject(v.C),v.Z=u.toObject(v.Z),v.T1=u.toObject(v.T1),v.T2=u.toObject(v.T2),v.T3=u.toObject(v.T3),v.eval_a=d.toObject(v.eval_a),v.eval_b=d.toObject(v.eval_b),v.eval_c=d.toObject(v.eval_c),v.eval_s1=d.toObject(v.eval_s1),v.eval_s2=d.toObject(v.eval_s2),v.eval_zw=d.toObject(v.eval_zw),v.eval_t=d.toObject(v.eval_t),v.eval_r=d.toObject(v.eval_r),v.Wxi=u.toObject(v.Wxi),v.Wxiw=u.toObject(v.Wxiw),delete v.eval_t,v=mn(v),Q=mn(Q),{proof:v,publicSignals:Q};function q(t,a){const e=t.slice(a,a+4);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)}function M(t){return t<l.nVars-l.nAdditions?_.slice(t*g,t*g+g):t<l.nVars?f.slice((t-(l.nVars-l.nAdditions))*g,(t-(l.nVars-l.nAdditions))*g+g):s.Fr.zero}function T(t){const a=pe.fromRprBE(new Uint8Array(Ln.arrayBuffer(t)));return d.e(a)}function k(t,a){const e=t.byteLength/g;if(0==e)return d.zero;let i=t.slice((e-1)*g,e*g);for(let o=e-2;o>=0;o--)i=d.add(d.mul(i,a),t.slice(o*g,(o+1)*g));return i}function R(t,a){const e=t.byteLength/g,i=new Pa(e*g);i.set(d.zero,(e-1)*g),i.set(t.slice((e-1)*g,e*g),(e-2)*g);for(let o=e-3;o>=0;o--)i.set(d.add(t.slice((o+1)*g,(o+2)*g),d.mul(a,i.slice((o+1)*g,(o+2)*g))),o*g);if(!d.eq(t.slice(0,g),d.mul(d.neg(a),i.slice(0,g))))throw new Error("Polinomial does not divide");return i}async function D(t,a){const i=t.byteLength/g,o=O.slice(0,i*s.G1.F.n8*2),n=await s.Fr.batchFromMontgomery(t);let c=await s.G1.multiExpAffine(o,n,e,a);return c=s.G1.toAffine(c),c}async function N(t,a){a=a||[];let e=await d.ifft(t);const i=new Pa(g*l.domainSize*4);i.set(e,0);const o=new Pa(g*(l.domainSize+a.length));o.set(e,0);for(let t=0;t<a.length;t++)o.set(d.add(o.slice((l.domainSize+t)*g,(l.domainSize+t+1)*g),a[t]),(l.domainSize+t)*g),o.set(d.sub(o.slice(t*g,(t+1)*g),a[t]),t*g);return[o,await d.fft(i)]}}const{unstringifyBigInts:An}=he;const{unstringifyBigInts:bn}=he,{keccak256:yn}=hn;function In(t,a){const e=pe.fromRprBE(new Uint8Array(yn.arrayBuffer(a)));return t.Fr.e(e)}const{unstringifyBigInts:Cn}=he;function xn(t){return("0"+t.toString(16)).slice(-2)}function Fn(t){let a=t.toString(16);for(;a.length<64;)a="0"+a;return a=`"0x${a}"`,a}var En=Object.freeze({__proto__:null,setup:async function(t,a,e,i){globalThis.gc&&globalThis.gc(),await Ye.exports.ready();const{fd:o,sections:n}=await Ue(a,"ptau",1),{curve:c,power:r}=await vo(o,n),{fd:l,sections:s}=await Ue(t,"r1cs",1),d=await $o(l,s,{loadConstraints:!0,loadCustomGates:!0}),u=2*c.G1.F.n8,g=c.G1,_=2*c.G2.F.n8,f=c.Fr,p=c.Fr.n8;i&&i.info("Reading r1cs"),await De(l,s,2);const h=new cn,m=new cn;let L=d.nVars;const w=d.nOutputs+d.nPubInputs;await async function(t,a,e){function i(t){const a=Object.keys(t);for(let e=0;e<a.length;e++)0n==t[a[e]]&&delete t[a[e]]}function o(a,e,o){const n={};for(let i in a)void 0===n[i]?n[i]=t.mul(e,a[i]):n[i]=t.add(n[i],t.mul(e,a[i]));for(let a in o)void 0===n[a]?n[a]=o[a]:n[a]=t.add(n[a],o[a]);return i(n),n}function n(a,e){const i={k:t.zero,s:[],coefs:[]},o=[];for(let e in a)0==e?i.k=t.add(i.k,a[e]):0n!=a[e]&&o.push([Number(e),a[e]]);for(;o.length>e;){const a=o.shift(),e=o.shift(),i=a[0],n=e[0],c=L++,r=t.zero,l=t.neg(a[1]),s=t.neg(e[1]),d=t.one,u=t.zero;h.push([i,n,c,r,l,s,d,u]),m.push([i,n,a[1],e[1]]),o.push([c,t.one])}for(let t=0;t<o.length;t++)i.s[t]=o[t][0],i.coefs[t]=o[t][1];for(;i.coefs.length<e;)i.s.push(0),i.coefs.push(t.zero);return i}function c(a){const e=n(a,3),i=e.s[0],o=e.s[1],c=e.s[2],r=t.zero,l=e.coefs[0],s=e.coefs[1],d=e.coefs[2],u=e.k;h.push([i,o,c,r,l,s,d,u])}function r(a){let e=t.zero,i=0;const o=Object.keys(a);for(let n=0;n<o.length;n++)0n==a[o[n]]?delete a[o[n]]:0==o[n]?e=t.add(e,a[o[n]]):i++;return i>0?i.toString():e!=t.zero?"k":"0"}function l(a,e,l){const s=r(a),d=r(e);if("0"===s||"0"===d)i(l),c(l);else if("k"===s){c(o(e,a[0],l))}else if("k"===d){c(o(a,e[0],l))}else!function(a,e,i){const o=n(a,1),c=n(e,1),r=n(i,1),l=o.s[0],s=c.s[0],d=r.s[0],u=t.mul(o.coefs[0],c.coefs[0]),g=t.mul(o.coefs[0],c.k),_=t.mul(o.k,c.coefs[0]),f=t.neg(r.coefs[0]),p=t.sub(t.mul(o.k,c.k),r.k);h.push([l,s,d,u,g,_,f,p])}(a,e,l)}for(let a=1;a<=w;a++){const e=a,i=0,o=0,n=t.zero,c=t.one,r=t.zero,l=t.zero,s=t.zero;h.push([e,i,o,n,c,r,l,s])}for(let t=0;t<a.constraints.length;t++)e&&t%1e4==0&&e.debug(`processing constraints: ${t}/${a.nConstraints}`),l(...a.constraints[t])}(c.Fr,d,i),globalThis.gc&&globalThis.gc();const A=await Oe(e,"zkey",1,14,1<<22,1<<24);if(d.prime!=c.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;let b=Mi(h.length-1)+1;b<3&&(b=3);const y=2**b;if(i&&i.info("Plonk constraints: "+h.length),b>r)return i&&i.error(`circuit too big for this power of tau ceremony. ${h.length} > 2**${r}`),-1;if(!n[12])return i&&i.error("Powers of tau is not prepared."),-1;const I=new Pa(y*u),C=n[12][0].p+(2**b-1)*u;await o.readToBuffer(I,0,y*u,C);const[x,F]=function(){let t=f.two;for(;e(t,[],b);)f.add(t,f.one);let a=f.add(t,f.one);for(;e(a,[t],b);)f.add(a,f.one);return[t,a];function e(t,a,e){const i=2**e;let o=f.one;for(let n=0;n<i;n++){if(f.eq(t,o))return!0;for(let e=0;e<a.length;e++)if(f.eq(t,f.mul(a[e],o)))return!0;o=f.mul(o,f.w[e])}return!1}}(),E={};await async function(t,a){await ze(A,t);const e=new Uint8Array(8+2*p),o=new DataView(e.buffer);for(let t=0;t<m.length;t++){const n=m[t];let c=0;o.setUint32(c,n[0],!0),c+=4,o.setUint32(c,n[1],!0),c+=4,e.set(n[2],c),c+=p,e.set(n[3],c),c+=p,await A.write(e),i&&t%1e6==0&&i.debug(`writing ${a}: ${t}/${m.length}`)}await Qe(A)}(3,"Additions"),globalThis.gc&&globalThis.gc(),await v(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await v(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await v(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await S(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await S(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await S(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await S(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await S(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await async function(t,a){const e=new Pa(p*y*3),o=new cn(L),n=new cn(L);let r=f.one;for(let t=0;t<y;t++)t<h.length?(u(h[t][0],t),u(h[t][1],y+t),u(h[t][2],2*y+t)):(u(0,t),u(0,y+t),u(0,2*y+t)),r=f.mul(r,f.w[b]),i&&t%1e6==0&&i.debug(`writing ${a} phase1: ${t}/${h.length}`);for(let t=0;t<L;t++)void 0!==n[t]?e.set(o[t],n[t]*p):console.log("Variable not used"),i&&t%1e6==0&&i.debug(`writing ${a} phase2: ${t}/${L}`);globalThis.gc&&globalThis.gc();await ze(A,t);let l=e.slice(0,y*p);await G(l),globalThis.gc&&globalThis.gc();let s=e.slice(y*p,y*p*2);await G(s),globalThis.gc&&globalThis.gc();let d=e.slice(y*p*2,y*p*3);await G(d),globalThis.gc&&globalThis.gc();await Qe(A),l=await f.batchFromMontgomery(l),s=await f.batchFromMontgomery(s),d=await f.batchFromMontgomery(d),E.S1=await c.G1.multiExpAffine(I,l,i,"multiexp S1"),globalThis.gc&&globalThis.gc();E.S2=await c.G1.multiExpAffine(I,s,i,"multiexp S2"),globalThis.gc&&globalThis.gc();E.S3=await c.G1.multiExpAffine(I,d,i,"multiexp S3"),globalThis.gc&&globalThis.gc();function u(t,a){let i;void 0===o[t]?n[t]=a:e.set(o[t],a*p),i=a<y?r:a<2*y?f.mul(r,x):f.mul(r,F),o[t]=i}}(12,"sigma"),globalThis.gc&&globalThis.gc(),await async function(t,a){await ze(A,t);const e=Math.max(w,1);for(let t=0;t<e;t++){let o=new Pa(y*p);o.set(f.one,t*p),await G(o),i&&i.debug(`writing ${a} ${t}/${e}`)}await Qe(A)}(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await ze(A,14);const B=new Pa((y+6)*u);return await o.readToBuffer(B,0,(y+6)*u,n[2][0].p),await A.write(B),await Qe(A),globalThis.gc&&globalThis.gc(),await async function(){await ze(A,1),await A.writeULE32(2),await Qe(A),await ze(A,2);const t=c.q,a=8*(Math.floor((pe.bitLength(t)-1)/64)+1),e=c.r,i=8*(Math.floor((pe.bitLength(e)-1)/64)+1);let r;await A.writeULE32(a),await Te(A,t,a),await A.writeULE32(i),await Te(A,e,i),await A.writeULE32(L),await A.writeULE32(w),await A.writeULE32(y),await A.writeULE32(m.length),await A.writeULE32(h.length),await A.write(x),await A.write(F),await A.write(g.toAffine(E.Qm)),await A.write(g.toAffine(E.Ql)),await A.write(g.toAffine(E.Qr)),await A.write(g.toAffine(E.Qo)),await A.write(g.toAffine(E.Qc)),await A.write(g.toAffine(E.S1)),await A.write(g.toAffine(E.S2)),await A.write(g.toAffine(E.S3)),r=await o.read(_,n[3][0].p+_),await A.write(r),await Qe(A)}(),await A.close(),await l.close(),await o.close(),void(i&&i.info("Setup Finished"));async function v(t,a,e){await ze(A,t);for(let t=0;t<h.length;t++)await A.writeULE32(h[t][a]),i&&t%1e6==0&&i.debug(`writing ${e}: ${t}/${h.length}`);await Qe(A)}async function S(t,a,e){let o=new Pa(y*p);for(let t=0;t<h.length;t++)o.set(h[t][a],t*p),i&&t%1e6==0&&i.debug(`writing ${e}: ${t}/${h.length}`);await ze(A,t),await G(o),await Qe(A),o=await f.batchFromMontgomery(o),E[e]=await c.G1.multiExpAffine(I,o,i,"multiexp "+e)}async function G(t){const a=await f.ifft(t),e=new Pa(y*p*4);e.set(a,0);const i=await f.fft(e);await A.write(a),await A.write(i)}},fullProve:async function(t,a,e,i){const o=An(t),n={type:"mem"};return await Lo(o,a,n),await wn(e,n,i)},prove:wn,verify:async function(t,a,e,i){let o=bn(t),n=bn(e),c=bn(a);const r=await $e(o.curve),l=r.Fr,s=r.G1;if(n=function(t,a){const e=t.G1,i=t.Fr,o={};return o.A=e.fromObject(a.A),o.B=e.fromObject(a.B),o.C=e.fromObject(a.C),o.Z=e.fromObject(a.Z),o.T1=e.fromObject(a.T1),o.T2=e.fromObject(a.T2),o.T3=e.fromObject(a.T3),o.eval_a=i.fromObject(a.eval_a),o.eval_b=i.fromObject(a.eval_b),o.eval_c=i.fromObject(a.eval_c),o.eval_zw=i.fromObject(a.eval_zw),o.eval_s1=i.fromObject(a.eval_s1),o.eval_s2=i.fromObject(a.eval_s2),o.eval_r=i.fromObject(a.eval_r),o.Wxi=e.fromObject(a.Wxi),o.Wxiw=e.fromObject(a.Wxiw),o}(r,n),o=function(t,a){const e=t.G1,i=t.G2,o=t.Fr,n=a;return n.Qm=e.fromObject(a.Qm),n.Ql=e.fromObject(a.Ql),n.Qr=e.fromObject(a.Qr),n.Qo=e.fromObject(a.Qo),n.Qc=e.fromObject(a.Qc),n.S1=e.fromObject(a.S1),n.S2=e.fromObject(a.S2),n.S3=e.fromObject(a.S3),n.k1=o.fromObject(a.k1),n.k2=o.fromObject(a.k2),n.X_2=i.fromObject(a.X_2),n}(r,o),!function(t,a){const e=t.G1;return!!e.isValid(a.A)&&(!!e.isValid(a.B)&&(!!e.isValid(a.C)&&(!!e.isValid(a.Z)&&(!!e.isValid(a.T1)&&(!!e.isValid(a.T2)&&(!!e.isValid(a.T3)&&(!!e.isValid(a.Wxi)&&!!e.isValid(a.Wxiw))))))))}(r,n))return i.error("Proof is not well constructed"),!1;if(c.length!=o.nPublic)return i.error("Invalid number of public inputs"),!1;const d=function(t,a,e){const i=t.G1,o=t.Fr,n=t.Fr.n8,c={},r=new Uint8Array(e.length*n+2*i.F.n8*3);for(let t=0;t<e.length;t++)o.toRprBE(r,t*n,o.e(e[t]));i.toRprUncompressed(r,e.length*n+0,a.A),i.toRprUncompressed(r,e.length*n+2*i.F.n8,a.B),i.toRprUncompressed(r,e.length*n+4*i.F.n8,a.C),c.beta=In(t,r);const l=new Uint8Array(n);o.toRprBE(l,0,c.beta),c.gamma=In(t,l);const s=new Uint8Array(2*i.F.n8);i.toRprUncompressed(s,0,a.Z),c.alpha=In(t,s);const d=new Uint8Array(2*i.F.n8*3);i.toRprUncompressed(d,0,a.T1),i.toRprUncompressed(d,2*i.F.n8,a.T2),i.toRprUncompressed(d,4*i.F.n8,a.T3),c.xi=In(t,d);const u=new Uint8Array(7*n);o.toRprBE(u,0,a.eval_a),o.toRprBE(u,n,a.eval_b),o.toRprBE(u,2*n,a.eval_c),o.toRprBE(u,3*n,a.eval_s1),o.toRprBE(u,4*n,a.eval_s2),o.toRprBE(u,5*n,a.eval_zw),o.toRprBE(u,6*n,a.eval_r),c.v=[],c.v[1]=In(t,u);for(let t=2;t<=6;t++)c.v[t]=o.mul(c.v[t-1],c.v[1]);const g=new Uint8Array(2*i.F.n8*2);return i.toRprUncompressed(g,0,a.Wxi),i.toRprUncompressed(g,2*i.F.n8,a.Wxiw),c.u=In(t,g),c}(r,n,c);i&&(i.debug("beta: "+l.toString(d.beta,16)),i.debug("gamma: "+l.toString(d.gamma,16)),i.debug("alpha: "+l.toString(d.alpha,16)),i.debug("xi: "+l.toString(d.xi,16)),i.debug("v1: "+l.toString(d.v[1],16)),i.debug("v6: "+l.toString(d.v[6],16)),i.debug("u: "+l.toString(d.u,16)));const u=function(t,a,e){const i=t.Fr;let o=a.xi,n=1;for(let t=0;t<e.power;t++)o=i.square(o),n*=2;a.xin=o,a.zh=i.sub(o,i.one);const c=[],r=i.e(n);let l=i.one;for(let t=1;t<=Math.max(1,e.nPublic);t++)c[t]=i.div(i.mul(l,a.zh),i.mul(r,i.sub(a.xi,l))),l=i.mul(l,i.w[e.power]);return c}(r,d,o);if(i){i.debug("Lagrange Evaluations: ");for(let t=1;t<u.length;t++)i.debug(`L${t}(xi)=`+l.toString(u[t],16))}if(c.length!=o.nPublic)return i.error("Number of public signals does not match with vk"),!1;const g=function(t,a,e){const i=t.Fr;let o=i.zero;for(let t=0;t<a.length;t++){const n=i.e(a[t]);o=i.sub(o,i.mul(n,e[t+1]))}return o}(r,c,u);i&&i.debug("Pl: "+l.toString(g,16));const _=function(t,a,e,i,o){const n=t.Fr;let c=a.eval_r;c=n.add(c,i);let r=a.eval_a;r=n.add(r,n.mul(e.beta,a.eval_s1)),r=n.add(r,e.gamma);let l=a.eval_b;l=n.add(l,n.mul(e.beta,a.eval_s2)),l=n.add(l,e.gamma);let s=a.eval_c;s=n.add(s,e.gamma);let d=n.mul(n.mul(r,l),s);d=n.mul(d,a.eval_zw),d=n.mul(d,e.alpha),c=n.sub(c,d),c=n.sub(c,n.mul(o,n.square(e.alpha)));return n.div(c,e.zh)}(r,n,d,g,u[1]);i&&i.debug("t: "+l.toString(_,16));const f=function(t,a,e,i,o){const n=t.G1,c=t.Fr;let r=c.mul(c.mul(a.eval_a,a.eval_b),e.v[1]),l=n.timesFr(i.Qm,r),s=c.mul(a.eval_a,e.v[1]);l=n.add(l,n.timesFr(i.Ql,s));let d=c.mul(a.eval_b,e.v[1]);l=n.add(l,n.timesFr(i.Qr,d));let u=c.mul(a.eval_c,e.v[1]);l=n.add(l,n.timesFr(i.Qo,u)),l=n.add(l,n.timesFr(i.Qc,e.v[1]));const g=c.mul(e.beta,e.xi);let _=a.eval_a;_=c.add(_,g),_=c.add(_,e.gamma);let f=a.eval_b;f=c.add(f,c.mul(g,i.k1)),f=c.add(f,e.gamma);let p=a.eval_c;p=c.add(p,c.mul(g,i.k2)),p=c.add(p,e.gamma);let h=c.mul(c.mul(_,f),p);h=c.mul(h,c.mul(e.alpha,e.v[1]));let m=c.mul(c.mul(o,c.square(e.alpha)),e.v[1]);h=c.add(h,m),h=c.add(h,e.u),l=n.add(l,n.timesFr(a.Z,h));let L=a.eval_a;L=c.add(L,c.mul(e.beta,a.eval_s1)),L=c.add(L,e.gamma);let w=a.eval_b;w=c.add(w,c.mul(e.beta,a.eval_s2)),w=c.add(w,e.gamma);let A=c.mul(L,w);return A=c.mul(A,e.alpha),A=c.mul(A,e.v[1]),A=c.mul(A,e.beta),A=c.mul(A,a.eval_zw),l=n.sub(l,n.timesFr(i.S3,A)),l}(r,n,d,o,u[1]);i&&i.debug("D: "+s.toString(s.toAffine(f),16));const p=function(t,a,e,i,o){const n=t.G1,c=t.Fr;let r=a.T1;return r=n.add(r,n.timesFr(a.T2,e.xin)),r=n.add(r,n.timesFr(a.T3,c.square(e.xin))),r=n.add(r,o),r=n.add(r,n.timesFr(a.A,e.v[2])),r=n.add(r,n.timesFr(a.B,e.v[3])),r=n.add(r,n.timesFr(a.C,e.v[4])),r=n.add(r,n.timesFr(i.S1,e.v[5])),r=n.add(r,n.timesFr(i.S2,e.v[6])),r}(r,n,d,o,f);i&&i.debug("F: "+s.toString(s.toAffine(p),16));const h=function(t,a,e,i,o){const n=t.G1,c=t.Fr;let r=o;r=c.add(r,c.mul(e.v[1],a.eval_r)),r=c.add(r,c.mul(e.v[2],a.eval_a)),r=c.add(r,c.mul(e.v[3],a.eval_b)),r=c.add(r,c.mul(e.v[4],a.eval_c)),r=c.add(r,c.mul(e.v[5],a.eval_s1)),r=c.add(r,c.mul(e.v[6],a.eval_s2)),r=c.add(r,c.mul(e.u,a.eval_zw));return n.timesFr(n.one,r)}(r,n,d,0,_);i&&i.debug("E: "+s.toString(s.toAffine(h),16));const m=await async function(t,a,e,i,o,n){const c=t.G1,r=t.Fr;let l=a.Wxi;l=c.add(l,c.timesFr(a.Wxiw,e.u));let s=c.timesFr(a.Wxi,e.xi);const d=r.mul(r.mul(e.u,e.xi),r.w[i.power]);s=c.add(s,c.timesFr(a.Wxiw,d)),s=c.add(s,n),s=c.sub(s,o);return await t.pairingEq(c.neg(l),i.X_2,s,t.G2.one)}(r,n,d,o,h,p);return i&&(m?i.info("OK!"):i.warn("Invalid Proof")),m},exportSolidityCallData:async function(t,a){const e=Cn(t),i=Cn(a),o=await $e(e.curve),n=o.G1,c=o.Fr;let r="";for(let t=0;t<i.length;t++)""!=r&&(r+=","),r+=Fn(i[t]);const l=new Uint8Array(2*n.F.n8*9+7*c.n8);return n.toRprUncompressed(l,0,n.e(e.A)),n.toRprUncompressed(l,2*n.F.n8,n.e(e.B)),n.toRprUncompressed(l,4*n.F.n8,n.e(e.C)),n.toRprUncompressed(l,6*n.F.n8,n.e(e.Z)),n.toRprUncompressed(l,8*n.F.n8,n.e(e.T1)),n.toRprUncompressed(l,10*n.F.n8,n.e(e.T2)),n.toRprUncompressed(l,12*n.F.n8,n.e(e.T3)),n.toRprUncompressed(l,14*n.F.n8,n.e(e.Wxi)),n.toRprUncompressed(l,16*n.F.n8,n.e(e.Wxiw)),c.toRprBE(l,18*n.F.n8,c.e(e.eval_a)),c.toRprBE(l,18*n.F.n8+c.n8,c.e(e.eval_b)),c.toRprBE(l,18*n.F.n8+2*c.n8,c.e(e.eval_c)),c.toRprBE(l,18*n.F.n8+3*c.n8,c.e(e.eval_s1)),c.toRprBE(l,18*n.F.n8+4*c.n8,c.e(e.eval_s2)),c.toRprBE(l,18*n.F.n8+5*c.n8,c.e(e.eval_zw)),c.toRprBE(l,18*n.F.n8+6*c.n8,c.e(e.eval_r)),"0x"+Array.from(l).map(xn).join("")+",["+r+"]"}});return t.groth16=Io,t.plonk=En,t.powersOfTau=Do,t.r1cs=Jo,t.wtns=an,t.zKey=_n,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
